"use strict";(self.webpackChunk_snowflake_nu_ui=self.webpackChunk_snowflake_nu_ui||[]).push([["4030"],{24149:function(e,t,n){n.d(t,{_:()=>i,x:()=>f});var o=n(847345),r=n(895125),a=n(463198);function i(e,t,{serialize:n=JSON.stringify,deserialize:r=JSON.parse}={}){let[l,s]=o.useState(()=>{let n=window.localStorage.getItem(e);return null!==n?r(n):"function"==typeof t?t():t}),u=o.useRef(e);return[l,(0,a.z)(t=>{s(o=>{let r="function"==typeof t?t(o):t,a=u.current;return a!==e&&window.localStorage.removeItem(a),u.current=e,window.localStorage.setItem(e,n(r)),r})})]}function l(e,t){window.dispatchEvent(new StorageEvent("storage",{key:e,newValue:t}))}let s=(e,t)=>{window.localStorage.setItem(e,t),l(e,t)},u=e=>{window.localStorage.removeItem(e),l(e,null)},d=e=>window.localStorage.getItem(e),c=e=>(window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)),E=()=>{throw Error("useLocalStorage is a client-only hook")};function f(e,t){let n=(0,r.useSyncExternalStore)(c,()=>d(e),E),a=(0,o.useMemo)(()=>{if(null===n)return null;try{return JSON.parse(n)}catch(e){return null}},[n]),i=(0,o.useMemo)(()=>null!=a,[a]),l=(0,o.useMemo)(()=>i?a:t,[i,t,a]),f=(0,o.useCallback)(()=>{u(e)},[e]),p=(0,o.useCallback)(t=>{try{null==t&&u(e);let n="function"==typeof t?t(l):t;null==n?u(e):s(e,JSON.stringify(n))}catch(e){console.warn(e)}},[e,l]);return{value:l,setValue:p,hasStoredValue:i,clear:f}}},17009:function(e,t,n){n.d(t,{ox:()=>r});var o,r=((o={}).AccountNameMissing="AccountNameMissing",o.ExchangeNotFound="ExchangeNotFound",o.ListingNameAlreadyExists="ListingNameAlreadyExists",o.ListingCannotDeletePublished="ListingCannotDeletePublished",o.ListingCannotMonetizePublished="ListingCannotMonetizePublished",o.ListingCannotUnmonetizePublished="ListingCannotUnmonetizePublished",o.ListingTitleCharacterLimitExceeded="ListingTitleCharacterLimitExceeded",o.ListingMissingProfile="ListingMissingProfile",o.ListingSubTitleCharacterLimitExceeded="ListingSubTitleCharacterLimitExceeded",o.ListingDescriptionCharacterLimitExceeded="ListingDescriptionCharacterLimitExceeded",o.ListingGlobalNameNotFound="ListingGlobalNameNotFound",o.ListingNoRegionsProvided="ListingNoRegionsProvided",o.ListingInvalidRegion="ListingInvalidRegion",o.ExampleValidationError="ExampleValidationError",o.ExampleValidationNoExamples="ExampleValidationNoExamples",o.ExampleValidationNoShare="ExampleValidationNoShare",o.MemberErrorAdding="MemberErrorAdding",o.MemberErrorUpdating="MemberErrorUpdating",o.ProviderProfileErrorUploadingImage="ProviderProfileErrorUploadingImage",o.ProviderProfileNotFound="ProviderProfileNotFound",o.ProviderProfileImageTooLarge="ProviderProfileImageTooLarge",o.ProviderProfileInUse="ProviderProfileInUse",o.ErrorBootstrap="ErrorBootstrap",o.ErrorValidatingEmail="ErrorValidatingEmail",o.SharingFailed="SharingFailed",o.SharingNotPermitted="SharingNotPermitted",o.CouldNotAccessListing="CouldNotAccessListing",o.NotSupportedSchema="NotSupportedSchema",o.ShareAlreadyAttachedToListing="ShareAlreadyAttachedToListing",o.NotFound="NotFound",o.BodyTooLarge="BodyTooLarge",o.FailedToParseJSON="FailedToParseJSON",o.FailedToRefreshAcceptanceDetails="FailedToRefreshAcceptanceDetails",o.InvalidRegionAllError="InvalidRegionAllError",o.FailedToParseBillingEntity="FailedToParseBillingEntity",o.SecurableNotFound="SecurableNotFound",o.DuplicateSecurablesFound="DuplicateSecurablesFound",o.UserLoggedOut="USER_LOGGED_OUT",o.NetPolicyFailed="NET_POLICY_FAILED",o.NotProvisioned="NOT_PROVISIONED",o.DxNotAdmin="DX_NOT_ADMIN",o.InvalidHeader="INVALID_HEADER",o.TrialSuspended="TRIAL_SUSPENDED",o.WrongCommand="WRONG_COMMAND",o.LoginFailed="LOGIN_FAILED",o.ResultsNotFound="RESULTS_NOT_FOUND",o.CountryCodeMissing="CountryCodeMissing",o.NoPurchasePrivilege="NoPurchasePrivilege",o.StripeKeyMissing="StripeKeyMissing",o.StripeKeyInvalid="StripeKeyInvalid",o.StripeIdMissing="StripeIdMissing",o.StripeError="StripeError",o.StripeInvalidCountryCode="StripeInvalidCountryCode",o.StripeErrorGettingPaymentMethod="StripeErrorGettingPaymentMethod",o)},731651:function(e,t,n){n.d(t,{SB:()=>u,tJ:()=>s});var o=n(825488),r=n(276491);let a=Symbol("state"),i=Symbol("atom");class l{constructor(e){this.get=(e=r.h)=>e.get(this),this.set=(e,t=r.h)=>{if(this.schema){let n=this.schema.parse(e);t.set(this,n)}else t.set(this,e)},this.subscribe=(e,t=r.h)=>{e(this.get(t));let n=this;return t.sub(n,()=>e(t.get(n)))},this[i]=(0,o.cn)(e)}}function s(e){if(Reflect.has(e,a))return Reflect.get(Reflect.get(e,a),i);if(Reflect.has(e,i))return Reflect.get(e,i);if("object"==typeof e)return e;throw Error("State is not a object")}function u(e){let t=new l(e),n=function(e){return t.get(e)};return Reflect.set(n,a,t),n.set=t.set,n.subscribe=t.subscribe,n.atom=()=>t.atom(),n.subject=()=>t.subject(),n.syncable=(e,o)=>(t.schema=o,Object.defineProperty(n,"name",{value:e}),n),n}},276491:function(e,t,n){n.d(t,{h:()=>i});var o=n(825488),r=n(731651);let a=Symbol("store"),i=new class{get(e){return this[a].get((0,r.tJ)(e))}set(e,t){this[a].set((0,r.tJ)(e),t)}sub(e,t){return this[a].sub((0,r.tJ)(e),t)}reset(){this[a]=(0,o.MT)()}constructor(e){this[a]=e||(0,o.MT)()}}((0,o.K7)())},22146:function(e,t,n){n.d(t,{_:()=>a});var o=n(731651),r=n(635237);let a=(0,o.SB)({role:"",database:"",schema:"",warehouse:""}).syncable("snowsight.executionContext",r.z.object({role:r.z.string(),database:r.z.string(),schema:r.z.string(),warehouse:r.z.string()}))},998975:function(e,t,n){n.d(t,{A:()=>r,h:()=>o});let o=1,r=1},106120:function(e,t,n){n.d(t,{E:()=>r});var o=n(998975);function r(e,t,n){let r={stCommVersion:o.h,...n};null==e||e.postMessage(r,t)}},276567:function(e,t,n){n.d(t,{b:()=>a,k:()=>r});var o=n(354908);function r(e){return e instanceof o.M}function a(e){let t=e;for(;t;){if(r(t))return t;t=t.cause}}},640579:function(e,t,n){n.d(t,{j:()=>b});var o,r=n(22146),a=n(819260),i=n(434475),l=n(821018),s=n(865832),u=n(535697),d=n(69446),c=n(304241),E=n(423939),f=n(735377),p=n(563626),S=n(867668),g=n(108471),_=n(916193);let h=["/:region/:org/data/marketplace","/marketplace","/:region/:org/data/provider-studio","/provider-studio","/:region/:org/data/shared/listing","/:region/:org/apps/listing"],m=["/:region/:org/data/manage/admin/:id?","/:region/:org/data/manage/provider/:id?","/:region/:org/data/manage/:id?","/:region/:org/data/shared/manage/:id?","/:region/:org/data/shared/provider/:id?","/:region/:org/data/shared/:id?","/:region/:org/admin/exchange/:id?","/:region/:org/data/","/:region/:org//"],I=()=>{var e;if(h.some(e=>(0,g.LX)({path:e,end:!1},_.lm.location.pathname)))return S.SnowflakePuDxName;let t=m.reduce((e,t)=>{var n;return(null==e||null==(n=e.params)?void 0:n.id)?e:(0,g.LX)({path:t,end:!1},_.lm.location.pathname)},null);return(null==t||null==(e=t.params)?void 0:e.id)&&decodeURI(t.params.id)};var T=n(360688),R=n(420174),C=n(634427),y=n(399808),v=n(847345);class N{constructor(e){this.dispatch=e,this[o]=!0}}o=y.sc;class A extends N{loadStores(e){if(this.dispatch){let{user:t,organization:n,securable:o}=e;!this.securablePromises&&o&&this.loadSecurableStore(o),!this.userStore&&t&&this.loadUserStore(t),this.initializeRolesAndWarehouse(t),!this.organizationStore&&n&&this.loadOrganizationStore(n)}}initializeRolesAndWarehouse(e){if(this.dispatch&&!this.userStore&&e){let n=e.isUiSpecifiedSnowflakeFeatureEnabled("UI_ENABLE_WAW_DEX_FEATURE_20");if(this.dataDiscoverRole)e.switchCurrentRole(this.dataDiscoverRole);else{var t;let o=(null==(t=e.currentRole)?void 0:t.call(e))||(0,p.d)(e.currentUser);this.setDataDiscoverRole(o,n)}if(!this.currentWarehouse&&e.currentUser){let{settings:t}=e.currentUser;this.setCurrentWarehouse(null==t?void 0:t.defaultWarehouse,n)}}}get exchangeId(){return I()}get organizationName(){return this.organizationStore.activeOrg.settings.snowflakeOrgName}get isHealthCheckEnabled(){return this.userStore.dxHealthCheckEnabled}get hasSuperAccountAdminRole(){return(0,s.i)(this.availableRoles)}get isCurrentRoleSuperAccountAdmin(){return(0,c.h)(this.dataDiscoverRole)}get hasSuperOrgAdminRole(){return(0,u.j)(this.availableRoles)}get isCurrentRoleSuperOrgAdmin(){return(0,E.l)(this.dataDiscoverRole)}get hasSuperSecurityAdmin(){return(0,d.w)(this.availableRoles)}get isCurrentRoleSuperSecurityAdmin(){return(0,f.E)(this.dataDiscoverRole)}isCurrentUser(e){return this.userStore.isCurrentUser(e)}async validateSnowflakeURL(e){try{let t=await l.nufetch("/validate-snowflake-url?"+i.nZ({url:e}),this.userStore.userRequestContext(),void 0,void 0,!1);if(!t.valid)return{valid:!1};if(!e.toLowerCase().includes(".snowflakecomputing.com"))return console.error("account must include full url"),{valid:!1};return t}catch(e){return console.error("Validate snowflake url failed with err",e),{valid:!1}}}async validateAccountIdentifier(e,t,n){try{let o=await l.nufetch("/validate-snowflake-account-region?"+i.nZ({region:e.toUpperCase(),account:t.toUpperCase(),isSecondaryAccount:n}),this.userStore.userRequestContext());if(!o.valid)return{valid:!1};return o}catch(e){return console.error("Validate snowflake account region failed with err",e),{valid:!1}}}async fetchAccountDeploymentInfo(e,t){try{let n=await l.nufetch("/fetch-account-deployment-info?"+i.nZ({org:e.toUpperCase(),accountAlias:t.toUpperCase()}),this.userStore.userRequestContext());if(!n.valid)return{valid:!1};return{...n,org:n.org.toUpperCase(),accountAlias:n.accountAlias.toUpperCase()}}catch(e){return console.error("Fetch account deployment info failed with err",e),{valid:!1}}}async fetchAccountDeploymentInfoFromURL(e){try{let t=await l.nufetch("/fetch-account-deployment-info-from-url?"+i.nZ({url:e}),this.userStore.userRequestContext());if(!t.valid)return{valid:!1};return{...t,org:t.org.toUpperCase(),accountAlias:t.accountAlias.toUpperCase()}}catch(e){return console.error("Fetch account deployment info from url failed with err",e),{valid:!1}}}getCurrentRegion(){return this.organizationStore.activeOrg.settings.region}constructor(...e){super(...e),this.dataDiscoverRole="",this.secondaryRoles="",this.availableRoles=[],this.currentWarehouse="",this.googleTagManagerInitialized=!1,this.dataDiscoverRoleInitializedResolver=e=>{},this.dataDiscoverRoleInitialized=new Promise(e=>{this.dataDiscoverRoleInitializedResolver=e}),this.loadUserStore=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.userStore=e})},this.loadOrganizationStore=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.organizationStore=e})},this.loadSecurableStore=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.securablePromises=e})},this.validateRoleWarehousePair=(e=!0)=>{var t;null==(t=this.dispatch)||t.call(this,t=>{if(""===t.currentWarehouse||!t.securablePromises)return;let n=t.roleWarehouseValidationKey=new Promise((o,r)=>{var a;null==(a=t.securablePromises)||a.list(t.dataDiscoverRole,R.M.WAREHOUSE,T.Y.show,void 0,{forceRefresh:e,filter:t.currentWarehouse}).then(e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.roleWarehouseValidationKey===n&&(e.result.map(e=>e.name).includes(t.currentWarehouse)||(t.currentWarehouse="",o(!1)),o(!0))})},e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.roleWarehouseValidationKey===n&&(t.currentWarehouse="",r(e))})})})})},this.setDataDiscoverRole=(e,t=!1)=>{var n;null==(n=this.dispatch)||n.call(this,t=>{var n,o,r,a,i;t.dataDiscoverRole=e,null==(o=t.userStore)||null==(n=o.switchCurrentRole)||n.call(o,e),t.currentWarehouse||(t.currentWarehouse=null==(i=t.userStore)||null==(a=i.currentUser)||null==(r=a.settings)?void 0:r.defaultWarehouse)}),t||this.validateRoleWarehousePair(!1),this.dataDiscoverRoleInitializedResolver(e);try{let t=(0,r._)();r._.set({...t,role:e})}catch(e){a.log.error(e)}},this.setSecondaryRoles=(e,t=!1)=>{var n;null==(n=this.dispatch)||n.call(this,t=>{var n,o;t.secondaryRoles=e,null==(o=t.userStore)||null==(n=o.switchCurrentSecondaryRoles)||n.call(o,e)}),t||this.validateRoleWarehousePair(!1)},this.setAvailableRoles=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.availableRoles=e})},this.setStripeHealthCheckStatus=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.stripeHealthCheckComplete=e})},this.setCurrentWarehouse=(e,t=!1)=>{var n;null==(n=this.dispatch)||n.call(this,t=>{t.currentWarehouse=e}),t||this.validateRoleWarehousePair(!1);try{let t=(0,r._)();r._.set({...t,warehouse:e})}catch(e){a.log.error(e)}},this.setMarketplaceLunrIdx=(e,t)=>{var n;null==(n=this.dispatch)||n.call(this,n=>{n.marketplaceLunrIdx={...n.marketplaceLunrIdx,idx:e,lastLoadTime:t}})},this.setMarketplaceLunrPromise=(e,t)=>{var n;null==(n=this.dispatch)||n.call(this,n=>{n.marketplaceLunrIdx={...n.marketplaceLunrIdx,promise:e,lastLoadTime:t}})},this.setProviderMarketplaceLunrIdx=(e,t)=>{var n;null==(n=this.dispatch)||n.call(this,n=>{n.providerMarketplaceLunrIdx={...n.providerMarketplaceLunrIdx,idx:e,lastLoadTime:t}})},this.setProviderMarketplaceLunrPromise=(e,t)=>{var n;null==(n=this.dispatch)||n.call(this,n=>{n.providerMarketplaceLunrIdx={...n.providerMarketplaceLunrIdx,promise:e,lastLoadTime:t}})},this.setGoogleTagManagerInitialized=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.googleTagManagerInitialized=e})},this.setAccountCreatedDetails=e=>{var t;null==(t=this.dispatch)||t.call(this,t=>{t.accountCreatedDetails=e})}}}let b=(0,C.q)(()=>(function(e){let t=new e,[n,o]=(0,v.useReducer)(function(e,t){return(0,y.Uy)(e,t)},t);return(0,v.useEffect)(()=>o(()=>new e(o)),[e]),n})(A))},634427:function(e,t,n){n.d(t,{q:()=>r});var o=n(792851);function r(e,...t){let[n,a]=(0,o.Z)(e,...t);return Object.defineProperties(a,{Provider:{get:()=>n}}),a}},332007:function(e,t,n){n.d(t,{p:()=>a,Z:()=>i});var o=n(792851),r=n(847345);let[a,i]=(0,o.Z)(()=>(function(){let[e,t]=(0,r.useState)({});return{getFetchId:(0,r.useCallback)(t=>`${e[t]||1}`,[e]),incrementFetchId:(0,r.useCallback)(e=>{t(t=>({...t,[e]:(t[e]||1)+1}))},[])}})())},327898:function(e,t,n){n.d(t,{O:()=>o});function o(e,t){let{getCacheKey:n,getData:o}=t,r=e?n():void 0,a=e&&r?e.getEntry(r):void 0;if(a)return a;let i=o();return e&&r&&e.setEntry(r,i),i}},664983:function(e,t,n){n.d(t,{m:()=>a});var o=n(847345),r=n(332007);function a(e){let{getFetchId:t,incrementFetchId:n}=(0,r.Z)();return{fetchId:t(e),updateFetchId:(0,o.useCallback)(()=>n(e),[n,e])}}},595124:function(e,t,n){n.d(t,{b:()=>r});var o=n(847345);function r(){let e=(0,o.useRef)({entries:{},currentEvictionBucketIndex:0,evictionBuckets:Array.from({length:6},()=>[])}),t=(0,o.useCallback)(t=>{var n;let{entries:o}=e.current;return null==(n=o[t])?void 0:n.data},[]),n=(0,o.useCallback)((t,n)=>{let{entries:o,currentEvictionBucketIndex:r,evictionBuckets:a}=e.current;o[t]={data:n,evictionBucketIndex:r},a[r].push(t)},[]),r=(0,o.useCallback)(t=>{let{entries:n}=e.current;delete n[t]},[]);return(0,o.useEffect)(()=>{let t=setInterval(()=>{let{entries:t,currentEvictionBucketIndex:n,evictionBuckets:o}=e.current,r=(n+1)%o.length;for(let e of o[r]){var a;(null==(a=t[e])?void 0:a.evictionBucketIndex)===r&&delete t[e]}o[r]=[],e.current.currentEvictionBucketIndex=r},6e4);return()=>{clearInterval(t)}},[]),(0,o.useMemo)(()=>({getEntry:t,setEntry:n,clearEntry:r}),[r,t,n])}},623368:function(e,t,n){n.d(t,{H$:()=>i,OY:()=>l,Oi:()=>a,bR:()=>u,x3:()=>s});var o=n(411733);let r=(e,...t)=>`${e}${t?":":""}${null==t?void 0:t.join(":")}`,a=e=>{var t,n;let o=e.isUserE2E?[...null!=(t=e.markers)?t:[],"user-e2e"]:[...null!=(n=e.markers)?n:[]];return r(e.event,...o)},i=(e,...t)=>{let n=a({event:e,markers:t});return performance.clearMarks(n),performance.mark(n)},l=(e,...t)=>{let n=a({event:e,markers:t,isUserE2E:!0});return performance.clearMarks(n),performance.mark(n)},s=e=>{let t=a(e),n=performance.getEntriesByName(t);return!!(n&&n.length>0&&n.filter(e=>"mark"===e.entryType).length>0)},u=(e,...t)=>{let n=t.join(":");try{return performance.measure(e,n)}catch(e){return o.cM.info("[TELEMETRY] measureEvent: Event start was not marked for the marker: ",n),{duration:-1}}}},403771:function(e,t,n){n.d(t,{z:()=>s});var o=n(80127),r=n(928874),a=n(847345),i=n(75065),l=n(623368);let s=()=>{let{logEvent:e}=(0,r.f1)(),t=(0,a.useCallback)((e,...t)=>l.H$(e,...t),[]),n=(0,a.useCallback)((e,...t)=>l.bR(e,...t),[]),s=(0,a.useCallback)((e,...t)=>l.OY(e,...t),[]),u=(0,a.useCallback)(e=>l.x3(e),[]),d=(0,a.useCallback)(e=>{let t;if(e.isUserE2E){let o=l.Oi(e);t=n(e.event,o).duration}let o=l.Oi({...e,isUserE2E:!1});return{durationMs:n(e.event,o).duration,e2eDurationMs:t}},[n]);return{markEventStart:t,measureEventDuration:n,markE2EEventStart:s,isMarkerSet:u,_getDurationsFromMarker:d,logEventToSnowflakeAndDatadog:(0,a.useCallback)(t=>{e(t),i.A.isDisallowedDatadogEvent(t)&&o.v.addAction(t.event,t.data)},[e])}}},266046:function(e,t,n){n.d(t,{k:()=>a});var o=n(80127),r=n(820875);function a(e,t){(0,r.WC)()&&console.error(e,t),o.v.addError(e,t)}},338291:function(e,t,n){n.d(t,{EQ:()=>r,Vm:()=>a,Yf:()=>o});let o="package-picker-start",r="environment-yaml-package-management-save-language-config",a="environment-yaml-package-management-save-anaconda-config"},807264:function(e,t,n){n.d(t,{S:()=>o});let o="SYSTEM$BASIC_RUNTIME"},443547:function(e,t,n){n.d(t,{R:()=>r});var o=n(799787);function r(e,t){let n=e.lastVersionLocationUri,r=e.liveVersionLocationUri,a=e.rootLocation;return!t&&r?{kind:"versioned",isLive:!0,rootLocation:r}:n?{kind:"versioned",isLive:!1,rootLocation:n}:{kind:"checkouts",rootLocation:(0,o.h)(a,"Invalid or unsupported location")}}},377053:function(e,t,n){n.d(t,{T:()=>r});var o=n(515477);function r(e){if((0,o.f)(e)){let[t,n]=e.split("/versions/");if((null==n?void 0:n.length)>0)return{stage:t,path:`/versions/${n}`};let o="/checkouts/",[r,a]=e.split(o);if((null==a?void 0:a.length)>0)return{stage:r,path:`${o}${a}`};let i="/commits/",[l,s]=e.split(i);return(null==s?void 0:s.length)>0?{stage:l,path:`${i}${s}`}:{stage:e,path:""}}let t=/^(@?(?:[^/"]*|"(?:[^"]|"")*")*)\/?(.*)/u.exec(e);return t?{stage:t[1].startsWith("@")?t[1]:`@${t[1]}`,path:t[2]}:{stage:e,path:""}}},515477:function(e,t,n){n.d(t,{f:()=>o});function o(e){return e.startsWith("snow://")}},674783:function(e,t,n){n.d(t,{A:()=>i});var o=n(847345),r=n(523930),a=n(134445);function i(){let{user:e}=(0,a.m)(["user"]),t="alter-entity-checkout";return(0,o.useCallback)(async({id:n,role:o,secondaryRoles:a})=>{let i=(0,r.BW)(n);return await e.api.query(i,{isInternal:!0,role:o,secondaryRoles:a,desc:t})},[e.api,t])}},255490:function(e,t,n){n.d(t,{U:()=>u});var o=n(847345),r=n(797325),a=n(800840),i=n(545163),l=n(360688),s=n(91559);function u(){let e=(0,o.useContext)(a.V1),{formatMessage:t}=(0,r.Z)();return(0,o.useCallback)(async(n,o,r)=>{let a=await (0,i.W)(e.get(o,n,l.Y.describe,{secondaryRoles:r}));if((0,s.D)(a)){var u;throw Error(t({id:"Could not get details for the object. Error: {message}"},{message:null==(u=a.error)?void 0:u.message}))}if(!a.result)throw Error(t({id:"Could not get details for the object. No result data."}));let d=a.result.columns[0];return d.rootLocation&&!d.lastVersionName?{kind:"checkouts",...d}:{kind:"versioned",...d}},[t,e])}},960058:function(e,t,n){n.d(t,{z:()=>m});var o=n(175117),r=n.n(o),a=n(847345),i=n(640579),l=n(452603),s=n(800840),u=n(360688),d=n(420174),c=n(329322),E=n(620400),f=n(28705),p=n(36534),S=n(134445),g=n(443547),_=n(674783),h=n(126020);let m=e=>{let{dataDiscoverRole:t,secondaryRoles:n,userStore:o}=(0,i.j)(),m=(0,s.fo)(t,{secondaryRoles:n}),I=(0,a.useContext)(s.V1),T=(0,S.m)(["query"]).query,R=(0,a.useMemo)(()=>{var t;let n=m.get(e,u.Y.describe).result;return(null==n||null==(t=n.columns)?void 0:t.length)?n.columns[0]:null},[e,m]),C=(0,_.A)(),y=(0,h.iA)(),v=null!==R,N=(0,a.useCallback)(()=>R?`Copy of ${R.name} ${r()().format("YYYY-MM-DD h:mm:ssa")}`:"",[R]),A=(0,a.useCallback)(async(e,r)=>{let a=new c.L(r?"ALTER SESSION SET ENABLE_COPY_FILES = TRUE, ENABLE_COPY_FILES_API_IN_STORAGE = TRUE":"ALTER SESSION UNSET ENABLE_COPY_FILES, ENABLE_COPY_FILES_API_IN_STORAGE");await o.api.query(a.toQuery(),{isInternal:!0,role:t,secondaryRoles:n,desc:r?"enable-copy-files-sql":"unset-copy-files-sql",pid:e})},[t,n,o.api]),b=(0,a.useCallback)(async(e,r)=>{var a;let i=new c.L("COPY FILES");i.add("INTO {}",(0,f.Q)(r)),i.add("FROM {}",(0,p.i)(null!=(a=null==R?void 0:R.rootLocation)?a:"")),await o.api.query(i.toQuery(),{isInternal:!0,role:t,secondaryRoles:n,desc:"copy-files-for-entity-clone",pid:e})},[t,n,null==R?void 0:R.rootLocation,o.api]),O=(0,a.useCallback)(async({newEntityName:o,newEntityTitle:r,useEmbeddedStage:a,shouldUseVersionedStage:i=!0,postCreationAction:s,getAdditionalProps:u})=>{var c;if(!v)throw Error("Duplication not ready yet.");let{mainFile:f,queryWarehouse:p,codeWarehouse:S}=R,_=(0,l.$3)(f),{type:h,database:m,schema:O,name:L}=e,k=null!=o?o:N(),w=`Duplicated from ${L}`,M={type:h,name:k,database:m,schema:O},{rootLocation:D}=(0,g.R)(R),U=D.endsWith("/")?D:`${D}/`,P=null,x=null!=(c=null==u?void 0:u(R))?c:{};if(a||i)return P=await I.create(t,M,{from:U,warehouse:S,queryWarehouse:p,title:null!=r?r:void 0,mainFile:_,comment:w,...x},{secondaryRoles:n}),i?await y({id:P,role:t,secondaryRoles:n}):await C({id:P,role:t,secondaryRoles:n}),s&&await s({newEntityFullIdentifier:P}),P;let F={type:d.M.STAGE,name:`${o} (Stage)`,database:m,schema:O},B=await I.create(t,F,{},{secondaryRoles:n});try{P=await I.create(t,M,{rootLocation:`@${(0,E.m)(B)}`,mainFile:_,warehouse:S,queryWarehouse:p,title:null!=r?r:"",comment:w,...x},{secondaryRoles:n})}catch(e){throw await I.drop(t,B,{secondaryRoles:n}),e}let G="";try{G=await T.createQuery(),await A(G,!0),await b(G,B)}catch(e){throw await I.drop(t,P,{secondaryRoles:n}),await I.drop(t,B,{secondaryRoles:n}),e}finally{G.length>0&&await T.deleteQuery(G)}return s&&await s({newEntityFullIdentifier:P,newEntityStageIdentifier:B}),P},[A,b,C,t,y,N,T,v,n,I,R,e]);return{sourceEntityDetails:R,duplicate:O,readyForDuplication:v}}},499273:function(e,t,n){n.d(t,{h:()=>d});var o=n(847345),r=n(800840),a=n(117194),i=n(360688),l=n(674783),s=n(523930),u=n(134445);let d=()=>{let e=function(){let{user:e}=(0,u.m)(["user"]),t="show-checkouts";return(0,o.useCallback)(async({id:n,role:o,secondaryRoles:r})=>{let a=(0,s.CG)(n);return await e.api.query(a,{isInternal:!0,role:o,secondaryRoles:r,desc:t})},[e.api,t])}(),t=(0,l.A)(),n=(0,o.useContext)(r.V1);return(0,o.useCallback)(async({id:o,role:r,secondaryRoles:l})=>{0===(await e({id:o,role:r,secondaryRoles:l})).rows.length&&(await t({id:o,role:r,secondaryRoles:l}),await (0,a.r)(n.get(r,o,i.Y.describe,{forceRefresh:!0,secondaryRoles:l})))},[e,t,n])}},126020:function(e,t,n){n.d(t,{LH:()=>c,iA:()=>E});var o=n(847345),r=n(797325),a=n(874437),i=n(276567),l=n(800840),s=n(545163),u=n(360688),d=n(91559);async function c(e,t,n,o){try{await e.alter(n,t,{add:!0,version:"live"},{secondaryRoles:o})}catch(e){var r,l;if((0,i.k)(e)&&(r=e.code,l=a.SFDBErrorCode.VSTAGE_LIVE_VERSION_EXISTS,void 0!==r&&void 0!==l&&f(r)===f(l)))return;throw e}}let E=()=>{let e=(0,o.useContext)(l.V1),{formatMessage:t}=(0,r.Z)();return(0,o.useCallback)(async({id:n,role:o,secondaryRoles:r})=>{await c(e,n,o,r);let a=await (0,s.W)(e.get(o,n,u.Y.describe,{secondaryRoles:r}));if((0,d.D)(a)){var i;throw Error(t({id:"Could not get details for the object. Error: {message}"},{message:null==(i=a.error)?void 0:i.message}))}if(!a.result)throw Error(t({id:"Could not get details for the object. No result data."}));return a.result.columns[0]},[t,e])};function f(e){return"number"==typeof e?e:parseInt(e,10)}},928853:function(e,t,n){n.d(t,{P:()=>i,X:()=>a});var o=n(847345);let r=(0,o.createContext)(null),a=r.Provider,i=()=>(0,o.useContext)(r)},940591:function(e,t,n){n.d(t,{Z:()=>s});var o=n(800840),r=n(583700),a=n(360688),i=n(940936),l=n(51802);function s(e){var t;let n=(0,o.fo)();if((0,l.$)())return!1;let s=n.get(e,a.Y.describe);if((0,i.M)(s))return null;let u=null==s||null==(t=s.result)?void 0:t.columns[0];return!!(null==u?void 0:u.runtimeName)&&u.runtimeName!==r.U}},51802:function(e,t,n){n.d(t,{$:()=>l,S:()=>i});var o=n(286204),r=n(847345);let a=(0,r.createContext)(!1),i=({children:e})=>(0,o.jsx)(a.Provider,{value:!0,children:e});i.displayName="StaticNotebookProvider";let l=()=>(0,r.useContext)(a)},952874:function(e,t,n){n.d(t,{r:()=>o});function o(e){for(let t of e)return!1;return!0}},452603:function(e,t,n){function o(e,t="/"){return e.startsWith(t)?e.substring(1):e}function r(e,t="/"){return e.startsWith(t)?e:`${t}${e}`}function a(e,t="/"){return e.endsWith(t)?e:`${e}${t}`}function i(e,t="/"){return e.endsWith(t)?e.substring(0,e.length-1):e}function l(e,t="/"){let n=e.lastIndexOf(t);return -1===n?"":e.slice(0,n)}function s(e,t){let n=a(o(t));return 0!==e.indexOf(n)?e:e.slice(n.length)}n.d(t,{$3:()=>o,FR:()=>i,X7:()=>l,kN:()=>a,mJ:()=>r,sR:()=>s})},825725:function(e,t,n){n.d(t,{Q:()=>r});let o={undefined:()=>0,boolean:()=>4,number:()=>8,string:e=>2*e.length,bigint:e=>r(e.toString()),function:e=>r(e.toString()),symbol:e=>r(e.toString()),object:e=>e?e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array?e.byteLength:Object.entries(e).reduce((e,[t,n])=>r(t)+r(n)+e,0):0};function r(e){return o[typeof e](e)}},343983:function(e,t,n){function o(e){return"function"==typeof e?e():e}function r(e,t){return o(e)?t:{}}function a(e,...t){return o(e)?t:[]}n.d(t,{V:()=>r,p:()=>a})},563626:function(e,t,n){n.d(t,{d:()=>r});var o=n(867668);function r(e,t){var n,r;if(t)return t;let a=null==e||null==(n=e.settings)?void 0:n.defaultRole;return a&&(null==e||null==(r=e.availableRoles)?void 0:r.includes(a))?a:o.PUBLIC_ROLE}},190279:function(e,t,n){n.d(t,{Bg:()=>I,HS:()=>T,N0:()=>_,Qe:()=>m,RL:()=>R,Te:()=>g,Zl:()=>S,aZ:()=>y,eO:()=>p,mj:()=>C,wZ:()=>f,zd:()=>h});var o=n(820875),r=n(289661),a=n(420174),i=n(329322),l=n(620400),s=n(904660),u=n(829490),d=n(159771),c=n(36534),E=n(113939);let f=(e,t)=>({isInternal:!0,role:e,secondaryRoles:t,desc:"generate-notebook-url"});function p(e){return new i.L().add("CALL SYSTEM$GENERATE_NOTEBOOK_URL_FROM_NAME({} , {} );",(0,c.i)((0,l.m)(e.fullNotebookIdentifier)),(0,u.S)(e.isAccountUsingPrivateLink)).toQuery()}function S({fullNotebookIdentifier:e,queryId:t}){return t?new i.L().add("CALL SYSTEM$GENERATE_READ_ONLY_NOTEBOOK_TOKEN_WITH_REPLAY_QUERY_ID({}, {});",(0,c.i)((0,l.m)(e)),(0,c.i)(t)).toQuery():new i.L().add("CALL SYSTEM$GENERATE_NOTEBOOK_TOKEN({});",(0,c.i)((0,l.m)(e))).toQuery()}function g(e){let t=new URL(e);return{baseUriParts:{host:t.hostname,port:""===t.port?443:Number(t.port),basePath:(0,o.WC)()?t.pathname.split("/").filter(e=>"bootstrap"!==e).join("/"):t.pathname},isHttps:"https:"===t.protocol}}function _(e){return e&&`${e.isHttps?"https":"http"}://${e.baseUriParts.host}:${e.baseUriParts.port}${e.baseUriParts.basePath}`}function h({fullNotebookIdentifier:e,queryId:t}){return new i.L().add("CALL SYSTEM$GET_NOTEBOOK_EXECUTION_MAIN_FILE({}, {});",(0,c.i)((0,l.m)(e)),(0,c.i)(t)).toQuery()}function m({database:e,schema:t}){let n=e&&t?`${e}.${t}`:"",o=new i.L;return n?o.add("SELECT SYSTEM$SHOW_NOTEBOOK_COMPUTE_POOLS(?)",(0,c.i)(n)):o.add("SELECT SYSTEM$SHOW_NOTEBOOK_COMPUTE_POOLS()"),o.toQuery()}function I({notebookUrlId:e}){return new i.L().add("CALL SYSTEM$GET_USER_PREFERENCE({}, {}, {});",(0,c.i)(a.M.NOTEBOOK),(0,c.i)(e),(0,c.i)("session_settings")).toQuery()}function T({notebookUrlId:e,sessionSettingsData:t}){return new i.L().add("CALL SYSTEM$SET_USER_PREFERENCE({}, {}, {}, {});",(0,c.i)(a.M.NOTEBOOK),(0,c.i)(e),(0,c.i)("session_settings"),(0,c.i)(t)).toQuery()}function R({fullNotebookIdentifier:e}){return new i.L().add("CALL SYSTEM$IS_ENTITY_READONLY_REPLICA({}, {});",(0,c.i)("NOTEBOOK"),(0,c.i)((0,l.m)(e))).toQuery()}function C({fullNotebookIdentifier:e}){return new i.L().add("CALL SYSTEM$NOTEBOOK_BOOTSTRAP({});",(0,c.i)((0,l.m)(e))).toQuery()}function y(e){let{entityId:t,scheduleName:n,scheduleCronExpression:o,scheduleTimezone:l,warehouse:u,params:f}=e,p=!!f,S=new i.L;if(S.add("CREATE TASK IDENTIFIER(?) WAREHOUSE={} SCHEDULE={}",(0,d.M)({type:a.M.TASK,name:n,database:t.database,schema:t.schema}),(0,c.i)(u),(0,c.i)(`USING CRON ${o} ${l||"UTC"}`)),p){let e=(0,r.J)([{id:0,key:"params",value:null!=f?f:""}]);S.add(`CONFIG=$$${e}$$ AS BEGIN LET PARAMS STRING := SYSTEM$GET_TASK_GRAPH_CONFIG('params')::string;`),S.add("EXECUTE {} {}(:PARAMS)",(0,E.V)(t.type),(0,d.M)(t))}else S.add("AS EXECUTE {} {}()",(0,E.V)(t.type),(0,d.M)(t));let{queryWarehouse:g,codeWarehouse:_,computePool:h,runtimeName:m,runtimeEnvironmentVersion:I,externalAccessIntegrations:T}=e;return S.add("QUERY_WAREHOUSE={}",(0,c.i)(g)),_&&S.add("WAREHOUSE={}",(0,c.i)(_)),h&&S.add("COMPUTE_POOL={}",(0,c.i)(h)),m&&S.add("RUNTIME_NAME={}",(0,c.i)(m)),I&&S.add("RUNTIME_ENVIRONMENT_VERSION={}",(0,c.i)(I)),(null==T?void 0:T.length)&&S.add("EXTERNAL_ACCESS_INTEGRATIONS=({})",(0,s.D)(T)),p?S.add("; END;"):S.add(";"),S.toQuery()}},611646:function(e,t,n){n.d(t,{y:()=>r});var o=n(854290);function r(e){return(0,o.m)(e)}},606765:function(e,t,n){n.d(t,{F9:()=>u,Z1:()=>E,hV:()=>c,zv:()=>d});var o=n(632189),r=n(41598),a=n(611646);let i=async({simpleAppsSupport:e},t)=>{try{return{data:await e.isSimpleApp(t)}}catch(e){return{error:(0,a.y)(e)}}},l=async({simpleAppsSupport:e},t)=>{try{return{data:await e.getAppNotebooks(t)}}catch(e){return{error:(0,a.y)(e)}}},s=async({simpleAppsSupport:e},t)=>{try{return{data:await e.getSimpleAppSource(t)}}catch(e){return{error:(0,a.y)(e)}}},{useIsSimpleAppQuery:u,useLazyIsSimpleAppQuery:d,useGetAppNotebooksQuery:c,useGetSimpleAppSourceQuery:E}=r.h.injectEndpoints({endpoints:e=>({isSimpleApp:e.query({queryFn:(0,o.V)(i)}),getAppNotebooks:e.query({queryFn:(0,o.V)(l)}),getSimpleAppSource:e.query({queryFn:(0,o.V)(s)})})})},209036:function(e,t,n){n.d(t,{l:()=>i});var o=n(709088),r=n(626195),a=n(916193);class i{getPath(){return this.path}goBackOrNavigate(e,t={},n=[]){let o=a.lm.entries;if(o.length>1)for(let e=o.length-2;e>=0;e--){if(this.matchesAgainstPath(o[e].pathname))return void a.lm.push(o[e].pathname+o[e].search);let t=!1;for(let r of n)if(r.matchesAgainstPath(o[e].pathname)){t=!0;break}if(!t)break}a.lm.push(this.getURL(e,t))}goBackWithDataOrNavigate(e,t={},n=[]){let o={...e};Object.entries(o).forEach(([e,t])=>{"string"==typeof t&&(o[e]=decodeURIComponent(t))});let r=a.lm.entries;if(r.length>1)for(let e=r.length-2;e>=0;e--){let t=!1;for(let o of[...n,this])if(o.matchesAgainstPath(r[e].pathname)){t=!0;break}if(t){if(this.getURL(o)===r[e].pathname)return void a.lm.push(r[e].pathname+r[e].search)}else break}a.lm.push(this.getURL(o,t))}getURL(e,t){return(0,r.m)(this.path,e,t)}navigate(e,t={}){a.lm.push(this.getURL(e,t))}replaceCurrentURL(e,t={}){a.lm.replace(this.getURL(e,t))}matchesAgainstPath(e){return"string"!=typeof(0,o.Yt)(this.path,e)}constructor(e){this.path=e.path,this.page=e.page,this.validLoggingRouteResolver=e.validLoggingRouteResolver}}},38362:function(e,t,n){n.d(t,{k:()=>a});var o=n(209036),r=n(118589);let a=new o.l({path:[`${(0,r.D)()}/notebooks/id/{notebookUniqueId:string}`,`${(0,r.D)()}/notebooks/{entityIdStr:string}`],page:"notebook_detail"})},411089:function(e,t,n){n.d(t,{a:()=>o});function o(e,t){let n;n=t instanceof URLSearchParams?Array.from(t.entries()):Object.entries(t);let o=e;if(n.length>0){let t=n.map(([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&");o=`${e}?${t}`}return o}},709088:function(e,t,n){n.d(t,{Mp:()=>s,Yt:()=>l});var o=n(600565),r=n.n(o),a=n(581438);function i(e,t){let n=[].concat(e);for(n=n.map(e=>(0,a.Q)(e)),t=(0,a.Q)(t);n.length;){let e=t.split("/").filter(e=>e.length),o=n.shift(),a=o||"",i=o.replace(/^\//,"").replace(/\/$/,"").split("/").filter(e=>e.length);if("*"!==i.at(-1)&&e.length!==i.length)continue;let l={},s=!1;for(;i.length;){let t=e.shift(),n=i.shift();if(n.startsWith("{")){let e=n.slice(1,-1),o=e.split(":");switch(o[1].replace(/<[^>]*>/,"")){case"number":l[o[0]]=+t;break;case"string":l[o[0]]=decodeURIComponent(t);break;case"exists":t===o[0]?l[o[0]]=!0:s=!0;break;case"enum":let i=o[1].match(/enum<([^>]+)>/);if(null==i?void 0:i[1].match(RegExp(`(^|\\|)${r()(t)}(\\||$)`))){l[o[0]]=t;let e=RegExp(`/{${String(o[0])}:enum<([^\\|}]+(?:\\|[^\\|}]+)+)>}(?:/|$)`);(null==a?void 0:a.match(e))&&(a=a.replace(e,`/${encodeURIComponent(r()(t))}/`))}else s=!0;break;default:let u=this.constructor.name;return{data:`Unknown data typing of "{${e}}" in ${u}.`,path:""}}}else if(t===n)continue;else if(n&&"*"!==n||0!==i.length){s=!0;break}else break}if(!s)return{data:l,path:a}}return{data:`There was a path mismatch for the URL at "${t}"`,path:""}}function l(e,t){return i(e,t).data}function s(e,t){return i(e,t).path}},118589:function(e,t,n){n.d(t,{D:()=>o});function o(){return"/{region:string}/{org:string}"}},974053:function(e,t,n){n.d(t,{s:()=>r});var o=n(916193);function r(e=o.lm.location.search){return new URLSearchParams(decodeURI(e))}},626195:function(e,t,n){n.d(t,{m:()=>a});var o=n(411089),r=n(118589);function a(e,t={},n={},i=!1){let l=[].concat(e),s="";for(l=l.map(e=>e.includes((0,r.D)())?e.replace((0,r.D)(),"/{region:string}/{org:string}/#"):e);l.length;){let e=!1,r=`/${l.shift().replace(/^\//,"")}`;for(let n in t){let o=t[n];if(null==o)continue;let a=RegExp(`/{${n}:string}(?:/|$)`),i=RegExp(`/{${n}:exists}(?:/|$)`),l=RegExp(`/{${n}:enum<([^\\|}]+(?:\\|[^\\|}]+)*)>}(?:/|$)`);if(r.match(a))r=r.replace(a,`/${encodeURIComponent(o)}/`);else if(r.match(i))r=r.replace(i,`/${encodeURIComponent(n)}/`);else if(r.match(l)&&r.match(l)[1].split("|").includes(o))r=r.replace(l,`/${encodeURIComponent(o)}/`);else{e=!0;break}}if(!r.match(/{/)){r=r.replace(/\/$/,"");let t=(0,o.a)(r,n);if(!e)return t.replace(/%25/g,"%2525");s=s||t;break}}if(s){let e=`Left over data when building URL "${s}". Supplied data: ${JSON.stringify(t)}`;if(i)throw Error(e);return console.error(e),encodeURI(s)}throw Error(`Invalid data supplied to "${e}". Supplied data: ${JSON.stringify(t)}`)}},581438:function(e,t,n){n.d(t,{Q:()=>o});function o(e){return e.includes("/#/")?e.replace("/#/","/"):e}},800840:function(e,t,n){n.d(t,{V1:()=>g,fo:()=>_});var o=n(78633),r=n(947272),a=n(288060),i=n.n(a),l=n(847345),s=n(640579),u=n(563626),d=n(724097),c=n(827755),E=n(362772),f=n(91559),p=n(940936),S=n(134445);let g=l.createContext(void 0);function _(e,t={}){let{secondaryRoles:n,sessionContext:o}=t,a=(0,l.useContext)(g),i=(0,l.useContext)(r.BQ),d=(0,s.j)(),c=(0,l.useContext)(S.L),E=null==c?void 0:c.user,f=e||(null==E?void 0:E.currentRole())||(0,u.d)(null==E?void 0:E.currentUser),p=null!=n?n:d.secondaryRoles,[,m]=(0,l.useState)(0),I={};return(0,l.useEffect)(()=>{let e=Object.values(I).map(e=>e(()=>{m(e=>e+1)}));return()=>{for(let t of e)t()}}),new h(f,p,a,I,i,o)}class h{async create(e,t,n){return this.securableStore.create(this.role,e,t,{profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,...n})}async clone(e,t,n,o){return this.securableStore.clone(this.role,e,t,n,{profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,...o})}async alter(e,t,n){return this.securableStore.alter(this.role,e,t,{profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,...n})}async drop(e,t){return this.securableStore.drop(this.role,e,{profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,...t})}async undrop(e,t){return this.securableStore.undrop(this.role,e,{profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,...t})}useList(e,t,n,r){let a=this.useListSkippable(e,t,n,r),i=(0,o.N)({profiler:this.profiler,...r}),s=(0,o.N)(n),u=this.role,d=l.useCallback(()=>this.securableStore.list(u,e,t,s,{...i,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,forceRefresh:!0}),[u,t,s,e,i]);if(void 0===a)throw Error("skipped somehow");return[a,d]}useListSkippable(e,t,n,o){let r=this.useListSkippableNoThrowAux(e,t,n,o);if(r){if((0,p.M)(r.value))throw(0,c.d)(r);if((0,f.D)(r.value))throw r.value.error;return r.value}}useListSkippableNoThrowAux(e,t,n,r){let[,a]=(0,l.useState)(null),i=(0,o.N)({profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,...r}),s=this.role;if((0,l.useEffect)(()=>{if(null==i||!i.skipFetch)return this.securableStore.list(s,e,t,n,i).register(a)},[s,e,t,n,i]),null==i||!i.skipFetch)return this.securableStore.list(s,e,t,n,i)}useListSkippableNoThrow(e,t,n,o){var r;return null==(r=this.useListSkippableNoThrowAux(e,t,n,o))?void 0:r.value}useGet(e,t,n){let o=this.useGetSkippable(e,t,n);if(void 0===o)throw Error("skipped somehow");return o}useGetMulti(e,t,n){let r=t instanceof Array?t:[t],a=r.map(t=>this.useGet(e,t,n)),s=(0,l.useMemo)(()=>Object.assign({},...i()(a,["lastLoadTime"]).map(e=>e.result)),a),u=Object.fromEntries(a.map((e,t)=>[r[t],e])),d=(0,o.N)(n),c=this.role;return{merged:s,bylevel:u,refresh:l.useCallback(t=>this.securableStore.get(c,e,t,{profiler:this.profiler,...d,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,forceRefresh:!0}),[c,e,d])}}useGetSkippableNoThrowAux(e,t,n){let[,r]=(0,l.useState)({result:void 0,loadState:E.p.loading});n=(0,o.N)({profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,...n});let a=this.role;if((0,l.useEffect)(()=>{if(null==n?void 0:n.skipFetch)return;let o=this.securableStore.get(a,e,t,n);return r(o.value),o.register(r)},[a,e,t,n]),null==n||!n.skipFetch)return this.securableStore.get(a,e,t,n)}useGetSkippableNoThrow(e,t,n){var o;return null==(o=this.useGetSkippableNoThrowAux(e,t,n))?void 0:o.value}useGetSkippable(e,t,n){let o=this.useGetSkippableNoThrowAux(e,t,n);if(o){if((0,p.M)(o.value))throw(0,d.c)(o);if((0,f.D)(o.value))throw o.value.error;return o.value}}get(e,t,n){var o;let r=null!=(o=null==n?void 0:n.role)?o:this.role,a=this.securableStore.get(r,e,t,{profiler:this.profiler,...n,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles});return this.registersMap[a.updatingKey]=a.register,a.value}listIds(e,t,n,o){var r;let a=null!=(r=null==o?void 0:o.role)?r:this.role,i=this.securableStore.list(a,e,t,n,{profiler:this.profiler,...o,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles});return this.registersMap[i.updatingKey]=i.register,i.value}useRefreshGet(e,t,n){let r=(0,o.N)(n),a=(0,o.N)(e);return l.useCallback(()=>this.securableStore.get(this.role,a,t,{profiler:this.profiler,...r,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,forceRefresh:!0}),[a,t,r])}useHydratedList(e,t,n,r){let[a,i]=this.useHydratedListSkippable(e,t,n,r),s=(0,o.N)({profiler:this.profiler,...r}),u=(0,o.N)(n),d=this.role,c=l.useCallback(()=>this.securableStore.list(d,e,t,u,{...s,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,forceRefresh:!0}),[d,t,u,e,s]);if(void 0===a||void 0===i)throw Error("skipped somehow");return[a,i,c]}useHydratedListNoThrow(e,t,n,r){let a=this.useListSkippableNoThrow(e,t,n,r),i=(0,o.N)({profiler:this.profiler,...r}),s=(0,o.N)(n),u=null==r?void 0:r.requestContext,d=this.role,c=(0,o.N)(this.sessionContext),E=l.useCallback(()=>this.securableStore.list(d,e,t,s,{...i,sessionContext:c,forceRefresh:!0}),[d,e,t,s,i,c]);return[(0,l.useMemo)(()=>{var e;return null==a||null==(e=a.result)?void 0:e.map(e=>{var n;return this.securableStore.get(this.role,e,t,{profiler:this.profiler,ttlMs:Number.MAX_SAFE_INTEGER,requestContext:u,sessionContext:this.sessionContext,secondaryRoles:null!=(n=null==r?void 0:r.secondaryRoles)?n:this.secondaryRoles}).value.result},this.profiler)},[a,t,u,null==r?void 0:r.secondaryRoles]),a,E]}useHydratedListSkippable(e,t,n,r){let a=this.useListSkippable(e,t,n,r),i=(0,o.N)(null==r?void 0:r.requestContext),s=null==a?void 0:a.result;return[(0,l.useMemo)(()=>null==s?void 0:s.map(e=>{var n;return this.securableStore.get(this.role,e,t,{profiler:this.profiler,ttlMs:Number.MAX_SAFE_INTEGER,requestContext:i,sessionContext:this.sessionContext,secondaryRoles:null!=(n=null==r?void 0:r.secondaryRoles)?n:this.secondaryRoles}).value.result},this.profiler),[s,t,i,null==r?void 0:r.secondaryRoles]),a]}grant(e,t){return this.securableStore.grant(this.role,e,{profiler:this.profiler,sessionContext:this.sessionContext,secondaryRoles:this.secondaryRoles,...t})}useIsRefreshing(e){let[t,n]=(0,l.useState)(!1),[o,r]=(0,l.useState)(e);return(0,l.useEffect)(()=>{if(!o)return;let e=this.securableStore.areRefreshesWithIDPending(o);return n(e.value||!0),e.register(e=>{n(e),r(void 0)})},[o]),[t,o,r]}constructor(e,t,n,o,r,a){this.role=e,this.secondaryRoles=t,this.securableStore=n,this.registersMap=o,this.profiler=r,this.sessionContext=a}}},724097:function(e,t,n){n.d(t,{c:()=>a});var o=n(872083),r=n(91559);function a(e){return new Promise((t,n)=>{let a=e.register(e=>{(0,r.D)(e)?(a(),n(e.error)):(0,o.j)(e)&&(a(),t(e))})})}},827755:function(e,t,n){n.d(t,{d:()=>a});var o=n(91559),r=n(514209);function a(e){return new Promise((t,n)=>{let a=e.register(e=>{(0,o.D)(e)?(a(),n(e.error)):(0,r.g)(e)&&(a(),t(e))})})}},117194:function(e,t,n){n.d(t,{r:()=>a});var o=n(940936),r=n(426384);function a(e,t){return new Promise(n=>{if((0,r.O)(e.value)||(0,o.M)(e.value)){let a=e.register(e=>{(0,r.O)(e)||(0,o.M)(e)||(t||a(),n(e))})}else n(e.value)})}},545163:function(e,t,n){n.d(t,{W:()=>r});var o=n(940936);function r(e){return new Promise(t=>{if((0,o.M)(e.value)){let n=e.register(e=>{(0,o.M)(e)||(n(),t(e))})}else t(e.value)})}},530064:function(e,t,n){n.d(t,{g:()=>S,w:()=>p});var o=n(420174),r=n(793589),a=n(329322),i=n(996913),l=n(924218),s=n(159771),u=n(36534),d=n(359248),c=n(653546),E=n(721208),f=n(886608);let p=e=>{var t,n,r,l;let d,p,S=(null==(t=e.id)?void 0:t.name)||"",g=(null==(l=e.options)||null==(r=l.extras)||null==(n=r.filter)?void 0:n.toString())||"",_=(0,s.M)({name:S,type:o.M.APPLICATION});g?(d="CALL SYSTEM$GET_REFERENCE_DEFINITIONS(?,[?])",p=[_,(0,u.i)(g)]):(d="CALL SYSTEM$GET_REFERENCE_DEFINITIONS(?)",p=[_]);let h=new a.L(d,...p).toQuery();return{...e,query:h,adapter:e=>{var t,n,r;let a=null!=(r=null==(n=e.rows)||null==(t=n[0])?void 0:t[0])?r:"",l=a?(0,E.F)(a):[],s=(0,f.y)(l);return s.forEach(e=>{let t=e.objectType.toLowerCase();if("api integration"===t)e.objectType=o.M.API_INTEGRATION;else if("external table"===t)e.objectType=o.M.EXTERNAL_TABLE;else if("external_access integration"===t||"external access integration"===t)e.objectType=o.M.EXTERNAL_ACCESS_INTEGRATION;else if("function"===t||"procedure"===t){let t=e.bindings;for(let e=0;e<t.length;e++)if(t[e].name){let n=t[e],{args:o,name:r}=(0,i.L)(n.name);n.name=(0,c.Z2)(r)||r,n.args=o}}}),{rows:[{id:{type:o.M.APPLICATION,name:S},references:s}]}},desc:"show-application-references"}},S=(e,t)=>{let n,i=e.reference;if(!i)return[];let c=(0,l.y)({type:o.M.PROCEDURE,database:t.name,...i.registerCallback}),E=[],f=(0,u.i)(i.name),p=(0,u.i)(i.actionType);switch(i.actionType){case r.l.ADD:if(i.objects&&i.objects.length>0){n=`call ${c}(?, {}, system$reference({}, ?, 'PERSISTENT', {}))`;for(let e=0;e<i.objects.length;e++){let t=i.objects[e],o=(0,s.M)(t,{withArgs:!0}),r=(0,u.i)(t.type),l=new a.L().add(n,f,p,r,o,(0,d.K)(i.privileges||[]));E.push({...l.toQuery(),desc:"set-reference-add"})}}break;case r.l.REMOVE:if(i.objects&&i.objects.length>0){n=`call ${c}(?, {}, ?)`;for(let e=0;e<i.objects.length;e++){let t=(0,u.i)(i.objects[e]),o=new a.L().add(n,f,p,t);E.push({...o.toQuery(),desc:"set-reference-remove"})}}break;case r.l.CLEAR:{n=`call ${c}(?, {}, '')`;let e=new a.L().add(n,f,p);E.push({...e.toQuery(),desc:"set-reference-clear"})}}return E}},583700:function(e,t,n){n.d(t,{T:()=>o,U:()=>r});let o="SYSTEM$STREAMLIT_NOTEBOOK_WH",r="SYSTEM$WAREHOUSE_RUNTIME"},852871:function(e,t,n){n.d(t,{w3:()=>ep,n5:()=>eT,As:()=>eg,jJ:()=>eE,Vq:()=>eR,pV:()=>ei,Nj:()=>eh,r5:()=>ef,_t:()=>ea,Vk:()=>eC,rW:()=>er});var o=n(969452),r=n.n(o),a=n(114858),i=n.n(a),l=n(420174),s=n(329322),u=n(159771),d=n(370264);function c(e,t){if(t.type===l.M.EXTERNAL_TABLE)e.add("{} IDENTIFIER(?)",(0,d.T)(l.M.TABLE),(0,u.M)(t));else if(t.type===l.M.ML_MODEL_VERSION){let n={database:t.database,schema:t.schema,name:t.module,type:l.M.ML_MODEL};e.add("MODEL IDENTIFIER (?) MODIFY VERSION {}",(0,u.M)(n),{bindingsJSONRepr:t.name,inlineRepr:t.name})}else e.addFullyQualifiedIdentifier(t)}var E=n(903542),f=n(217386),p=n(154079),S=n(829490),g=n(274271),_=n(64562),h=n(516415),m=n(144237),I=n(468690),T=n(36534),R=n(113939),C=n(19318),y=n(76954),v=n(523311),N=n(264602);let A={[v.Q.EDIT_APP_PACKAGE]:({id:e,alterProps:t,descPrefix:n})=>{let{comment:o,distribution:r}=t,a=new s.L;return a.add("ALTER APPLICATION PACKAGE {} SET COMMENT = {} DISTRIBUTION = {}; ",(0,u.M)(e),(0,T.i)(o),(0,R.V)(r)),{alterSqlQuery:a.toQuery(),desc:`${n}-edit`}},[v.Q.RENAME_APP_PACKAGE]:({id:e,alterProps:t,descPrefix:n})=>{let{name:o}=t,r=new s.L;return r.add("ALTER APPLICATION PACKAGE IDENTIFIER(?) RENAME TO IDENTIFIER(?)",(0,u.M)(e),(0,u.M)({type:l.M.APPLICATION_PACKAGE,name:o})),{alterSqlQuery:r.toQuery(),desc:`${n}-rename`,newName:o}},[v.Q.ADD_VERSION]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o,pathToVersionDirectory:r,label:a,releaseChannel:i}=t,l=new s.L;return l.add("ALTER APPLICATION PACKAGE {}",(0,u.M)(e)),i?l.add("MODIFY RELEASE CHANNEL {} ADD VERSION {}",(0,N.t)(i),(0,N.t)(o)):l.add("ADD VERSION {} USING {} LABEL = {}",(0,N.t)(o),(0,T.i)(r),(0,T.i)(null!=a?a:"")),{alterSqlQuery:l.toQuery(),desc:i?`${n}-add-version-to-release-channel`:`${n}-add-version`}},[v.Q.ADD_PATCH_TO_VERSION]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o,pathToVersionDirectory:r,label:a}=t;return{alterSqlQuery:new s.L().add("ALTER APPLICATION PACKAGE IDENTIFIER(?) ADD PATCH FOR VERSION {} USING {} LABEL = {}",(0,u.M)(e),(0,N.t)(o),(0,T.i)(r),(0,T.i)(null!=a?a:"")).toQuery(),desc:`${n}-create-new-patch`}},[v.Q.DROP_VERSION]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o}=t;return{alterSqlQuery:new s.L().add("ALTER APPLICATION PACKAGE {} DROP VERSION {}",(0,u.M)(e),(0,N.t)(o)).toQuery(),desc:`${n}-drop-version`}},[v.Q.SET_DEFAULT_RELEASE_DIRECTIVE]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o,patch:r,releaseChannel:a}=t,i=new s.L;return i.add("ALTER APPLICATION PACKAGE {}",(0,u.M)(e)),a&&i.add("MODIFY RELEASE CHANNEL {}",(0,N.t)(a)),i.add("SET DEFAULT RELEASE DIRECTIVE VERSION = {} PATCH = {}",(0,N.t)(o),(0,m._)(r)),{alterSqlQuery:i.toQuery(),desc:a?`${n}-set-default-release-directive-for-release-channel`:`${n}-set-default-release-directive`}},[v.Q.SET_RELEASE_DIRECTIVE]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o,patch:r,directiveName:a,accounts:i,releaseChannel:d}=t,c=new s.L,E=i.map(e=>(0,u.M)({type:l.M.ACCOUNT,...e}));return c.add("ALTER APPLICATION PACKAGE {}",(0,u.M)(e)),d&&c.add("MODIFY RELEASE CHANNEL {}",(0,N.t)(d)),c.add("SET RELEASE DIRECTIVE {} ACCOUNTS = (",(0,N.t)(a)),E.forEach((e,t)=>{let n=t===E.length-1;c.add(n?"{}":"{}, ",e)}),c.add(") VERSION = {} PATCH = {}",(0,N.t)(o),(0,m._)(r)),{alterSqlQuery:c.toQuery(),desc:d?`${n}-set-release-directive-for-release-channel`:`${n}-set-release-directive`}},[v.Q.UNSET_RELEASE_DIRECTIVE]:({id:e,alterProps:t,descPrefix:n})=>{let{directiveName:o,releaseChannel:r}=t,a=new s.L;return a.add("ALTER APPLICATION PACKAGE {}",(0,u.M)(e)),r&&a.add("MODIFY RELEASE CHANNEL {}",(0,N.t)(r)),a.add("UNSET RELEASE DIRECTIVE {}",(0,N.t)(o)),{alterSqlQuery:a.toQuery(),desc:r?`${n}-unset-release-directive-for-release-channel`:`${n}-unset-release-directive`}},[v.Q.MODIFY_RELEASE_DIRECTIVE]:({id:e,alterProps:t,descPrefix:n})=>{let{directiveName:o,version:r,patch:a,releaseChannel:i}=t,l=new s.L;return l.add("ALTER APPLICATION PACKAGE {}",(0,u.M)(e)),i&&l.add("MODIFY RELEASE CHANNEL {}",(0,N.t)(i)),l.add("MODIFY RELEASE DIRECTIVE {} VERSION = {} PATCH = {}",(0,N.t)(o),(0,N.t)(r),(0,m._)(a)),{alterSqlQuery:l.toQuery(),desc:i?`${n}-modify-release-directive-for-release-channel`:`${n}-modify-release-directive`}},[v.Q.REGISTER_VERSION]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o,pathToVersionDirectory:r,label:a}=t;return{alterSqlQuery:new s.L().add("ALTER APPLICATION PACKAGE {} REGISTER VERSION {} USING {} LABEL = {}",(0,u.M)(e),(0,N.t)(o),(0,T.i)(r),(0,T.i)(null!=a?a:"")).toQuery(),desc:`${n}-register-version`}},[v.Q.DEREGISTER_VERSION]:({id:e,alterProps:t,descPrefix:n})=>{let{version:o}=t;return{alterSqlQuery:new s.L().add("ALTER APPLICATION PACKAGE {} DEREGISTER VERSION {}",(0,u.M)(e),(0,N.t)(o)).toQuery(),desc:`${n}-deregister-version`}}},b=e=>{let{alterSqlQuery:t,desc:n,newName:o}=(0,A[e.alterProps.alterType])(e);return{alters:[{...t,desc:n}],newName:null!=o?o:""}};var O=n(530064),L=n(366202);let k=(e,t)=>{let{shareId:n,distribution:o,title:r,description:a,profile:i,targetAccounts:l,regions:d,autoFulfillment:c,reviewParameter:E="FALSE",publishParameter:f="FALSE"}=t,p={title:r,description:a,profile:null!=i?i:void 0,terms_of_service:{type:"OFFLINE"},targets:{accounts:l.length>0?l:void 0,regions:d.length>0?d:void 0},auto_fulfillment:c?{refresh_type:c.refreshType,refresh_schedule:c.refreshSchedule}:void 0};return new s.L().add("CREATE LISTING IDENTIFIER(?) FOR SHARE IDENTIFIER(?) AS {} DISTRIBUTION={} REVIEW={} PUBLISH={}",(0,u.M)(e),(0,u.M)(n),(0,L.Z)(p,{forceQuotes:!0}),(0,R.V)(o),(0,R.V)(E),(0,R.V)(f)).toQuery()},w=e=>new s.L().add("DROP LISTING IDENTIFIER(?)",(0,u.M)(e)).toQuery();var M=n(802417),D=n(586575);let U=e=>{if(e)return{featured:e}},P=e=>{var t,n;if(e)return{documentation:null!=(t=e.documentation)?t:void 0,media:null!=(n=e.media)?n:void 0}},x=e=>{var t,n,o,r,a,l;let s=P(e.resources),u=U(e.dataDictionary);return{title:e.title,subtitle:null!=(t=e.subtitle)?t:void 0,description:null!=(n=e.description)?n:void 0,custom_contact:null!=(o=e.customContact)?o:void 0,profile:null!=(r=e.profile)?r:void 0,terms_of_service:{type:e.termsOfService.type,link:null!=(a=e.termsOfService.link)?a:void 0},auto_fulfillment:e.autoFulfillment?{refresh_type:e.autoFulfillment.refreshType,refresh_schedule:e.autoFulfillment.refreshSchedule}:void 0,business_needs:e.businessNeeds,targets:{accounts:e.targetAccounts,regions:e.regions},usage_examples:e.usageExamples,categories:e.categories,resources:s,data_attributes:e.dataAttributes?{refresh_rate:e.dataAttributes.refreshRate,geography:{geo_option:e.dataAttributes.geography.geoOption,granularity:e.dataAttributes.geography.granularity,coverage:e.dataAttributes.geography.coverage},time:(0,D.l)(e.dataAttributes.time,i()),features:null!=(l=e.dataAttributes.features)?l:void 0}:void 0,data_dictionary:u}},F={[M.d.EDIT]:({id:e,alterProps:t,descPrefix:n})=>{let{listingDetails:o}=t,r=x(o);return{alterSqlQuery:new s.L("ALTER LISTING IDENTIFIER(?) AS {}",(0,u.M)(e),(0,L.Z)(r,{forceQuotes:!0})).toQuery(),desc:`${n}-edit`}},[M.d.PUBLISH]:({id:e,descPrefix:t})=>({alterSqlQuery:new s.L("ALTER LISTING IDENTIFIER(?) PUBLISH",(0,u.M)(e)).toQuery(),desc:`${t}-publish`}),[M.d.UNPUBLISH]:({id:e,descPrefix:t})=>({alterSqlQuery:new s.L("ALTER LISTING IDENTIFIER(?) UNPUBLISH",(0,u.M)(e)).toQuery(),desc:`${t}-unpublish`})},B=e=>{let{alterSqlQuery:t,desc:n,newName:o}=(0,F[e.alterProps.alterType])(e);return{alters:[{...t,desc:n.replaceAll("_","-").toLowerCase()}],newName:null!=o?o:""}};var G=n(96445),V=n(523930);function K(e){return(t,n)=>e(t,n)}function W(e,t){let n=`alter-${e.type.toLowerCase()}`;return`${n}-${t}`}let H=K((e,t)=>{if(!t.push)return null;if(t.secret&&t.push){let{secret:n,name:o,email:r,comment:a,to:i}=t;return[{...(0,V.fd)(e,{secret:n,name:o,email:r,comment:a,to:i}),desc:W(e,"push")}]}let{username:n,password:o,name:r,email:a,comment:i,to:l}=t;return[{...(0,V.fd)(e,{username:n,password:o,name:r,email:a,comment:i,to:l}),desc:W(e,"push")}]}),$=K((e,t)=>{if(!0===t.add){let{from:n,live:o}=t;return[{...(0,V.Hb)(e,{from:n,live:o||!n}),desc:W(e,"add-version")}]}return null}),Q=K((e,t)=>!0===t.commit?[{...(0,V.Tp)(e),desc:W(e,"commit")}]:null),j=K((e,t)=>!0===t.pull?[{...(0,V.Qo)(e,t.enableConflictResolution),desc:W(e,"pull")}]:null),Y=K((e,t)=>t.executeAs?[{...(0,V.cA)(e,t.executeAs),desc:W(e,"execute-as")}]:null),z=[$,Q,H,j,Y,K((e,t)=>t.newId?[{...(0,V.U9)(e,t.newId),desc:W(e,"rename-to")}]:null),K((e,t)=>t.newSchema&&t.newOwner?[{...(0,V.oh)(e,t.newSchema,t.newOwner),desc:W(e,"move-to")}]:null)];var q=n(609588),Z=n.n(q);let J=(e,t)=>{let n=[],o=[],r=[];return e.forEach(e=>{e.targetColNames?e.targetColNames.forEach(t=>{r.push({mappedColumns:e.mappedColumns,policy:e.policy,targetColName:t})}):r.push(e)}),t.forEach(e=>{e.targetColNames?e.targetColNames.forEach(t=>{o.push({mappedColumns:e.mappedColumns,policy:e.policy,targetColName:t})}):o.push(e)}),o.forEach(e=>{if(e.policy.domain===l.M.AGGREGATION_POLICY||e.policy.domain===l.M.ROW_ACCESS_POLICY){let t=r.find(t=>t.policy.domain===e.policy.domain);t&&n.push({toSet:t,toUnset:e})}else{let t=r.find(t=>t.policy.domain===e.policy.domain&&t.targetColName===e.targetColName);t&&n.push({toSet:t,toUnset:e})}}),{toRemove:o.filter(e=>!n.some(({toUnset:t})=>Z()(t,e))),toAdd:r.filter(e=>!n.some(({toSet:t})=>Z()(t,e))),toEdit:n}};function X(e,t){e.add("ACCOUNTS ="),t.forEach((t,n)=>{0!==n&&e.add(","),e.add("{}",(0,u.M)({type:l.M.ACCOUNT,name:t}))})}function ee(e,t,n){let o=new s.L("alter");c(o,e),o.add(n);let r=t.accounts||[];return delete t.accounts,X(o,r),o.toQuery()}function et(e){return i()(e).toUpperCase().replace("UTF_8","UTF8")}function en(e,t){var n;e.add("{} {}",(n=t.name,(0,y.yB)(n)?(0,I.M)(n):(0,I.M)((0,f.P)(n))),(0,g.j)(t.type));let o="STRING"===t.type||"VARCHAR"===t.type||"DATE"===t.type||"TIMESTAMP"===t.type?`'${t.default}'`:String(t.default);void 0!==t.default&&e.add("DEFAULT {}",(0,R.V)(o)),t.notNull&&e.add("NOT NULL"),t.comment&&e.add("COMMENT {}",(0,T.i)(t.comment))}let eo=["ALLOWED_AUTHENTICATION_SECRETS","STORAGE_INTEGRATION"];function er(e,t,n){if(t){let o=!1;for(let a of Object.keys(t)){let i=t[a],s=et(a);switch(typeof i){case"string":"FILE_FORMAT"===s?e.add("FILE_FORMAT = (TYPE = {})",(0,h.a)(i)):"DEFAULT_SECONDARY_ROLES"===s?(e.add("{} = (",(0,h.a)(s)),i&&e.add("{}",(0,T.i)(i)),e.add(")")):eo.includes(s)?e.add("{} = {}",(0,_.e)(s),(0,_.e)(i)):e.add("{} = {}",(0,h.a)(s),(0,T.i)(i));break;case"boolean":e.add("{} = {}",(0,h.a)(s),(0,S.S)(i));break;case"number":e.add("{} = {}",(0,h.a)(s),(0,m._)(i));break;case"object":if(r()(i))i.length>0?(e.add("{} = (",(0,h.a)(s)),i.forEach((t,n)=>{n>0&&e.add(","),e.add("{}",(0,T.i)(t))}),e.add(")")):n&&e.add("{} = ()",(0,h.a)(s));else if(null===i)e.add("{} = null",(0,h.a)(s));else switch(s){case"REPLICA_OF":e.add("AS REPLICA OF IDENTIFIER(?)",(0,u.M)({type:l.M.DATABASE,...i}));break;case"SCHEDULE":"mins"in i?e.add("{} = {}",(0,h.a)(s),(0,T.i)(`${i.mins} MINUTE`)):"expression"in i&&e.add("{} = {}",(0,h.a)(s),(0,T.i)(`USING CRON ${i.expression} ${i.timezone}`));break;case"LOCATION":e.add("{} = {}",(0,h.a)(s),(0,u.M)(i));break;case"FILE_FORMAT":e.add("{} = (FORMAT_NAME = {})",(0,h.a)(s),(0,u.M)(i));break;case"TRIGGERS":o=!0;break;case"METADATA":e.add("METADATA = '{}'",{inlineRepr:(0,E.H)(JSON.stringify(i))});break;default:e.add("{} = (",(0,h.a)(s)),er(e,i),e.add(")")}}}o&&ey(e,t.triggers)}}function ea(e){return(0,y.SD)(e)?e.toUpperCase():(0,y.r9)(e)?(0,C.b)(e):e}function ei(e){return{...e,name:ea(e.name)}}let el=[{keyword:"secure",renderer:e=>{e.add("secure")}},{keyword:"replace",renderer:e=>{e.add("or replace")}}],es=[{keyword:"existsConditional",renderer:(e,t)=>{"ifNotExists"===t&&e.add("if not exists")}}],eu=[{keyword:"columns",renderer:function(e,t){e.add("("),function(e,t,n){for(let o=0;o<t.length;o++)o>0&&e.add(","),n(e,t[o])}(e,t,en),e.add(")")}},{keyword:"sourceTable",renderer:function(e,t){e.add("on"),e.addFullyQualifiedIdentifier(t)}},{keyword:"returns",renderer:(e,t)=>{e.add("returns {}",(0,_.e)(t))}},{keyword:"withManagedAccess",renderer:e=>{e.add("WITH MANAGED ACCESS")}},{keyword:"language",renderer:(e,t)=>{e.add("language {}",(0,_.e)(t))}},{keyword:"from",renderer:(e,t)=>{e.add("FROM"),"string"==typeof t?e.add("{}",(0,T.i)(t)):e.addFullyQualifiedIdentifier(t)}}],ed=[{keyword:"definition",renderer:function(e,t,n){e.add("as"),n.type===l.M.FUNCTION||n.type===l.M.PROCEDURE?e.add("{}",(0,T.i)(t)):e.add("{}",(0,I.M)(t))}}];function ec(e,t,n,o){for(let r of t){let t=n[r.keyword];void 0!==t&&(r.renderer(e,t,o),delete n[r.keyword])}}function eE(e,t){if(e.type===l.M.ORG_EMAIL)return ev(l.M.ORG_EMAIL,"CREATE",t);if(e.type===l.M.BUDGET_BUNDLE)return(0,G.cQ)(e);if(e.type===l.M.APPLICATION){let n=t;return n.from.type===l.M.APPLICATION_PACKAGE?function(e,t){let n=t.from.name,o=t.version,r=t.patch,a=new s.L().add("create {} IDENTIFIER(?) from APPLICATION PACKAGE IDENTIFIER(?)",(0,d.T)(e.type),(0,u.M)(e),(0,u.M)({name:n,type:l.M.APPLICATION_PACKAGE}));return t.from.type===l.M.APPLICATION_PACKAGE&&o&&void 0!==r&&a.add("USING VERSION {} PATCH {}",(0,N.t)(o),(0,m._)(r)),a.toQuery()}(e,n):function(e,t){let n=t.from?t.from.name:"",o=t.using?t.using.name:"",r=t.with?t.with.name:"",a=t.with?t.with.database:"",i=t.with?t.with.schema:"",c=t.trial,E=t.autoRenew,f=t.preferMCD,p=t.paymentMethodId,S=t.purchaseOrderId,g=t.isBackgroundInstall,_=t.isEventSharingAuthorization,h=t.offer,m=new s.L().add("create {} IDENTIFIER(?)",(0,d.T)(e.type),(0,u.M)(e)).add("from LISTING {}",(0,T.i)(n));return o&&m.add("using RELEASE CHANNEL {}",(0,R.V)(o)),g&&m.add("BACKGROUND_INSTALL = true"),_&&m.add("AUTHORIZE_TELEMETRY_EVENT_SHARING = true"),r&&m.add("with FEATURE POLICY {}",(0,u.M)({name:r,database:a,schema:i,type:l.M.FEATURE_POLICY})),er(m,{trial:c,autoRenew:E,preferMCD:f,paymentMethodId:p,purchaseOrderId:S,offer:h}),m.toQuery()}(e,n)}if(e.type===l.M.PROVIDER_LISTING)return k(e,t);t={...t};let n=new s.L("create");ec(n,el,t,e);let o=[];for(let e of es){let n=t[e.keyword];void 0!==n&&(o.push({keyword:e.keyword,renderer:t=>e.renderer(t,n)}),delete t[e.keyword])}n.addFullyQualifiedIdentifier(e,o),ec(n,eu,t,e);let r={...t};for(let e of ed)delete r[e.keyword];return er(n,r),ec(n,ed,t,e),n.toQuery()}function ef(e,t,n){let o=new s.L("CREATE");return o.add("{}",(0,d.T)(e.type)),o.add("IDENTIFIER(?)",(0,u.M)(t)),o.add("CLONE"),o.add("IDENTIFIER(?)",(0,u.M)(e)),n.comment&&o.add("COMMENT = {}",(0,T.i)(n.comment)),o.toQuery()}function ep(e,t){if(e.type===l.M.PROVIDER_LISTING)return w(e);if(e.type===l.M.ML_MODEL_VERSION){let t={name:e.module,database:e.database,schema:e.schema,type:l.M.ML_MODEL};return new s.L().add("ALTER MODEL IDENTIFIER(?) DROP VERSION {}",(0,u.M)(t),{bindingsJSONRepr:e.name,inlineRepr:e.name}).toQuery()}let n=new s.L("drop");return e.type===l.M.BUDGET_BUNDLE?n.add("instance IDENTIFIER(?)",(0,u.M)(e)):n.addFullyQualifiedIdentifier(e),(null==t?void 0:t.cascade)&&e.type===l.M.APPLICATION&&n.add("CASCADE"),e.type===l.M.ACCOUNT&&(null==t?void 0:t.gracePeriodInDays)&&n.add("grace_period_in_days="+t.gracePeriodInDays),n.toQuery()}function eS(e,{emailType:t,oldEmail:n,newEmail:o},r){let[a,i]=function(...e){return e.map(e=>Array.isArray(e)?e:[e])}(n,o),l=a.filter(e=>!i.includes(e)),s=i.filter(e=>!a.includes(e));return{alters:[...l.map((n,o)=>({...ev(e,"DROP",{email:n,emailType:t}),desc:`${r}-drop${0===o?"":"-"+(o+1)}`})),...s.map((n,o)=>({...ev(e,"CREATE",{email:n,emailType:t}),desc:`${r}-create${0===o?"":"-"+(o+1)}`}))],newName:""}}function eg(e,t){let n,o=`alter-${e.type.toLowerCase()}`;if(e.type===l.M.ORG_EMAIL)return eS(l.M.ORG_EMAIL,t,o);if(e.type===l.M.ACCOUNT_EMAIL)return eS(l.M.ACCOUNT_EMAIL,t,o);if(e.type===l.M.SHARE){if(t.useAdd){let n=[];return n.push({...ee(e,t,"add"),desc:`${o}-add-accounts`}),{alters:n,newName:""}}else if(t.useRemove){let n=[];return n.push({...ee(e,t,"remove"),desc:`${o}-remove-accounts`}),{alters:n,newName:""}}}if(e.type===l.M.CONSUMER_LISTING&&t.unpublishByAdmin)return{alters:[{...new s.L().add("call system$unpublish_data_exchange_listing_by_admin(?, ?, ?)",(0,T.i)(e.exchangeId),(0,T.i)(e.name),(0,T.i)(t.reason)).toQuery(),desc:`${o}-unpublish-listing-by-admin`}],newName:""};if(e.type===l.M.LISTING&&t.appPackage)return{alters:[{...new s.L().add("call SYSTEM$SETUP_LISTING_WITH_APPLICATION_PACKAGE(?, ?)",(0,u.M)(e),(0,u.M)({name:t.appPackage,type:l.M.APPLICATION_PACKAGE})).toQuery(),desc:`${o}-setup-listing-with-app-package`}],newName:""};if(e.type===l.M.BUDGET_BUNDLE){let n,r=[],a="";if(t.budgetId){let r=t.budgetId;a=ea(r.name),n={...(0,G.Wh)(e,r),desc:`${o}-rename`}}if(t.spendingLimit&&r.push({...(0,G._w)(e,t.spendingLimit),desc:`${o}-set-spending-limit`}),t.emailNotification){let n=t.emailNotification;r.push({...(0,G.FX)(e,n.recipient),desc:`${o}-set-email-notification-without-integration`})}return t.activate&&r.push({...(0,G.qz)(e),desc:`${o}-activate-account-budget`}),t.deactivate&&r.push({...(0,G.wS)(e),desc:`${o}-deactivate-account-budget`}),t.addResources&&t.addResources.length>0&&t.addResources.forEach(t=>r.push({...(0,G.Pl)(e,t),desc:`${o}-add-resource-to-budget`})),t.removeResources&&t.removeResources.length>0&&t.removeResources.forEach(t=>r.push({...(0,G.yu)(e,t),desc:`${o}-remove-resource-from-budget`})),n&&r.push(n),{alters:r,newName:a}}if(e.type===l.M.APPLICATION_PACKAGE&&t.alterType)return b({alterProps:t,id:e,descPrefix:o});if(e.type===l.M.PROVIDER_LISTING&&t.alterType)return B({alterProps:t,id:e,descPrefix:o});if(e.type===l.M.APPLICATION&&t.reference)return{alters:(0,O.g)(t,e),newName:""};if(e.type===l.M.ACCOUNT&&t.name){let n=ea(t.name),r=[];return r.push({...function(e,t,n){let o=new s.L("alter");return c(o,e),o.add("rename to IDENTIFIER(?)",(0,u.M)({...e,name:t})),void 0!==n&&o.add("save_old_url = "+n),o.toQuery()}(e,n,t.saveOldUrl),desc:`${o}-rename`}),{alters:r,newName:n}}if(e.type===l.M.NOTEBOOK||e.type===l.M.STREAMLIT){let n=function(e,t){for(let n of z){let o=n(e,t);if(o)return o}return null}(e,t);if(n)return{alters:n,newName:""}}let r=[],a={},i=!1,d=[],E="";for(let f in t){let S=t[f];if("name"===f)S&&ea(S)!==e.name&&(n={...eR(e,E=ea(S)),desc:`${o}-rename`});else if("networkPolicy"===f&&e.type===l.M.ACCOUNT)r.push({...function(e,t){let n=new s.L("alter");return c(n,e),"activate"===t.action?n.add("set NETWORK_POLICY = {}",(0,T.i)(t.name)):n.add("unset NETWORK_POLICY"),n.toQuery()}(e,S),desc:`${o}-${S.action}-${S.name.replace(" ","-")}`});else if("action"===f)r.push({...eC(e,S),desc:`${o}-${S.replace(" ","-")}`});else if("secure"===f&&e.type===l.M.FUNCTION){let t=S?"set":"unset";r.push({...eC(e,`${t} secure`),desc:`${o}-${t}-secure`})}else if("enableReplication"===f&&e.type===l.M.DATABASE)r.push({...eN(e,S,"enable replication"),desc:`${o}-enable-replication`});else if("disableReplication"===f&&e.type===l.M.DATABASE)r.push({...eN(e,S,"disable replication"),desc:`${o}-disable-replication`});else if("enableFailover"===f&&e.type===l.M.DATABASE)r.push({...eN(e,S,"enable failover"),desc:`${o}-enable-failover`});else if("disableFailover"===f&&e.type===l.M.DATABASE)r.push({...eN(e,S,"disable failover"),desc:`${o}-disable-failover`});else if("policy"===f){let t,{toSet:n,toUnset:a,targetColumnName:i,entityColumns:s}=S,u=n?n.policy.domain:a.domain,d=u===l.M.ROW_ACCESS_POLICY,c=u===l.M.MASKING_POLICY,E=u===l.M.PROJECTION_POLICY,f=u===l.M.AGGREGATION_POLICY,p=u===l.M.PRIVACY_POLICY;d?eO({id:e,actions:r,toSet:n,toUnset:a,targetColumnName:i,descPrefix:o}):p?(n&&a?t=`${o}-drop-and-add-privacy-policy`:n?t=`${o}-add-privacy-policy`:a&&(t=`${o}-drop-privacy-policy`),r.push({...em({id:e,addParams:n,dropParams:a}),desc:t})):c?n&&a?r.push({...em({id:e,addParams:n,dropParams:a,targetColumnName:i}),desc:`${o}-set-masking-policy-force`}):n?r.push({...em({id:e,addParams:n,targetColumnName:i}),desc:`${o}-set-masking-policy`}):a&&r.push({...em({id:e,dropParams:a,targetColumnName:i}),desc:`${o}-unset-masking-policy`}):E?n&&a?r.push({...em({id:e,addParams:n,dropParams:a,targetColumnName:i}),desc:`${o}-set-projection-policy-force`}):n?r.push({...em({id:e,addParams:n,targetColumnName:i}),desc:`${o}-set-projection-policy`}):a&&r.push({...em({id:e,dropParams:a,targetColumnName:i}),desc:`${o}-unset-projection-policy`}):f&&eL({id:e,actions:r,toSet:n,toUnset:a,entityColumns:s,descPrefix:o})}else if("policies"===f){let{rowAccessPolicy:t,aggregationPolicy:n,projectionPolicies:a}=S;if(t){let{toSet:n,toUnset:a,targetColumnName:i}=t;eO({id:e,actions:r,toSet:n,toUnset:a,targetColumnName:i,descPrefix:o})}if(n){let{toSet:t,toUnset:a}=n;eL({id:e,actions:r,toSet:t,toUnset:a,entityColumns:null==t?void 0:t.entityColumns,descPrefix:o})}if(a){let{toSet:t,toUnset:n}=a;!function({id:e,actions:t,toSet:n,toUnset:o,descPrefix:r}){let{toAdd:a,toRemove:i,toEdit:l}=J(null!=n?n:[],null!=o?o:[]);a.forEach(n=>{t.push({...em({id:e,addParams:n,targetColumnName:n.targetColName}),desc:`${r}-set-projection-policy`})}),i.forEach(n=>{t.push({...em({id:e,dropParams:n.policy,targetColumnName:n.targetColName}),desc:`${r}-unset-projection-policy`})}),l.forEach(n=>{t.push({...em({id:e,addParams:n.toSet,dropParams:n.toUnset.policy,targetColumnName:n.toSet.targetColName}),desc:`${r}-set-projection-policy-force`})})}({id:e,actions:r,toSet:t,toUnset:n,descPrefix:o})}}else if("tags"===f)(null==S?void 0:S.length)>0&&r.push({...function(e,t){let n=new s.L("alter");return eA(e,n),t[0].targetColumnName&&eb(n,t[0].targetColumnName),n.add("set TAG"),t.forEach((e,t)=>{t>0&&n.add(",");let o={name:e.name,database:e.database,schema:e.schema,type:l.M.TAG};n.add("IDENTIFIER(?) = {}",(0,u.M)(o),(0,T.i)(e.value))}),n.toQuery()}(e,S),desc:`${o}-set`});else if("tagsToUnset"===f)(null==S?void 0:S.length)>0&&r.push({...function(e,t){let n=new s.L("alter");return eA(e,n),t[0].targetColumnName&&eb(n,t[0].targetColumnName),n.add("unset TAG"),t.forEach((e,t,o)=>{let r={type:l.M.TAG,name:e.name,database:e.database,schema:e.schema};t<o.length-1?n.add("IDENTIFIER(?),",(0,u.M)(r)):n.add("IDENTIFIER(?)",(0,u.M)(r))}),n.toQuery()}(e,S),desc:`${o}-unset`});else if("columnToDrop"===f)r.push({...function(e,t){let n=new s.L("alter");eA(e,n),n.add("drop COLUMN");let o={type:l.M.SCHEMA,name:t};return n.add("{}",(0,u.M)(o)),n.toQuery()}(e,S),desc:`${o}-drop-column`});else if((e.type===l.M.TABLE||e.type===l.M.VIEW||e.type===l.M.DYNAMIC_TABLE||e.type===l.M.ICEBERG_TABLE||e.type===l.M.EXTERNAL_TABLE)&&"columnComment"===f){let{column:t,comment:n}=S;r.push({...function(e,t,n){let o=new s.L("ALTER");return c(o,e),o.add(`ALTER COLUMN ${(0,p.v)(t)}`),n?o.add("COMMENT {}",(0,T.i)(n)):o.add("UNSET COMMENT"),o.toQuery()}(e,t,n),desc:`${o}-column-comment`})}else{let t=e.type===l.M.WAREHOUSE&&"autoSuspend"===f;null!==S||e.type===l.M.RESOURCE_MONITOR||t?(a[f]=S,i=!0):d.push(f)}}let f=[];return r.length>0&&f.push(...r),i&&f.push({...eh(e,a),desc:`${o}-set`}),d.length>0&&f.push({...eT(e,d),desc:`${o}-unset`}),n&&f.push(n),{alters:f,newName:E}}let e_=[l.M.NETWORK_POLICY,l.M.NOTEBOOK,l.M.STREAMLIT];function eh(e,t){let n=new s.L("alter");c(n,e);let o=Object.keys(t);if(e.type===l.M.RESOURCE_MONITOR&&1===o.length&&"triggers"===o[0])ey(n,t.triggers);else if(e.type===l.M.SHARE&&void 0!==t.accounts&&null!==t.accounts){n.add("set");let e=t.accounts;delete t.accounts,X(n,e),er(n,t)}else n.add("set"),er(n,t,e_.includes(e.type));return n.toQuery()}function em({id:e,addParams:t,dropParams:n,targetColumnName:o,entityColumns:r}){let a=new s.L("alter");eA(e,a);let i=null==t?void 0:t.policy.domain;return o&&eb(a,o),n&&t&&i!==l.M.ROW_ACCESS_POLICY&&i!==l.M.PRIVACY_POLICY?eI(a,t,o,r,!0):(n&&function(e,t){let{domain:n,name:o,schema:r,database:a}=t;n===l.M.MASKING_POLICY?e.add("unset masking policy"):n===l.M.ROW_ACCESS_POLICY?(e.add("drop row access policy"),e.add("IDENTIFIER(?)",(0,u.M)({type:n,name:o,schema:r,database:a}))):n===l.M.PRIVACY_POLICY?(e.add("drop privacy policy"),e.add("IDENTIFIER(?)",(0,u.M)({type:n,name:o,schema:r,database:a}))):n===l.M.AGGREGATION_POLICY?e.add("unset aggregation policy"):n===l.M.PROJECTION_POLICY&&e.add("unset projection policy")}(a,n),n&&t&&a.add(","),t&&eI(a,t,o,r)),a.toQuery()}function eI(e,t,n,o,r){let{policy:a,mappedColumns:i}=t,{domain:s,name:d,schema:c,database:E}=a,f={type:s,name:d,schema:c,database:E};s===l.M.MASKING_POLICY&&n&&i?(e.add("set masking policy"),e.add("IDENTIFIER(?)",(0,u.M)(f)),i.length>1&&(e.add("using ("),i.forEach((t,o,r)=>{0===o?e.add("{}",(0,u.M)({type:l.M.SCHEMA,name:n})):e.add("{}",(0,u.M)({type:l.M.SCHEMA,name:t.mappedColName})),o<r.length-1&&e.add(",")}),e.add(")")),r&&e.add("force")):s===l.M.ROW_ACCESS_POLICY&&!n&&i?(e.add("add row access policy"),e.add("IDENTIFIER(?)",(0,u.M)(f)),e.add("on ("),i.forEach((t,n,o)=>{let r={type:l.M.SCHEMA,name:t.mappedColName};e.add("{}",(0,u.M)(r)),n<o.length-1&&e.add(",")}),e.add(")")):s===l.M.AGGREGATION_POLICY?(e.add("set aggregation policy"),e.add("IDENTIFIER(?)",(0,u.M)(f)),(null==o?void 0:o.length)&&(e.add("ENTITY KEY ("),o.forEach((t,n)=>{e.add("{}",(0,u.M)({type:l.M.SCHEMA,name:t})),n<o.length-1&&e.add(",")}),e.add(")")),r&&e.add("force")):s===l.M.PROJECTION_POLICY&&n?(e.add("set projection policy"),e.add("IDENTIFIER(?)",(0,u.M)(f)),r&&e.add("force")):s===l.M.PRIVACY_POLICY&&(e.add("add privacy policy"),e.add("IDENTIFIER(?)",(0,u.M)(f)))}function eT(e,t){let n=new s.L("alter");n.addFullyQualifiedIdentifier(e),n.add("unset");for(let e=0;e<t.length;e++){let o=et(t[e]);e<t.length-1?n.add("{},",(0,h.a)(o)):n.add("{}",(0,h.a)(o))}return n.toQuery()}function eR(e,t){let n=new s.L("alter");return c(n,e),n.add("rename to IDENTIFIER(?)",(0,u.M)({...e,name:t})),n.toQuery()}function eC(e,t){let n=new s.L("alter");return n.addFullyQualifiedIdentifier(e),n.add("{}",(0,h.a)(t)),n.toQuery()}function ey(e,t){let{suspend:n,suspendImmediately:o,notify:r}=t;for(let t of((n||o||r)&&e.add("TRIGGERS"),n&&e.add("ON {} PERCENT DO SUSPEND",(0,m._)(n)),o&&e.add("ON {} PERCENT DO SUSPEND_IMMEDIATE",(0,m._)(o)),r))t&&e.add("ON {} PERCENT DO NOTIFY",(0,m._)(t))}function ev(e,t,n){let o=new s.L,r="";return e===l.M.ACCOUNT_EMAIL?"CREATE"===t?r="call system$ADD_EMAIL_STORAGE_FOR_ACCOUNT({}, {})":"DROP"===t&&(r="call system$DELETE_EMAIL_STORAGE_FOR_ACCOUNT({}, {})"):e===l.M.ORG_EMAIL&&("CREATE"===t?r="call system$ADD_EMAIL_STORAGE_FOR_ORGANIZATION({}, {})":"DROP"===t&&(r="call system$DELETE_EMAIL_STORAGE_FOR_ORGANIZATION({}, {})")),o.add(r,(0,T.i)(n.emailType),(0,T.i)(n.email)),o.toQuery()}function eN(e,t,n){let o=new s.L("alter");return c(o,e),o.add(`${n} to accounts`),t.forEach((e,t)=>{0!==t&&o.add(","),o.add("IDENTIFIER(?)",(0,u.M)(e))}),o.toQuery()}function eA(e,t){e.type===l.M.EXTERNAL_TABLE?t.add("{} IDENTIFIER(?)",(0,d.T)(l.M.TABLE),(0,u.M)(e)):e.type===l.M.MATERIALIZED_VIEW?t.add("{} IDENTIFIER(?)",(0,d.T)(l.M.VIEW),(0,u.M)(e)):t.addFullyQualifiedIdentifier(e)}function eb(e,t){let n={type:l.M.SCHEMA,name:t};e.add("modify COLUMN"),e.add("{}",(0,u.M)(n))}function eO({id:e,actions:t,toSet:n,toUnset:o,targetColumnName:r,descPrefix:a}){let i="";n&&o?i=`${a}-drop-and-add-row-access-policy`:n?i=`${a}-add-row-access-policy`:o&&(i=`${a}-drop-row-access-policy`),t.push({...em({id:e,addParams:n,dropParams:o,targetColumnName:r}),desc:i})}function eL({id:e,actions:t,toSet:n,toUnset:o,entityColumns:r,descPrefix:a}){let i="";n&&o?t.push({...em({id:e,addParams:n,dropParams:o,entityColumns:r}),desc:`${a}-set-aggregation-policy-force`}):n?(i=`${a}-set-aggregation-policy`,t.push({...em({id:e,addParams:n,entityColumns:r}),desc:i})):o&&(i=`${a}-unset-aggregation-policy`,t.push({...em({id:e,dropParams:o}),desc:i}))}},289661:function(e,t,n){n.d(t,{J:()=>a});var o=n(812199);let r=e=>{try{let t=JSON.parse(e);return"string"==typeof t}catch(e){return!0}},a=e=>{let t=e.filter(e=>!(0,o.U)(e));return 0===t.length?"":JSON.stringify(t.reduce((e,t)=>({...e,[t.key]:r(t.value)?t.value:JSON.parse(t.value)}),{}))}},721208:function(e,t,n){n.d(t,{F:()=>a});var o=n(867668),r=n(411733);function a(e){try{return(0,o.jsonParseDoubleDollarSafe)(e)}catch(e){return r.cM.error(Error(`error running jsonParseDoubleDollarSafe ${e}`)),{}}}},812199:function(e,t,n){n.d(t,{U:()=>o});let o=e=>""===e.key&&""===e.value},886608:function(e,t,n){n.d(t,{n:()=>d,y:()=>u});var o=n(889692),r=n.n(o),a=n(875934),i=n.n(a),l=n(586575),s=n(721208);function u(e){return(0,l.l)(e,r())}let d=e=>{let t=(0,s.F)(null!=e?e:"{}");return i()(t)?void 0:u(t)}},96445:function(e,t,n){n.d(t,{cQ:()=>g,Iq:()=>A,qz:()=>T,i4:()=>f,YY:()=>E,sq:()=>v,S6:()=>m,wS:()=>R,zZ:()=>y,yu:()=>O,SN:()=>S,FX:()=>h,ll:()=>I,Wh:()=>C,X7:()=>N,ny:()=>L,_w:()=>_,cC:()=>p,Pl:()=>b});var o=n(420174),r=n(571947),a=n(360715),i=n(123246),l=n(329322),s=n(159771),u=n(144237),d=n(36534);let c=e=>{var t;let n=(null==e||null==(t=e.database)?void 0:t.replace("/","."))||"",[o="",r=""]=e.name.split("/");return{tagName:[...n&&[n],o].join("."),tagValue:r}};function E(e){return new l.L().add("CALL {}!GET_SPENDING_LIMIT();",(0,s.M)(e)).toQuery()}function f(e){return new l.L().add("CALL {}!GET_NOTIFICATION_INTEGRATION_NAME();",(0,s.M)(e)).toQuery()}function p(e){return new l.L().add("CALL {}!GET_NOTIFICATION_EMAIL();",(0,s.M)(e)).toQuery()}function S(e,t){let{lowerBound:n,upperBound:o}=t;return new l.L().add("CALL {}!get_spending_history({}, {})",(0,s.M)(e),(0,d.i)(n),(0,d.i)(o)).toQuery()}function g(e){return new l.L().add("CREATE SNOWFLAKE.CORE.BUDGET {}();",(0,s.M)(e)).toQuery()}function _(e,t){return new l.L().add("CALL {}!SET_SPENDING_LIMIT({});",(0,s.M)(e),(0,u._)(t)).toQuery()}function h(e,t){return new l.L().add("CALL {}!SET_EMAIL_NOTIFICATIONS({});",(0,s.M)(e),(0,d.i)(t)).toQuery()}function m(){return new l.L("CALL SYSTEM$SHOW_BUDGETS_IN_ACCOUNT();").toQuery()}function I(){return new l.L("CALL SYSTEM$SHOW_BUDGET_DETAILS_IN_ACCOUNT();").toQuery()}function T(e){return new l.L().add("CALL {}!ACTIVATE();",(0,s.M)(e)).toQuery()}function R(e){return new l.L().add("CALL {}!DEACTIVATE();",(0,s.M)(e)).toQuery()}function C(e,t){return new l.L("ALTER SNOWFLAKE.CORE.BUDGET {} RENAME TO {};",(0,s.M)(e),(0,s.M)(t)).toQuery()}let y=e=>{let{inclusiveDateRange:t,timezone:n,serviceType:o,budgetId:u}=e,{lowerBound:c,upperBound:E}=(0,i.A)(t),f=(0,a.f)(t);return new l.L().add("CALL {}!GET_SERVICE_TYPE_USAGE({}, {}, {}, {}, {});",(0,s.M)(u),(0,d.i)(o),(0,d.i)(f),(0,d.i)(n||"UTC"),(0,d.i)((0,r.c)(c)),(0,d.i)((0,r.c)(E))).toQuery()},v=e=>new l.L().add("CALL {}!get_linked_resources();",(0,s.M)(e)).toQuery(),N=e=>new l.L().add("CALL {}!get_linked_tags();",(0,s.M)(e)).toQuery(),A=e=>new l.L().add("CALL {}!get_activation_date();",(0,s.M)(e)).toQuery(),b=(e,t)=>{if(t.type===o.M.TAG){let{tagName:n,tagValue:o}=c(t);return new l.L().add("CALL {}!ADD_TAG((SELECT SYSTEM$REFERENCE('TAG', {}, 'SESSION', 'APPLYBUDGET')), {});",(0,s.M)(e),(0,d.i)(n),(0,d.i)(o)).toQuery()}let n=t.type===o.M.APPLICATION?o.M.DATABASE:t.type;return new l.L().add("CALL {}!ADD_RESOURCE(SELECT SYSTEM$REFERENCE({}, '{}', 'SESSION', 'APPLYBUDGET'));",(0,s.M)(e),(0,d.i)(n),(0,s.M)(t)).toQuery()},O=(e,t)=>{if(t.type===o.M.TAG){let{tagName:n,tagValue:o}=c(t);return new l.L().add("CALL {}!REMOVE_TAG((SELECT SYSTEM$REFERENCE('TAG', {}, 'SESSION', 'APPLYBUDGET')), {});",(0,s.M)(e),(0,d.i)(n),(0,d.i)(o)).toQuery()}let n=t.type===o.M.APPLICATION?o.M.DATABASE:t.type;return new l.L().add("CALL {}!REMOVE_RESOURCE(SELECT SYSTEM$REFERENCE({}, '{}', 'SESSION', 'APPLYBUDGET'));",(0,s.M)(e),(0,d.i)(n),(0,s.M)(t)).toQuery()};function L(e){return new l.L().add("CALL {}!GET_CONFIG();",(0,s.M)(e)).toQuery()}},523930:function(e,t,n){n.d(t,{BW:()=>f,CG:()=>p,DS:()=>h,Hb:()=>m,M0:()=>S,Qo:()=>R,Rf:()=>C,Tp:()=>I,U9:()=>N,V1:()=>g,YK:()=>y,cA:()=>v,fd:()=>T,iv:()=>_,oh:()=>A});var o=n(420174),r=n(329322),a=n(620400),i=n(159771),l=n(144237),s=n(370264),u=n(345950),d=n(36534),c=n(113939),E=n(289661);function f(e){return new r.L().add("ALTER {} {} CHECKOUT;",(0,s.T)(e.type),(0,i.M)(e)).toQuery()}function p(e){return new r.L().add("SHOW CHECKOUTS IN {} {};",(0,s.T)(e.type),(0,i.M)(e)).toQuery()}function S(e){return new r.L().add("CALL SYSTEM$SHOW_WAREHOUSES_FOR_FILE_BASED_ENTITY({});",(0,d.i)(e)).toQuery()}function g(e){return new r.L().add("CALL SYSTEM$SHOW_SCHEMAS_IN_ACCOUNT_WITH_CREATE_FILE_BASED_ENTITY({});",(0,d.i)(e)).toQuery()}function _(e){return e.params?function({entityId:e,scheduleName:t,scheduleCronExpression:n,scheduleTimezone:a,warehouse:l,params:s}){return new r.L(`CREATE TASK IDENTIFIER(?) WAREHOUSE={} SCHEDULE={} CONFIG=$$${(0,E.J)([{id:0,key:"params",value:null!=s?s:""}])}$$ AS BEGIN LET PARAMS STRING := SYSTEM$GET_TASK_GRAPH_CONFIG('params')::string; EXECUTE {} {}(:PARAMS); END;`,(0,i.M)({type:o.M.TASK,name:t,database:e.database,schema:e.schema}),(0,d.i)(l),(0,d.i)(`USING CRON ${n} ${null!=a?a:"UTC"}`),(0,c.V)(e.type),(0,i.M)(e)).toQuery()}(e):function({entityId:e,scheduleName:t,scheduleCronExpression:n,scheduleTimezone:a,warehouse:l}){return new r.L("CREATE TASK IDENTIFIER(?) WAREHOUSE={} SCHEDULE={} AS EXECUTE {} {}();",(0,i.M)({type:o.M.TASK,name:t,database:e.database,schema:e.schema}),(0,d.i)(l),(0,d.i)(`USING CRON ${n} ${null!=a?a:"UTC"}`),(0,c.V)(e.type),(0,i.M)(e)).toQuery()}(e)}function h(e){return new r.L().add("ALTER TASK IDENTIFIER(?) RESUME",(0,i.M)(e)).toQuery()}function m(e,{from:t,live:n,versionAlias:o}){let a=new r.L("ALTER {} {} ADD",(0,s.T)(e.type),(0,i.M)(e));return n&&a.add("LIVE"),a.add("VERSION"),o&&!1===/^live$/iu.test(o)&&a.add("{}",(0,d.i)(o)),a.add("FROM {}",null==t||"last"===t?(0,c.V)("LAST"):(0,u.F)(t.gitRepository,t.path)).toQuery()}function I(e){return new r.L("ALTER {} {} COMMIT;",(0,s.T)(e.type),(0,i.M)(e)).toQuery()}function T(e,{username:t,password:n,name:o,email:a,comment:l,secret:c,to:E}){let f=new r.L("ALTER {} {} PUSH",(0,s.T)(e.type),(0,i.M)(e));return E&&f.add("TO {}",(0,u.F)(E.gitRepository,E.path)),c&&f.add("GIT_CREDENTIALS={}",(0,i.M)(c)),t&&f.add("USERNAME={}",(0,d.i)(t)),n&&f.add("PASSWORD={}",(0,d.i)(n)),o&&f.add("NAME={}",(0,d.i)(o)),a&&f.add("EMAIL={}",(0,d.i)(a)),l&&f.add("COMMENT={}",(0,d.i)(l)),f.toQuery()}function R(e,t=!1){let n=new r.L("ALTER {} {} PULL",(0,s.T)(e.type),(0,i.M)(e));return t&&n.add("ENABLE_MANUAL_CONFLICT_RESOLUTION=true"),n.toQuery()}function C({entityId:e,maxRuns:t}){return new r.L().add("CALL SYSTEM$LIST_FILE_BASED_ENTITY_EXECUTIONS({}, {}, {});",(0,d.i)(e.type),(0,d.i)((0,a.m)(e)),(0,l._)(t)).toQuery()}function y({entityId:e,queryId:t}){return new r.L().add("CALL SYSTEM$GET_FILE_BASED_ENTITY_EXECUTION({}, {}, {});",(0,d.i)(e.type),(0,d.i)((0,a.m)(e)),(0,d.i)(t)).toQuery()}function v(e,t){return new r.L(`ALTER {} IDENTIFIER(?) EXECUTE AS ${t}`,(0,s.T)(e.type),(0,i.M)(e)).toQuery()}function N(e,t){return new r.L("ALTER {} IDENTIFIER(?) RENAME TO IDENTIFIER(?)",(0,s.T)(e.type),(0,i.M)(e),(0,i.M)(t)).toQuery()}function A(e,t,n){return new r.L("ALTER {} IDENTIFIER(?) MOVE TO SCHEMA IDENTIFIER(?) GRANT OWNERSHIP TO ROLE IDENTIFIER(?)",(0,s.T)(e.type),(0,i.M)(e),(0,i.M)(t),(0,d.i)(n)).toQuery()}},360688:function(e,t,n){n.d(t,{Y:()=>r});var o,r=((o={}).terse="terse",o.show="show",o.describe="describe",o.grants="grants",o.grants_to="grants_to",o.grants_of="grants_of",o.grantable_privileges="grantable_privileges",o.future_grants="future_grants",o.visible_grants="visible_grants",o.replication_information="replication_information",o.get_ddl="get_ddl",o.bootstrap="bootstrap",o.organization_account_info="organization_account_info",o.external_table="external_table",o.query_result="query_result",o.query_history="query_history",o.query_plan="query_plan",o.user_name="user_name",o.preview="preview",o.inbound_shares="inbound_shares",o.outbound_shares="outbound_shares",o.outbound_share_details="outbound_share_details",o.share_properties="share_properties",o.provider_data_dictionary_shared_object_list="provider_data_dictionary_shared_object_list",o.pwd_change_info="pwd_change_info",o.edition="edition",o.available_databases="available_databases",o.replication="replication",o.available_roles="available_roles",o.mfa="mfa",o.mfa_optin="mfa_optin",o.authorized_actions="authorized_actions",o.metrics="metrics",o.utilization="utilization",o.cluster_utilization="cluster_utilization",o.org_contract_balance="org_contract_balance",o.anaconda_terms="anaconda_terms",o.gov_marketplace_terms="gov_marketplace_terms",o.is_marketplace_terms_accepted="is_marketplace_terms_accepted",o.marketplace_terms="marketplace_terms",o.columns="columns",o.tag_references="tag_references",o.tag_references_internal="tag_references_internal",o.related_listings="related_listings",o.tag_references_all_columns="tag_references_all_columns",o.policy_references="policy_references",o.list_entities_bottomup_check="list_entities_bottomup_check",o.entity_detail="entity_detail",o.by_name_reference="by_name_reference",o.authorized_operations="authorized_operations",o.popularity_scores="popularity_scores",o.listing_popularity_scores="listing_popularity_scores",o.provider_popularity_scores="provider_popularity_scores",o.category_popularity_scores="category_popularity_scores",o.listing_category_mapping="listing_category_mapping",o.database_refresh_history="database_refresh_history",o.imported_databases="imported_databases",o.listing_database_replication_schedules="listing_database_replication_schedules",o.listings_all_private_exchanges="listing_all_private_exchanges",o.private_listings_all_public_exchanges="private_listings_all_public_exchanges",o.listing_target_accounts="listing_target_accounts",o.listing_data_dictionary_provider_featured_objects="listing_data_dictionary_provider_featured_objects",o.available_regions="available_regions",o.listing_data_dictionary_consumer_shared_object_list="listing_data_dictionary_consumer_shared_object_list",o.listing_data_dictionary_consumer_featured_objects="listing_data_dictionary_consumer_featured_objects",o.is_database_imported="is_database_imported",o.mcd_properties="mcd_properties",o.listing_replication_schedules="listing_replication_schedules",o.listing_fulfillment_status="listing_fulfillment_status",o.share_validation_for_fulfillment="share_validation_for_fulfillment",o.compatibility_checker_for_fulfillment="compatibility_checker_for_fulfillment",o.terms_acknowledged="terms_acknowledged",o.is_organization_feature_enabled="is_organization_feature_enabled",o.listing_data_dictionary_consumer_object_details="listing_data_dictionary_consumer_object_details",o.exchange_regions="exchange_regions",o.spending_limit="spending_limit",o.spending_history="spending_history",o.notification_integration="notification_integration",o.notification_email="notification_email",o.show_budgets_in_account="show_budgets_in_account",o.show_budget_details_in_account="show_budget_details_in_account",o.resource_usage="resource_usage",o.get_attached_resources="get_attached_resources",o.activation_date="activation_date",o.get_config="get_config",o.get_linked_tags="get_linked_tags",o.password_policy="password_policy",o.application_instances="application_instances",o.application_metadata="application_metadata",o.owned_objects="owned_objects",o.privileges="privileges",o.references="references",o.versions="versions",o.associated_listings="associated_listings",o.release_directives="release_directives",o.version_manifest="version_manifest",o.application_package_file="application_package_file",o.application_package_validation_for_fulfillment="application_package_validation_for_fulfillment",o.dcr_versions_info="dcr_versions_info",o.application_package_size="application_package_size",o.application_package_available_regions="application_package_available_regions",o.show_in_account="show_in_account",o.show_in_account_limit="show_in_account_limit",o.eligible_objects_for_file_based_entity="eligible_objects_for_file_based_entity",o.contact_references_on_object="contact_references_on_object",o.semantic_view_references="semantic_view_references",o)},362772:function(e,t,n){n.d(t,{p:()=>r});var o,r=((o={}).unloaded="unloaded",o.loading="loading",o.loaded="loaded",o.refreshing="refreshing",o.error="error",o)},523311:function(e,t,n){n.d(t,{Q:()=>r});var o,r=((o={}).EDIT_APP_PACKAGE="EDIT_APP_PACKAGE",o.RENAME_APP_PACKAGE="RENAME_APP_PACKAGE",o.ADD_VERSION="ADD_VERSION",o.ADD_PATCH_TO_VERSION="ADD_PATCH_TO_VERSION",o.DROP_VERSION="DROP_VERSION",o.SET_RELEASE_DIRECTIVE="SET_RELEASE_DIRECTIVE",o.SET_DEFAULT_RELEASE_DIRECTIVE="SET_DEFAULT_RELEASE_DIRECTIVE",o.UNSET_RELEASE_DIRECTIVE="UNSET_RELEASE_DIRECTIVE",o.MODIFY_RELEASE_DIRECTIVE="MODIFY_RELEASE_DIRECTIVE",o.REGISTER_VERSION="REGISTER_VERSION",o.DEREGISTER_VERSION="DEREGISTER_VERSION",o)},665988:function(e,t,n){n.d(t,{X:()=>r});var o,r=((o={}).list="list",o.byid="byid",o.forwardId="forwardid",o)},802417:function(e,t,n){n.d(t,{d:()=>r});var o,r=((o={}).EDIT="EDIT",o.PUBLISH="PUBLISH",o.UNPUBLISH="UNPUBLISH",o)},872083:function(e,t,n){n.d(t,{j:()=>r});var o=n(665988);function r(e){return(null==e?void 0:e.resultType)===o.X.byid}},91559:function(e,t,n){n.d(t,{D:()=>r});var o=n(362772);function r(e){return(null==e?void 0:e.loadState)===o.p.error&&void 0==e.result&&void 0==e.resultType}},514209:function(e,t,n){n.d(t,{g:()=>r});var o=n(665988);function r(e){return(null==e?void 0:e.resultType)===o.X.list}},940936:function(e,t,n){n.d(t,{M:()=>r});var o=n(362772);function r(e){return(null==e?void 0:e.loadState)===o.p.loading}},426384:function(e,t,n){n.d(t,{O:()=>o});function o(e){return!!(null==e?void 0:e.isRefreshing)}},793589:function(e,t,n){n.d(t,{l:()=>r});var o,r=((o={}).ADD="ADD",o.REMOVE="REMOVE",o.CLEAR="CLEAR",o)},646525:function(e,t,n){n.d(t,{G:()=>i,z:()=>a});var o,r,a=((o={}).START="START",o.STOP="STOP",o.RESTART="RESTART",o.RESET="RESET",o.PAUSE="PAUSE",o),i=((r={}).IDLE="IDLE",r.RETRYING="RETRYING",r.PAUSED="PAUSED",r)},556868:function(e,t,n){n.d(t,{i:()=>i});var o=n(411733),r=n(390691),a=n(646525);function i(e,t,n){let i,l=0,s=0,u=0,d=1,{maxRetries:c=20,exponent:E=1.5,interval:f=1,constantRetryTimeInSec:p,maxBackOffIntervalInSec:S=45,shouldPauseOnInactive:g=!0,enableBackOffOnPollingFailures:_=!1,maxPollingFailuresBeforeBackOff:h=5,enforceMaxRetryOnConsecutivePollFailures:m=!1}=n||{},I=null==n?void 0:n.customBackOffTimer,T=e,R=a.G.IDLE,C={[a.z.STOP]:[]},y=()=>"hidden"===document.visibilityState&&R===a.G.RETRYING?void M(a.z.PAUSE):"visible"===document.visibilityState&&R===a.G.PAUSED?void M(a.z.RESTART):void 0,v=()=>{g&&document.removeEventListener("visibilitychange",y,!1)},N=0,A=()=>{clearTimeout(l),d=1,l=0,s=0,N=0,i=void 0},b=()=>{let e=d>c&&!p||N>c&&m;C[a.z.STOP].forEach(t=>t(e,i))},O=e=>{let t=e;if(I){let t=Math.max(u,I(e,d,N,n));return u=0,t}!p||p&&N>=h?(t+=Number(Math.pow(f*E,_?N:d).toFixed(2)),t=Math.min(t,S)):t=p;let r=u>t?u:t;return u>0&&o.cM.info(`Retriable backoff set: ${r} ${new Date}`),u=0,r},L=async()=>{if(R===a.G.RETRYING){if((null==t?void 0:t.isUserIdle())&&g){o.cM.info("Retriable User idle. Skipping retry"),s||(s=O(s)),l=window.setTimeout(L,1e3*s);return}if(d>c&&!p)return o.cM.info("Retriable Max retries reached. Stopping retries"),w(a.G.IDLE);try{await T(),N=0,i=void 0}catch(e){o.cM.error(Error(`Retriable Async function execution failed with: ${e}`)),e instanceof r.M&&(u=e.retryAfterMs/1e3,o.cM.info(`Retriable Have Http429, setting "minBackoffTimeFrom429" to ${u} ${new Date}`)),N+=1,i=e}if(m&&N>c)return o.cM.info("Retriable Max retries reached. Stopping retries"),w(a.G.IDLE);R===a.G.RETRYING&&(d+=1,s=O(s),l=window.setTimeout(L,1e3*s))}},k={[a.G.IDLE]:{[a.G.RETRYING]:{action:[L,()=>{g&&document.addEventListener("visibilitychange",y,!1)}]}},[a.G.PAUSED]:{[a.G.IDLE]:{action:[b,A,v]},[a.G.RETRYING]:{action:L}},[a.G.RETRYING]:{[a.G.IDLE]:{action:[b,A,v]},[a.G.PAUSED]:{action:()=>clearTimeout(l)}}},w=e=>{if(k[R][e]){let t=k[R][e];R=e,t&&("function"==typeof t.action&&t.action(),Array.isArray(t.action)&&t.action.map(e=>e()))}},M=(e,t)=>{switch(e){case a.z.RESTART:w(a.G.IDLE),w(a.G.RETRYING);break;case a.z.STOP:w(a.G.IDLE);break;case a.z.START:w(a.G.RETRYING);break;case a.z.PAUSE:w(a.G.PAUSED);break;case a.z.RESET:{let e=R;w(a.G.IDLE);let{asyncFunction:n,retriableOptions:o}=t||{};n&&(T=n),o&&(c=o.maxRetries||c,E=o.exponent||E,f=o.interval||f,p=o.constantRetryTimeInSec||p,S=o.maxBackOffIntervalInSec||S,g=o.shouldPauseOnInactive||g,_=o.enableBackOffOnPollingFailures||_,h=o.maxPollingFailuresBeforeBackOff||h,m=o.enforceMaxRetryOnConsecutivePollFailures||m),w(e)}break;default:throw`Unrecognized event: ${e}`}};return{start:()=>M(a.z.START),stop:()=>M(a.z.STOP),restart:()=>M(a.z.RESTART),reset:e=>M(a.z.RESET,e),currentState:()=>R,onStop:e=>(C[a.z.STOP].includes(e)||C[a.z.STOP].push(e),()=>{let t=C[a.z.STOP].indexOf(e);-1!==t&&C[a.z.STOP].splice(t,1)})}}},686762:function(e,t,n){n.d(t,{IG:()=>f,cf:()=>E,cs:()=>S});var o,r=n(286204),a=n(24149),i=n(70734),l=n(242291),s=n(293572),u=n(586938),d=n(90373),c=n(847345),E=((o={}).WEB_SOCKET_LOGGING="WEB_SOCKET_LOGGING",o.NOTEBOOK_EDIT_LOCK_CHECK="NOTEBOOK_EDIT_LOCK_CHECK",o.NOTEBOOK_EDIT_STATUS_SHORT_POLL="NOTEBOOK_EDIT_STATUS_SHORT_POLL",o);function f(e){return"true"===localStorage.getItem(p(e))}function p(e){return`debug:${e}`}function S({onHide:e}){let t=(0,c.useRef)(null),[n,o]=(0,a._)(p("WEB_SOCKET_LOGGING"),!1),[E,f]=(0,a._)(p("NOTEBOOK_EDIT_LOCK_CHECK"),!1),[S,g]=(0,a._)(p("NOTEBOOK_EDIT_STATUS_SHORT_POLL"),!1);return(0,r.jsxs)(i.Vq,{manuallyShown:!0,causalElement:t,onHide:e,children:[(0,r.jsx)(i.fK,{children:"Debug menu"}),(0,r.jsxs)(i.a7,{children:[(0,r.jsxs)(l.X,{align:"justify",children:[(0,r.jsx)(s._,{htmlFor:"log-web-socket-setting",children:"Log web socket messages"}),(0,r.jsx)(u.r,{id:"log-web-socket-setting",checked:n,onChange:()=>o(!n),value:"1"})]}),(0,r.jsxs)(l.X,{align:"justify",marginTop:12,children:[(0,r.jsx)(s._,{htmlFor:"log-notebook-edit-lock-check",children:"Log notebook concurrent edit check"}),(0,r.jsx)(u.r,{id:"log-notebook-edit-lock-check",checked:E,onChange:()=>f(!E),value:"1"})]}),(0,r.jsxs)(l.X,{align:"justify",verticalAlign:"middle",marginTop:12,children:[(0,r.jsx)(s._,{htmlFor:"log-notebook-edit-lock-poll",children:"Use short poll frequency for notebook edit status (10s)"}),(0,r.jsx)(u.r,{id:"log-notebook-edit-lock-poll",checked:S,onChange:()=>g(!S),value:"1"})]})]}),(0,r.jsx)(i.cN,{children:(0,r.jsx)(d.zx,{use:"primary",onClick:e,children:"Close"})})]})}S.displayName="DebugMenuDialog"},571947:function(e,t,n){n.d(t,{c:()=>o});function o(e){return`${e.format("YYYY-MM-DD")}T00:00:00Z`}},360715:function(e,t,n){n.d(t,{f:()=>a});var o=n(137435),r=n(359483);let a=(e,t)=>(0,o.d)(e)?"month":(0,r.e)(e)||t?"day":"hour"},123246:function(e,t,n){n.d(t,{A:()=>o});function o(e){let t=e.endDate.clone().add(1,e.unitOfTime);return{lowerBound:e.startDate.clone(),upperBound:t}}},137435:function(e,t,n){n.d(t,{d:()=>o});function o({startDate:e,endDate:t}){return t.diff(e,"months",!0)>6}},359483:function(e,t,n){function o({startDate:e,endDate:t}){return t.diff(e,"days")>7}function r({startDate:e,endDate:t}){return t.diff(e,"days")>0}n.d(t,{e:()=>o,f:()=>r})},586575:function(e,t,n){n.d(t,{l:()=>function e(t,n){return r()(t)?t.map(t=>e(t,n)):i()(t)?s()(d()(t,t=>e(t,n)),(e,t)=>n(t)):t}});var o=n(653101),r=n.n(o),a=n(922967),i=n.n(a),l=n(328446),s=n.n(l),u=n(66172),d=n.n(u)},981713:function(e,t,n){n.d(t,{CZ:()=>p,LU:()=>f,pD:()=>d,q$:()=>c,qv:()=>E,uf:()=>u});var o=n(753427),r=n.n(o),a=n(373945),i=n.n(a);let l=[["",1],["K",1e3],["M",1e6],["B",1e9],["T",1e12]],s=(e=0)=>0===e?"0,0":`0,0.${"0".repeat(e)}`,u=(e,t=1)=>{let n=r()(e)?0:t;return i()(e).format(s(n))};function d(e,t=!1){let n=0;e>=3600&&(n=Math.floor(e/3600));let o="";return n>0&&(o+=String(n),t?(o+=" hour",n>1&&(o+="s")):o+="h"),o}function c(e,t=!1){let n=0;e>=60&&(n=Math.floor(e/60));let o="";return n>0&&(o+=String(n),t?(o+=" minute",n>1&&(o+="s")):o+="m"),o}function E(e){return e>=1e3?f(e/1e3):`${e.toFixed(0)}ms`}function f(e,t=!1,n=!1){let o=e,r=d(o,t);r.length&&(r+=" ");let a=+(o<10);o>=3600&&(o%=3600);let i=c(o,t);return i.length&&(r+=`${i} `),o>=60&&(o%=60),t?(n&&r.length&&(r+="and "),o>=60?r+=`${o.toFixed(a)} second`:Number.isInteger(o)?r+=`${o} second`:r+=`${o.toFixed(a)} second`,o>1&&(r+="s")):r+=`${o.toFixed(a)}s`,r}let p=(e,t,n)=>S(e,t,n,l),S=(e,t,n,o)=>{let r=0,a="";if(e<0)return"";for(let t=o.length-1;t>=0;t--)if(e/o[t][1]>=1){a=o[t][0],r=o[t][1];break}0===r&&(r=1);let i=u(e/(r||1),t)+a;return n&&1!==r?`${i} (${u(e,t)})`:i}},524225:function(e,t,n){n.d(t,{J:()=>a});var o=n(851678),r=n(19318);function a(e,t){let n=(0,o.v)(e);if(7!==n.length)throw Error(`Invalid identifier: '${e}'`);let a=n[1],i=n[3],l=n[5];return{type:t,database:(0,r.b)(a),schema:(0,r.b)(i),name:(0,r.b)(l)}}},170656:function(e,t,n){n.d(t,{m:()=>a});let o=/(\([^\(\)]+\))\s*RETURN/u,r=/(\(.+\))\s*/u;function a(e){if(!e)return"";let t=e.match(o),n=e.match(r);return t&&t.length>1?t[1]:n&&n.length>1?function(e){let t=e;if(!t)return"";let n=t.indexOf(" RETURN");if(-1===n&&(n=t.length),-1===(n=(t=t.slice(0,n)).lastIndexOf(")"))||-1===(n=t.lastIndexOf(")")))return"()";let o=n-1,r=1;for(;o>=0&&r>0;)")"===t[o]?r+=1:"("===t[o]&&(r-=1),o-=1;return 0!==r?"()":t.slice(o+1,n+1)||"()"}(e):"()"}},996913:function(e,t,n){n.d(t,{L:()=>r});var o=n(170656);function r(e){if(!e)return{name:"",args:""};let t=(0,o.m)(e),n=e.indexOf(t);return -1===n?{name:e,args:"()"}:{args:t,name:e.slice(0,n)}}},620745:function(e,t,n){n.d(t,{$:()=>a});var o=n(903542),r=n(154079);function a(e){let{database:t,schema:n,name:a}=e;return[t,n,a].map(e=>(0,r.v)((0,o.H)(e))).join(".")}},851678:function(e,t,n){n.d(t,{v:()=>o});function o(e){return e.split(/((?:[^."]|"(?:[^"]|"")*")+)/u)}},904660:function(e,t,n){n.d(t,{D:()=>r});var o=n(903542);function r(e,t){return{inlineRepr:e.map(e=>t?`'${e}'`:`${(0,o.H)(e)}`).join(",")}}},829490:function(e,t,n){n.d(t,{S:()=>o});function o(e){if(!!e!==e)throw Error("Didn't pass a boolean");return{bindingsJSONRepr:e,inlineRepr:String(e)}}},274271:function(e,t,n){n.d(t,{j:()=>o});function o(e){if(!/^[A-Za-z0-9_]+(\([0-9, ]+\))?$/u.test(e))throw Error(`String is not a valid datatype: ${e}`);return{inlineRepr:e}}},64562:function(e,t,n){n.d(t,{e:()=>o});function o(e){if(!e.match(/^[A-Za-z_][A-Za-z_0-9]*$/))throw Error(`String is not a valid keyword: ${e}`);return{inlineRepr:e}}},516415:function(e,t,n){n.d(t,{a:()=>o});function o(e){if(!e.match(/^[A-Za-z_][A-Za-z0-9_ ]*$/))throw Error(`String is not a valid set of keywords: ${e}`);return{inlineRepr:e}}},144237:function(e,t,n){n.d(t,{_:()=>o});function o(e){if(!Number.isFinite(e))throw Error("Didn't pass a finite number");return{bindingsJSONRepr:e,inlineRepr:String(e)}}},468690:function(e,t,n){n.d(t,{M:()=>o});function o(e){return{inlineRepr:e}}},28705:function(e,t,n){n.d(t,{Q:()=>r});var o=n(620745);function r(e){let t=`'@${(0,o.$)(e)}'`;return{bindingsJSONRepr:t,inlineRepr:t}}},345950:function(e,t,n){n.d(t,{F:()=>a});var o=n(903542),r=n(620745);function a(e,t){let n=`'@${(0,r.$)(e)}/${(0,o.H)(t)}'`;return{bindingsJSONRepr:n,inlineRepr:n}}},359248:function(e,t,n){n.d(t,{K:()=>r});var o=n(903542);function r(e){return{inlineRepr:e.map(e=>`'${(0,o.H)(e)}'`).join(",")}}},264602:function(e,t,n){n.d(t,{t:()=>r});var o=n(154079);let r=e=>{let t=(0,o.v)(e);return{bindingsJSONRepr:t,inlineRepr:t}}},366202:function(e,t,n){n.d(t,{Z:()=>r});var o=n(880735);function r(e,t){let n=o.$w(e,t);return{inlineRepr:`$$${n}$$`}}},653546:function(e,t,n){n.d(t,{RT:()=>l,Z2:()=>i,ZL:()=>a});var o,r=n(19318),a=((o={}).OnlyWhenFullySurrounding="onlyWhenFullySurrounding",o.WhenAtLeastOnOneSide="whenAtLeastOnOneSide",o);function i(e,t="onlyWhenFullySurrounding"){return e?l(e,t):e}function l(e,t="onlyWhenFullySurrounding"){let n,o=(0,r.b)(e);if(e!==o)return o;return n=e,"whenAtLeastOnOneSide"===t&&n?('"'===n.charAt(0)&&(n=n.substr(1,n.length-1)),'"'===n.charAt(n.length-1)&&(n=n.substr(0,n.length-1))):n&&'"'===n.charAt(0)&&'"'===n.charAt(n.length-1)&&(n=n.substr(1,n.length-2)),n}},414710:function(e,t,n){n.d(t,{U:()=>d});var o=n(947272),r=n(18852),a=n.n(r),i=n(847345),l=n(327898),s=n(799787),u=n(134445);function d(e,t,n,r){var d;let c=i.useContext(u.L),E=(0,s.h)(null==c||null==(d=c.user)?void 0:d.api,"UserStore is not loaded"),f=i.useContext(o.BQ);return(0,i.useMemo)(()=>({executeQuery:(o,i,s,u,d)=>{var c,p,S,g,_,h,m,I,T;return c=E,p=o,S=e,g=n,_=i,h=s,m=u,I=r,T={profiler:f,secondaryRoles:t,...d},(0,l.O)(I,{getCacheKey:()=>{var e;let t={sqlQuery:p,currentRole:S,currentWarehouse:g,description:_,fetchId:h,hideFromQueryHistory:m,secondaryRoles:null==T?void 0:T.secondaryRoles},n=null==T||null==(e=T.requestContext)?void 0:e.userKey;return n&&(t[n]=n),a()(t)},getData:async()=>{var e;let t=null==T||null==(e=T.profiler)?void 0:e.group(`executeSqlQuery:${_}`);null==t||t.addContext("role",S),null==t||t.addContext("warehouse",g),null==t||t.addContext("sqlText",p.sqlText),null==t||t.addContext("pid",null==T?void 0:T.pid);try{return null==t||t.start(),{tableData:await c.query(p,{isInternal:m,role:S,warehouse:g,desc:_,context:null==T?void 0:T.context,requestContext:null==T?void 0:T.requestContext,pid:null==T?void 0:T.pid,secondaryRoles:null==T?void 0:T.secondaryRoles}),timestamp:new Date(Date.now())}}finally{null==t||t.end()}}})}}),[E,r,f,e,t,n])}},992143:function(e,t,n){n.d(t,{O:()=>E,l:()=>f});var o=n(792851),r=n(18852),a=n.n(r),i=n(847345),l=n(327898),s=n(595124),u=n(994497),d=n(426172),c=n(101290);let[E,f]=(0,o.Z)(()=>(function(){let e=(0,s.b)(),t=(0,i.useCallback)(async(t,n,o,r=u.U.urc.requestContext())=>{var a;let i=await (0,l.O)(e,{getCacheKey:()=>{var e;return p(t,n,o,null!=(e=r.role)?e:"")},getData:async()=>await (0,d._)(t,n,o,r)});return e.clearEntry(p(t,n,o,null!=(a=r.role)?a:"")),i},[e]),n=(0,i.useCallback)(async(t,n,o,r,a=u.U.urc.requestContext())=>{let i=await (0,c.u)(t,n,o,r,a);if(i.success){var l;e.clearEntry(p(t,n,o,null!=(l=a.role)?l:""))}return i},[e]);return(0,i.useMemo)(()=>({read:t,write:n}),[t,n])})());function p(e,t,n,o){return a()({role:o,stage:e,path:t,fileName:n})}},735929:function(e,t,n){n.d(t,{J:()=>s,R:()=>u});var o=n(700577),r=n(821018),a=n(28705),i=n(626342);let l="/files/download";async function s(e,t,n,a){return(0,i.a)()?await function(e,t,n,a={}){var i,s;let u=o.i._DP_DISABLE_DEFAULT_REQUEST_CONTEXT_FOR_STAGE_FILE_OPERATIONS(),d={stage:e,filePath:t,role:u?n.role:null!=(i=n.role)?i:"PUBLIC",secondaryRoles:u?n.secondaryRoles:null!=(s=n.secondaryRoles)?s:"ALL"};return(0,r.nufetchForm)(l,n,{body:JSON.stringify(d),method:"POST",headers:{"Content-Type":"application/json",...a}},"/v1")}(e,t,n,a):await function(e,t,n,a){var i,s,u;let d=o.i._DP_DISABLE_DEFAULT_REQUEST_CONTEXT_FOR_STAGE_FILE_OPERATIONS(),c=new FormData;return c.set("stage",e),c.set("relativePath",t),c.set("allowUnencryptedReadWrite","true"),d?n.secondaryRoles&&c.set("secondaryRoles",n.secondaryRoles):c.set("secondaryRoles",null!=(i=n.secondaryRoles)?i:"ALL"),(0,r.nufetchForm)(l,d?n:{...n,role:null!=(s=n.role)?s:"PUBLIC",secondaryRoles:null!=(u=n.secondaryRoles)?u:"ALL"},{method:"POST",body:c,...a?{headers:a}:{}})}(e,t,n,a)}function u(e){return(0,a.Q)(e).inlineRepr}},626342:function(e,t,n){n.d(t,{a:()=>r,z:()=>a});var o=n(700577);function r(){return o.i.UI_ENABLE_WAW_DEX_FEATURE_12()}function a(){return o.i.UI_ENABLE_WAW_DEX_FEATURE_13()}},382021:function(e,t,n){n.d(t,{L:()=>r});var o=n(409435);function r(e,t){return(0,o.Vo)([e,t],!0)}},409435:function(e,t,n){function o(e){return e?e.startsWith("/")?e:`/${e}`:""}function r(e,t=!1){let n=e.map(e=>e?e.replace(/^\/|\/$/gu,""):"").filter(e=>""!==e).join("/");return t?`/${n}`:n}n.d(t,{Vo:()=>r,yx:()=>o})},426172:function(e,t,n){n.d(t,{J:()=>l,_:()=>i});var o=n(994497),r=n(735929),a=n(382021);async function i(e,t,n,l=o.U.urc.requestContext()){try{let o=await (0,r.J)(e,(0,a.L)(t,n),l,{Accept:"text/plain"});return{success:!0,content:o.textContent,error:null}}catch(e){if(e instanceof Error)return{success:!1,error:e,content:null};return{success:!1,error:Error("Unknown Error"),content:null}}}async function l(e){let{success:t,error:n,content:o}=await e;if(t)return o;throw n}},101290:function(e,t,n){n.d(t,{g:()=>s,u:()=>u});var o=n(700577),r=n(821018),a=n(994497),i=n(626342),l=n(409435);async function s(e,t,n,u,d=a.U.urc.requestContext()){var c,E,f;let p=o.i._DP_DISABLE_DEFAULT_REQUEST_CONTEXT_FOR_STAGE_FILE_OPERATIONS(),S=new FormData;if(S.set("stage",e),S.set("path",(0,l.yx)(t)||"/"),d.secondaryRoles&&S.set("secondaryRoles",d.secondaryRoles),(0,i.z)()){S.set("fileName",n),p?d.role&&S.set("role",d.role):S.set("role",null!=(c=d.role)?c:"PUBLIC");let e=new URLSearchParams;S.forEach((t,n)=>{e.append(n,t.toString())});let t=`/files/upload?${e.toString()}`;await (0,r.nufetchForm)(t,p?d:{...d,role:null!=(E=d.role)?E:"PUBLIC"},{method:"POST",body:u,headers:{"Content-Type":"application/octet-stream",Accept:"text/plain"}},"/v1")}else S.set("file",new File([u],n)),await (0,r.nufetchForm)("/files/upload",p?d:{...d,role:null!=(f=d.role)?f:"PUBLIC"},{method:"POST",body:S})}async function u(e,t,n,o,r=a.U.urc.requestContext()){try{return await s(e,t,n,o,r),{success:!0,error:null}}catch(e){if(e instanceof Error)return{success:!1,error:e};return{success:!1,error:Error("Unknown Error")}}}},981053:function(e,t,n){n.d(t,{k:()=>a});var o=n(847345),r=n(134445);function a(e){let t=(0,r.m)(["user"]).user;return(0,o.useMemo)(()=>!!t&&t.userRequestContext(e),[t,e])}},440859:function(e,t,n){n.d(t,{Z:()=>g});var o=n(411733),r=n(175117),a=n.n(r),i=n(906857),l=n(821018),s=n(667680),u=n(988387),d=n(38238),c=n(255846),E=n(123331),f=n(650824);class p{async receive(e){}addUpdater(e,t,n){}removeUpdater(e,t,n){}}async function S(){var e,t;if(null==(t=u.X.stores)||null==(e=t.user)?void 0:e.isGuestUser)return;let n=new d.E,o=new p,r=new c.s,a=new f.P(new i.$,n,e=>new E.w(l,e),o,r);await a.restPassthrough("POST","/request/console/bootstrap-data-request",{role:"PUBLIC",isJsonBody:!0,keepAlive:!1},{dataKinds:[]})}let g=new class{registerEventListeners(){document.addEventListener("mousemove",this.onGlobalMouseMoveDebounced),document.addEventListener("mousedown",this.onGlobalMouseDownDebounced),document.addEventListener("visibilitychange",this.onVisibilityChangeHandler)}unregisterEventListeners(){document.removeEventListener("mousemove",this.onGlobalMouseMoveDebounced),document.removeEventListener("mousedown",this.onGlobalMouseDownDebounced),document.removeEventListener("visibilitychange",this.onVisibilityChangeHandler),this.stopUserSessionValidityCheck()}constructor(e={}){this.registerUserActivityListener=e=>{this.onUserActivityListeners.push(e),this.validityCheckTimer||this.registerEventListeners()},this.unregisterUserActivityListener=e=>{this.onUserActivityListeners=this.onUserActivityListeners.filter(t=>t!==e),this.onUserActivityListeners.length||this.unregisterEventListeners()},this.onVisibilityChangeHandler=()=>{"hidden"===document.visibilityState&&(o.cM.info("Tracker: Turning off timers"),this.stopUserSessionValidityCheck()),"visible"===document.visibilityState&&(o.cM.info("Tracker: Turning on timers"),this.startUserSessionValidityCheck())},this.isUserIdle=()=>a()().diff(this.lastView)>6e4,this.checkForSessionValidity=async()=>{if(a()().diff(this.lastView)>6e4){o.cM.info("Tracker: Check","Checking session with bootstrap activity");try{await S()}catch(e){o.cM.error(e,{message:"User session check failed."});return}}this.validityCheckTimer=window.setTimeout(this.checkForSessionValidity,60001)},this.startUserSessionValidityCheck=()=>{this.validityCheckTimer||this.checkForSessionValidity()},this.stopUserSessionValidityCheck=()=>{this.validityCheckTimer&&clearTimeout(this.validityCheckTimer),this.validityCheckTimer=null},this.view=async()=>{let e=a()();this.lastView=e,this.onUserActivityListeners&&this.onUserActivityListeners.forEach(t=>t(e))},this.onGlobalMouseMove=()=>{this.view()},this.onGlobalMouseDown=()=>{this.view()},this.lastView=a()(),this.onUserActivityListeners=e.onViewListeners||[],this.onGlobalMouseMoveDebounced=(0,s.D)(this.onGlobalMouseMove,100),this.onGlobalMouseDownDebounced=(0,s.D)(this.onGlobalMouseDown,100),this.registerEventListeners()}}},603419:function(e,t,n){n.d(t,{fc:()=>s,xK:()=>u,zp:()=>l});var o=n(78633),r=n(847345),a=n(556868),i=n(440859);function l(e,t={}){let{pollingIntervalInSec:n=10,maxBackOffIntervalInSec:o=45,shouldPauseOnInactive:r,enableBackOffOnPollingFailures:s,maxPollingFailuresBeforeBackOff:u}=t;return(0,a.i)(e,i.Z,{maxRetries:1/0,constantRetryTimeInSec:n,maxBackOffIntervalInSec:o,shouldPauseOnInactive:r,enableBackOffOnPollingFailures:s,maxPollingFailuresBeforeBackOff:u})}function s(e,t={}){let[n]=r.useState(l(e,t)),a=(0,o.N)(t);return r.useEffect(()=>{let{pollingIntervalInSec:t=10,maxBackOffIntervalInSec:o=45,shouldPauseOnInactive:r,enableBackOffOnPollingFailures:i,maxPollingFailuresBeforeBackOff:l}=a;n.reset({asyncFunction:e,retriableOptions:{constantRetryTimeInSec:t,maxBackOffIntervalInSec:o,shouldPauseOnInactive:r,enableBackOffOnPollingFailures:i,maxPollingFailuresBeforeBackOff:l}})},[e,a]),r.useEffect(()=>()=>{n.stop()},[n]),n}function u(e,t){let{maxRetries:n,shouldPauseOnInactive:o,enforceMaxRetryOnConsecutivePollFailures:r}=t;return(0,a.i)(e,i.Z,{maxRetries:n,shouldPauseOnInactive:o,enforceMaxRetryOnConsecutivePollFailures:r})}},134445:function(e,t,n){n.d(t,{L:()=>l,m:()=>u});var o=n(78633),r=n(491002),a=n(847345),i=n(570096);let l=a.createContext(void 0),s=()=>{};function u(e,t=s,n=i.I){let d=a.useContext(l),c=(0,o.N)(e.reduce((e,t)=>(e[t]=d[t],e),{})),E=(0,o.N)(Object.keys(c).map(e=>c[e])),f=(0,o.N)({...c,untracked:d}),p=a.useCallback((e,n)=>{t(e,f,n)},[t,f]),S=(0,r.N)(),g=a.useCallback((e,t)=>{n(e,t)&&S()},[S,n]);return a.useEffect(()=>(E.forEach(e=>{e.__subscribe(p,g)}),()=>E.forEach(e=>{e.__unsubscribe(p,g)})),[E,p,g]),f}},739716:function(e,t,n){n.d(t,{d:()=>i});var o=n(700577),r=n(847345),a=n(196002);let i=()=>(0,r.useCallback)(()=>!!o.i.UI_ENABLE_IS_PRIVATELINK_OVERRIDE_FOR_INTERNAL_TEST()||(0,a.r)(window.location.hostname),[])},216300:function(e,t,n){n.d(t,{E:()=>l,t:()=>i});var o=n(286204),r=n(847345);let a=(0,r.createContext)({data:null,loading:!1,appViewRequestId:"default-request-id"}),i=({bootstrapResult:e,children:t})=>(0,o.jsx)(a.Provider,{value:e,children:t});i.displayName="StreamlitBootstrapDataProvider";let l=()=>(0,r.useContext)(a)},812859:function(e,t,n){n.d(t,{T:()=>s});var o=n(354908),r=n(978005),a=n(636249),i=n(186074),l=n(561298);let s=({error:e,isUserError:t})=>{let n,s,u;if(e instanceof i.Z?n=e.payload:e instanceof l.a||e instanceof Error?n=e.message:"string"==typeof e?n=e:null!=e&&(n="unknown error"),e instanceof o.M){if(s=e.logDetailMessage,!(u=e.externalErrorCause.code)&&e.message){let t=e.message.match(/^(\d+):/u);t&&(u=t[1])}}else e instanceof a.P?u=e.errorCode:e instanceof i.Z?u=e.topic.toString():e instanceof l.a&&(s=e.errors.map(e=>e.message).join(", "));return{error:n,isUserError:t||(0,r.e)(e),errorDetail:s,errorCode:u}}},246220:function(e,t,n){n.d(t,{aR:()=>l,ho:()=>i,ur:()=>a});let o="streamlit-",r=["embed","embed_options","__parentOrigin","__clientVersion"];function a(e){let t=new URLSearchParams;for(let[n,o]of e)!r.includes(n)&&n.length>0&&t.append(n,o);return t}function i({snowsightQueryParams:e,iframeQueryParams:t}){let n=new URLSearchParams;for(let[t,r]of e)t.startsWith(o)||n.append(t,r);for(let[e,r]of a(t))n.append(`${o}${e}`,r);return n}function l(e){let t=new URLSearchParams;for(let[n,r]of e)if(n.startsWith(o)){let e=n.replace(o,"");e.length>0&&t.append(e,r)}return a(t)}},491830:function(e,t,n){n.d(t,{Du:()=>l,FF:()=>h,Sz:()=>p,VP:()=>f,VS:()=>d,YT:()=>u,fY:()=>s,fe:()=>c,hk:()=>_,mR:()=>g,s9:()=>S,zL:()=>E});var o=n(329322),r=n(620400),a=n(829490),i=n(36534);function l({fullStreamlitIdentifier:e,isPrivatelink:t}){let n=new o.L().add("CALL SYSTEM$GENERATE_STREAMLIT_URL_FROM_NAME({}",(0,i.i)((0,r.m)(e)));return n.add(", {}",(0,a.S)(t)),n.add(");"),n.toQuery()}function s(e){return new o.L().add("CALL SYSTEM$GENERATE_STREAMLIT_TOKEN({});",(0,i.i)((0,r.m)(e))).toQuery()}function u(e){return new o.L().add("CALL SYSTEM$GET_STREAMLIT_API_TOKEN({});",(0,i.i)((0,r.m)(e))).toQuery()}function d(e,t){return new o.L().add("CALL SYSTEM$GENERATE_STREAMLIT_TOKEN_V2({}, {});",(0,i.i)((0,r.m)(e)),(0,a.S)(t)).toQuery()}function c(e){return new o.L().add("CALL SYSTEM$STREAMLIT_RELOAD({});",(0,i.i)((0,r.m)(e))).toQuery()}function E(e,t){return new o.L().add("CALL SYSTEM$ASSOCIATE_STAGE_WITH_STREAMLIT({}, {});",(0,i.i)((0,r.m)(e)),(0,i.i)((0,r.m)(t))).toQuery()}function f(e){return new o.L().add("CALL SYSTEM$STREAMLIT_RERUN({});",(0,i.i)((0,r.m)(e))).toQuery()}function p(e,t,n={}){return new o.L().add("CALL SYSTEM$LOG_STREAMLIT_TELEMETRY({},{},{});",(0,i.i)(null===e?"":(0,r.m)(e)),(0,i.i)(t),(0,i.i)(JSON.stringify(n))).toQuery()}function S(e,t){return new o.L().add("CALL SYSTEM$LOG_STREAMLIT_TELEMETRY_BATCH({},{});",(0,i.i)(null===e?"":(0,r.m)(e)),(0,i.i)(JSON.stringify(t))).toQuery()}function g({fullStreamlitIdentifier:e,appViewRequestId:t,isPrivatelink:n,historyQueryId:l}){let s=new o.L().add("CALL SYSTEM$STREAMLIT_BOOTSTRAP({}",(0,i.i)((0,r.m)(e))),u=(0,i.i)(null!=t?t:""),d=[{param:u,couldIgnore:!t},{param:(0,a.S)(n),couldIgnore:!1},{param:(0,i.i)(null!=l?l:""),couldIgnore:!l}];return d.slice(0,d.findLastIndex(e=>!e.couldIgnore)+1).forEach(e=>s.add(", {}",e.param)),s.add(");"),s.toQuery()}function _(e){return new o.L().add("CALL SYSTEM$STREAMLIT_BOOTSTRAP_STARTUP_STATUS({});",(0,i.i)((0,r.m)(e))).toQuery()}function h({srcStreamlitIdentifier:e,newStreamlitName:t,newStreamlitTitle:n}){return new o.L().add("CALL SYSTEM$DUPLICATE_STREAMLIT_WITHOUT_EMBEDDED_STAGE({}, {}, {});",(0,i.i)((0,r.m)(e)),(0,i.i)(t),(0,i.i)(n)).toQuery()}},750512:function(e,t,n){n.d(t,{$g:()=>c,AU:()=>I,EX:()=>y,JI:()=>T,MI:()=>E,TW:()=>O,Ui:()=>d,Wh:()=>R,ZR:()=>C,_t:()=>f,bH:()=>s,c:()=>i,cQ:()=>p,dr:()=>A,fY:()=>b,gN:()=>S,jU:()=>m,kL:()=>h,lU:()=>N,p0:()=>r,qK:()=>v,sB:()=>_,tS:()=>l,uy:()=>u,w:()=>L,wd:()=>g,x3:()=>a});var o=n(700577);function r(){return o.i.UI_ENABLE_STREAMLIT_HIDE_PREVIEW_PILL()}function a(){return o.i.UI_ENABLE_STREAMLIT_EMBEDDED_STAGES()}function i(){return o.i.ENABLE_STREAMLIT_VERSIONED_STAGE()}function l(){return o.i.UI_ENABLE_STREAMLIT_NEW_MENU_BUTTON()}function s(){return o.i.FEATURE_UI_ENABLE_STREAMLIT_SCHEDULING()}function u(){return o.i.UI_ENABLE_STREAMLIT_DEBUG_CONSOLE_LOGGING_FOR_TESTING()}function d(){return o.i.UI_ENABLE_STREAMLIT_SUPPRESS_WEBSOCKET_HEARTBEATS()}function c(){return o.i.UI_ENABLE_STREAMLIT_DEBUG_FATAL_EXCEPTION_OVERRIDE_FOR_TESTING()}function E(){return o.i.UI_ENABLE_STREAMLIT_ON_SPCS()}function f(){return o.i.UI_ENABLE_STREAMLIT_PREAMBLE_CSP_VIOLATION_DETECTION()}function p(){return o.i.UI_ENABLE_STREAMLIT_PREAMBLE_SERVICE_WORKER()}function S(){return o.i.UI_ENABLE_STREAMLIT_BATCH_TELEMETRY_ENDPOINT()}function g(){return o.i.UI_ENABLE_STREAMLIT_PIPE_TELEMETRY_TO_BATCH_ENDPOINT()}function _(){return o.i.STREAMLIT_BATCH_TELEMETRY_QUEUE_THROTTLE_IN_MS()}function h(){return o.i.UI_ENABLE_STREAMLIT_INDIVIDUAL_LOAD_METRICS()}function m(){return o.i.ENABLE_STREAMLIT_SPCS_RUNTIME_V2()}function I(){return o.i.UI_ENABLE_STREAMLIT_DISPLAY_SPCS_DETAILED_LOAD_SEQUENCE()}function T(){return o.i.UI_ENABLE_STREAMLIT_RESTRICTED_CALLERS_RIGHTS()}function R(){return o.i.FEATURE_COPILOT_STREAMLIT()}function C(){return o.i.UI_ENABLE_MLPF_FEATURE_16()}function y(){return o.i.UI_ENABLE_STREAMLIT_APP_STATE_MACHINE()}function v(){return o.i._DP_UI_ENABLE_STREAMLIT_LIST_VIEW_RUNTIME_STATUS_COLUMN()}function N(){return o.i.UI_ENABLE_CHROMELESS_SIS_APPS()}function A(){return o.i._DP_UI_ENABLE_STREAMLIT_WEBSOCKET_HEALTHCHECK()}function b(){return o.i._DP_UI_ENABLE_STREAMLIT_WEBSOCKET_HEALTHCHECK_SHADOW_MODE()}function O(){return o.i._DP_UI_ENABLE_STREAMLIT_CACHE_IFRAME_URL()}function L(){return o.i._DP_UI_ENABLE_STREAMLIT_PROMPT_INPUT()}},60178:function(e,t,n){n.d(t,{Y:()=>f,t:()=>E});var o=n(700577),r=n(411733),a=n(847345),i=n(640579),l=n(799787),s=n(134445),u=n(739716),d=n(491830),c=n(208913);let E=640;function f(){var e;let t=o.i._DP_UI_ENABLE_STREAMLIT_WEBSOCKET_TELEMETRY(),{dataDiscoverRole:n,secondaryRoles:f}=(0,i.j)(),p="log-streamlit-batch-telemetry",S=(0,a.useContext)(s.L),g=(0,l.h)(null==S||null==(e=S.user)?void 0:e.api,"UserStore is not loaded"),_=(0,u.d)();return t&&c.WD.forEach(e=>c.kD.add(e)),(0,a.useCallback)(async({events:e,fullStreamlitIdentifier:t})=>{let o=e.filter(e=>c.kD.has(e.eventName));if(0===o.length)return;let a=Date.now();for(let e=0;e<o.length;e+=E){let i=function(e,t,n){let o={};for(let i of e){var r,a;let{eventName:e,additionalParams:l={},componentName:s}=i,u={clientTimeStamp:null!=(r=l.clientTimeStamp)?r:n,...l,componentName:s,isPrivateLink:t()},d=null!=(a=o[e])?a:[];d.push(u),o[e]=d}return o}(o.slice(e,e+E),_,a),l=(0,d.s9)(t,i);try{await g.query(l,{isInternal:!0,role:n,secondaryRoles:f,desc:p})}catch(e){r.cM.error(e)}}},[g,n,f,p,_])}},208913:function(e,t,n){n.d(t,{kD:()=>m,WD:()=>h,Qh:()=>I});var o=n(700577),r=n(411733),a=n(847345),i=n(640579),l=n(799787),s=n(134445),u=n(739716),d=n(468804),c=n(491830),E=n(750512),f=n(701957);class p{actOnItems(){this.action(this.queue.splice(0,this.queue.length))}enqueueItem(e){this.queue.push(e),-1!==this.maxQueueSize&&this.queue.length>=this.maxQueueSize&&this.actOnItems(),this.throttledAction()}flush(){this.throttledAction.flush()}get length(){return this.queue.length}constructor(e,t,n=-1){this.queue=[],this.action=e,this.throttledAction=(0,f.P)(this.actOnItems.bind(this),t,{leading:!1}),this.maxQueueSize=n}}var S=n(620400),g=n(60178);let _=()=>{var e;let t=(0,g.Y)(),n=(0,a.useCallback)(e=>{let n={};for(let t of e){var o;let e=t.fullStreamlitIdentifier?(0,S.m)(t.fullStreamlitIdentifier):"<none>",r=null!=(o=n[e])?o:[];r.push(t),n[e]=r}for(let e of Object.values(n))t({fullStreamlitIdentifier:e[0].fullStreamlitIdentifier,events:e.map(e=>({componentName:e.componentName,eventName:e.eventName,additionalParams:e.additionalParams}))})},[t]),{analytics:o}=(0,s.m)(["analytics"]),r=o.getStreamlitQueue(),i=null!=(e=(0,E.sB)())?e:5e3,l=(0,E.wd)()?new p(n,i,g.t):void 0;return r||o.setStreamlitQueue(l),null!=r?r:l},h=[d.dO0,d.uYd,d.TV5,d.UfY,d.X9g],m=new Set([d.WmD,d.D3Z,d.w0o,d.SxE,d.Zq6,d.Hqt,d.pwE,d.ESo,d.RKz,d.__d,d.KF8,d.Bpb,d.qnG,d.rKO,d.hn2,d.IeT,d.cT0,d.u9u,d.Vdk,d.wKB,d.Rb3,d.J8b,d.yDA,d.Xrf,d.me3,d.VF4,d.VjJ,d.FSx,d.xJE,d.m2U,d.peE,d.Ao4,d.jym,d.UG5,d.t6j,d.mBZ]);function I(){var e;let t=o.i._DP_UI_ENABLE_STREAMLIT_WEBSOCKET_TELEMETRY(),n=(0,E.gN)(),d=(0,E.wd)()&&n,{dataDiscoverRole:f,secondaryRoles:p}=(0,i.j)(),S="log-streamlit-telemetry",g=(0,a.useContext)(s.L),I=(0,l.h)(null==g||null==(e=g.user)?void 0:e.api,"UserStore is not loaded"),T=(0,u.d)(),R=_();return t&&h.forEach(e=>m.add(e)),(0,a.useCallback)(e=>{let{fullStreamlitIdentifier:t,componentName:n,eventName:o,additionalParams:a={}}=e;if(!m.has(o))return;if(d&&R){a.clientTimeStamp=Date.now(),R.enqueueItem({...e,additionalParams:a});return}let i={...a,componentName:n,clientTimeStamp:Date.now(),eventType:o,isPrivateLink:T()},l=(0,c.Sz)(t,o,i);I.query(l,{isInternal:!0,role:f,secondaryRoles:p,desc:S}).catch(e=>{r.cM.error(e)})},[d,R,T,I,f,p,S])}},878085:function(e,t,n){n.d(t,{Z:()=>a});var o=n(847345),r=n(750512);let a=()=>{let e=(0,r.uy)();return{debugLog:(0,o.useCallback)((t,n,...o)=>{e&&console.debug(`[ST_DEBUG][${t}]`,n,...o)},[e])}}},799990:function(e,t,n){n.d(t,{H:()=>s,h:()=>l});var o=n(847345),r=n(420174),a=n(524225);let i=o.createContext(""),l=i.Provider,s=e=>{let t=(0,o.useContext)(i),n=e||t;return{entityId:(0,o.useMemo)(()=>(0,a.J)(n,r.M.STREAMLIT),[n]),entityIdStr:n}}},331638:function(e,t,n){n.d(t,{A:()=>r});var o=n(239661);function r(e){let t=(0,o.f)({iframeUrl:e,page:void 0});return t?new URL(t).origin:void 0}},239661:function(e,t,n){n.d(t,{f:()=>d});var o=n(396248),r=n(847345),a=n(703694),i=n(799787),l=n(952874),s=n(974053),u=n(246220);function d({iframeUrl:e,page:t,rawParams:n=(0,s.s)()}){let{colorScheme:d}=(0,o.ZQ)();return(0,r.useMemo)(()=>{if(!e)return;(0,i.N)(""===new URL(e).search,"Base URL must not contain search parameters");let o=new URL(null!=t?t:"",e.endsWith("/")?e:`${e}/`);o.searchParams.set("embed","true"),o.searchParams.append("embed_options","show_padding"),"dark"===d&&o.searchParams.append("embed_options","dark_theme"),"light"===d&&o.searchParams.append("embed_options","light_theme"),o.searchParams.set("__parentOrigin",window.location.origin),o.searchParams.set("__clientVersion",encodeURIComponent(a.X.clientVersion||""));let r=(0,u.ur)(o.searchParams);for(let[e,t]of((0,i.N)((0,l.r)(r),`Unknown query parameter(s) [${r.toString()}] set on Streamlit iFrame URL.`),(0,u.aR)(n)))o.searchParams.append(e,t);return o.toString()},[e,t,d,n])}},332287:function(e,t,n){n.d(t,{I:()=>r});var o,r=((o={}).loading="loading",o.loaded="loaded",o.suspended="suspended",o)},636249:function(e,t,n){n.d(t,{P:()=>o});class o extends Error{}},186074:function(e,t,n){n.d(t,{Z:()=>o});class o extends Error{constructor({topic:e,level:t,payload:n}){super(n),this.topic=e,this.level=t,this.payload=n}}},561298:function(e,t,n){n.d(t,{a:()=>o});class o extends AggregateError{}},271343:function(e,t,n){n.d(t,{e:()=>o});let o={CONNECTED:"CONNECTED",DISCONNECTED_FOREVER:"DISCONNECTED_FOREVER",INITIAL:"INITIAL",PINGING_SERVER:"PINGING_SERVER",CONNECTING:"CONNECTING"}},955407:function(e,t,n){function o(e,t){let n=e,o=null;for(;n;){let e=n;if(e.getAttribute&&(o=e.getAttribute(t)))return o;n=n.parentNode}return null}function r(e,t){return o(e,"data-"+t)}function a(e,t){for(;e;){if(t(e))return!0;e=e.parentNode}return!1}function i(){}function l(e){e.preventDefault(),e.stopPropagation()}function s(e){return e.stopPropagation()}function u(e){e.dataTransfer.setData("text/plain",""),c(e)}function d(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function c(e){if(e.dataTransfer.effectAllowed="move",e.dataTransfer.setDragImage){let t=document.createElement("img");t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",e.dataTransfer.setDragImage(t,0,0)}}function E(e){for(;e;){if(e.getAttribute&&e.getAttribute("data-is-popover"))return e;e=e.parentNode}}function f(e,t){let n=E(e),o=E(t);return n&&o&&n===o}n.d(t,{DY:()=>a,EI:()=>i,Jf:()=>c,Ob:()=>f,QO:()=>d,UW:()=>s,aC:()=>o,nm:()=>u,qf:()=>l,um:()=>r})},404229:function(e,t,n){n.d(t,{z:()=>u});var o=n(847345),r=n(209268),a=n(403771),i=n(652691),l=n(420174),s=n(546314);let u=e=>{let t=(0,s.h)(),{logEventToSnowflakeAndDatadog:n}=(0,a.z)(),u=sessionStorage.getItem(r.VE);return(0,o.useCallback)(o=>{let{fullIdentifier:r,forceLog:a,...s}=o;switch(e){case l.M.STREAMLIT:t({fullStreamlitIdentifier:r,...s,eventType:s.eventType});break;case l.M.NOTEBOOK:n({component:o.componentName,event:o.eventName,type:o.eventType,data:{...o.additionalTelemetryParams,windowId:u,fullNotebookIdentifier:r}});break;default:throw(0,i.U)(e),Error(`Received call to logFileBasedEntityEvent with unsupported type: ${e}`)}},[n,t,e,u])}},711081:function(e,t,n){n.d(t,{_:()=>l});var o=n(847345),r=n(797325),a=n(800840),i=n(134445);function l(){let e=(0,o.useContext)(a.V1),t=(0,i.m)(["user"]),{formatMessage:n}=(0,r.Z)();return(0,o.useCallback)(async(o,r,a)=>{let i={lastUpdatedUser:t.user.currentUserId,lastUpdatedTime:Date.now()};try{await e.alter(r,o,{comment:JSON.stringify(i)},{secondaryRoles:a})}catch(e){throw Error(n({id:"Could not refresh last updated information. Error: {message}"},{message:e instanceof Error?e.message:"unknown error"}))}},[n,e,t.user.currentUserId])}},306148:function(e,t,n){n.d(t,{j:()=>A});var o=n(286204),r=n(628155),a=n(995780),i=n(813673),l=n(314040),s=n(657952),u=n(242291),d=n(222182),c=n(493076),E=n(173624),f=n(887463),p=n(70734),S=n(90373),g=n(874437),_=n(847345),h=n(797325),m=n(354908),I=n(623368),T=n(940591),R=n(261459),C=n(620400),y=n(468804),v=n(194838),N=n(404229);let A=_.memo(({hideLayer:e,sourceEntityIdentifier:t,sourceEntityTitle:n,dialogTitle:A,navigateToNewEntity:b,embeddedStageEnabled:O=!1,versionedStageEnabled:L=!0,openNewEntityButtonText:k,duplicate:w,readyForDuplication:M,entityShared:D,validateName:U,additionalTelemetryParams:P})=>{let{formatMessage:x}=(0,h.Z)(),[F,B]=(0,_.useState)(""),G=(0,_.useRef)(!1),[V,K]=(0,_.useState)(r.Yg.NONE),[W,H]=(0,_.useState)(!1),[$,Q]=(0,_.useState)(null),j=(0,N.z)(t.type),Y=(0,_.useRef)(!1),z=(0,_.useRef)(null),q=(0,T.Z)(t);(0,_.useEffect)(()=>{G.current||B(n?`Copy of ${n}`:"")},[n]);let Z=(0,_.useCallback)(e=>{G.current=!0,B(e.target.value)},[]),J=V!==r.Yg.INVALID&&F&&!W&&M,X=(0,_.useCallback)(async()=>{if(!J)return;H(!0);let e=null,n=null,o=null,r=!1,i=null,l=(0,C.m)(t);try{(0,I.H$)(v.g3,l),i=await w({newEntityName:F,newEntityTitle:F}),Q(i),r=!0}catch(i){var s;let t;n=i instanceof m.M?null==(s=i.externalErrorCause)?void 0:s.code:void 0,o=i instanceof m.M?i.statusCode:void 0,t=n===g.SFDBErrorCode.ALREADY_EXISTS_002002?x({id:"This name is used by another notebook. Try a different name."}):(i instanceof Error?i.message:void 0)||x({id:"Error when duplicating the object. Try again later."}),(0,a.w)({type:"alert",content:t,autoDismiss:!1}),r=!1,e=null==i?void 0:i.message}finally{H(!1);let a=(0,I.Oi)({event:v.g3,markers:[l],isUserE2E:!1}),{duration:s}=(0,I.bR)(v.g3,a);j({fullIdentifier:t,componentName:y.jNi,eventName:y.LGO,eventType:r?"ui_response_success":"ui_response_error",forceLog:!1,additionalTelemetryParams:{success:r,embeddedStageEnabled:O,versionedStageEnabled:L,error:null!=e?e:void 0,errorStatusCode:null!=o?o:void 0,errorCode:null!=n?n:void 0,hasUserChangedTitle:G.current,runtime:q?"spcs":"wh",durationMs:s,newEntityIdentifier:r?(0,C.m)(i):void 0,...P}})}},[J,w,O,x,q,j,F,t,L,P]),ee=(0,_.useCallback)(()=>{$&&(e(),b($))},[e,b,$]),et=(0,_.useMemo)(()=>(0,o.jsx)(i.q,{minHeight:30,paddingTop:4,paddingBottom:4,borderRadius:8,width:"100%"}),[]),en=(0,_.useMemo)(()=>(0,o.jsxs)(l.g,{children:[(0,o.jsx)(s.lt,{layout:"compact",children:(0,o.jsx)(s.MR,{label:x({id:"Name"}),input:{value:F,disabled:W,validation:e=>U?U(e):(0,R.hs)(e,x),onValidationChange:K,onChange:Z,spellCheck:!1,autoFocus:!0}})}),D&&(0,o.jsxs)(u.X,{marginTop:16,verticalAlign:"middle",children:[(0,o.jsx)(d.JO,{icon:"warning-triangle",color:c.Q2.iconColor,flexShrink:0,marginRight:8,size:16}),(0,o.jsx)(E.x,{size:"small",display:"inline-flex",verticalAlign:"middle",weight:400,color:c.Il.Gray70,children:x({id:"The duplicated app will not be shared with the same roles."})})]})]}),[D,x,Z,W,F,U]),eo=(0,_.useMemo)(()=>(0,o.jsxs)(f.s,{align:"center",children:[(0,o.jsx)(d.JO,{flexShrink:0,color:c.Q2.statusSuccessColor,icon:"status-success",height:64,width:64}),(0,o.jsx)(E.x,{size:"default",display:"inline-flex",verticalAlign:"middle",weight:400,marginTop:24,color:c.Q2.primaryTextColor,children:x({id:"Copy of {sourceEntityTitle} created!"},{sourceEntityTitle:n})})]}),[x,n]);(0,_.useEffect)(()=>{Y.current||(j({fullIdentifier:t,componentName:y.jNi,eventName:y.mL4,eventType:"ui_impression",forceLog:!1,additionalTelemetryParams:{embeddedStageEnabled:O,versionedStageEnabled:L}}),Y.current=!0)},[O,j,t,L]);let er=(0,_.useRef)(null),[ea,ei]=(0,_.useState)("auto");(0,_.useEffect)(()=>{er.current&&ei(er.current.scrollHeight)},[$,M]);let el=(0,_.useMemo)(()=>$?{transitionProperty:"height",transitionDuration:"1000ms",transitionTimingFunction:"ease"}:{},[$]);return(0,o.jsxs)(p.Vq,{manuallyShown:!0,onHide:e,causalElement:z,children:[(0,o.jsx)(p.fK,{children:A}),(0,o.jsx)(p.a7,{children:(0,o.jsx)(l.g,{height:ea,...el,ref:er,children:$?eo:M?en:et})}),(0,o.jsxs)(p.cN,{children:[(0,o.jsx)(S.zx,{use:"default",onClick:e,disabled:W,marginRight:8,telemetryComponent:y.jNi,telemetryName:y.c6E,telemetryData:{sourceEntityIdentifier:t,embeddedStageEnabled:O,versionedStageEnabled:L,hasUserChangedTitle:G.current},children:$?x({id:"Close"}):x({id:"Cancel"})}),(0,o.jsx)(S.zx,{use:"primary",onClick:$?ee:X,disabled:!J,inProgress:W,telemetryComponent:y.jNi,telemetryName:$?y.RVD:y.J9z,telemetryData:{sourceEntityIdentifier:t,newEntityIdentifier:null!=$?$:void 0,embeddedStageEnabled:O,versionedStageEnabled:L,hasUserChangedTitle:G.current},children:$?null!=k?k:x({id:"Open app"}):x({id:"Duplicate"})})]})]})});A.displayName="DuplicateFileBasedEntityDialog"},80726:function(e,t,n){n.d(t,{Jf:()=>_,Gk:()=>h,Oz:()=>T,Fx:()=>C,C$:()=>N,XJ:()=>v,xe:()=>R,qL:()=>y});var o,r=n(286204),a=n(821215),i=n(856631),l=n(411733),s=n(175117),u=n.n(s),d=n(847345),c=n(645952),E=n(565763);let f={},p=({epochName:e,callbackFreqMs:t,shouldCleanUpDangledTicker:n=!0})=>{let o=`${e}//${t}`,[r,a]=d.useState(0),i=d.useRef(n);i.current=n;let l=(0,E.t)(),s=d.useCallback(()=>{f[o]&&(f[o].startTimeMs=Date.now()),l.current&&a(0)},[o,l]),u=d.useCallback(()=>{delete f[o],l.current&&a(0)},[o,l]);return d.useEffect(()=>{if(null===t)return;f[o]||(f[o]={startTimeMs:Date.now(),callbacks:new Set,intervalId:void 0});let e=()=>a(Date.now()-f[o].startTimeMs);return e(),f[o].callbacks.add(e),f[o].intervalId||(f[o].intervalId=setInterval(()=>{f[o].callbacks.forEach(e=>e())},t)),()=>{f[o].callbacks.delete(e),0===f[o].callbacks.size&&(clearInterval(f[o].intervalId),i.current?u():f[o].intervalId=void 0)}},[t,u,o,l]),{elapsedTimeMs:r,reset:s}};var S=n(420174),g=n(981713),_=((o={}).initializingMessage="initializingMessage",o.startingComputePoolMessage="startingComputePoolMessage",o.startingContainerServiceMessage="startingContainerServiceMessage",o.connectingServiceMessage="connectingServiceMessage",o.waitingEndpointMessage="waitingEndpointMessage",o.waitingEndpointMessageStreamlit="waitingEndpointMessageStreamlit",o.runningAppMessage="runningAppMessage",o.runningAppMessageStreamlit="runningAppMessageStreamlit",o.fullComputePoolMessage="fullComputePoolMessage",o.insufficientCapacityErrorMessage="insufficientCapacityErrorMessage",o.generalContainerClientErrorMessage="generalContainerClientErrorMessage",o.unreachableContainerErrorMessage="unreachableContainerErrorMessage",o.generalContainerRunErrorMessage="generalContainerRunErrorMessage",o.reusingExistingServiceMessage="reusingExistingServiceMessage",o.oomWarehouseErrorMessage="oomWarehouseErrorMessage",o.generalWarehouseErrorMessage="generalWarehouseErrorMessage",o.oomContainerErrorMessageWithLink="oomContainerErrorMessageWithLink",o.oomContainerErrorMessageWithoutLink="oomContainerErrorMessageWithoutLink",o);let h=e=>{if(!e)return;let t=e.name;if(!(t in _))throw Error(`Unknown FormattedMessageSupplier key: ${t}`);return t},m=(e,t,n)=>({initializingMessage:()=>(0,r.jsx)(c.Z,{id:"Initializing connection and scanning existing service…"}),startingComputePoolMessage:e=>(null==e?void 0:e.duration)?(0,r.jsx)(c.Z,{id:"{duration} \xb7 Starting compute pool. This can take 3–5 minutes…",values:e}):(0,r.jsx)(c.Z,{id:"Starting compute pool. This can take 3–5 minutes…"}),startingContainerServiceMessage:e=>(null==e?void 0:e.duration)?(0,r.jsx)(c.Z,{id:"{duration} \xb7 Starting container service. This can take 3–5 minutes…",values:e}):(0,r.jsx)(c.Z,{id:"Starting container service. This can take 3–5 minutes…"}),connectingServiceMessage:()=>(0,r.jsx)(c.Z,{id:"Connecting to container service…"}),waitingEndpointMessage:()=>(0,r.jsx)(c.Z,{id:"Waiting for notebook endpoint to be ready…"}),waitingEndpointMessageStreamlit:()=>(0,r.jsx)(c.Z,{id:"Waiting for Streamlit endpoint to be ready…"}),runningAppMessage:()=>(0,r.jsx)(c.Z,{id:"Running notebook application…"}),runningAppMessageStreamlit:()=>(0,r.jsx)(c.Z,{id:"Running Streamlit…"}),fullComputePoolMessage:()=>(0,r.jsx)(c.Z,{id:"Couldn’t start session because compute pool is full. Try a different compute pool or contact your admin."}),insufficientCapacityErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Couldn't start session due to insufficient capacity from cloud provider. Try a different compute pool or try again later."}),generalContainerRunErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Couldn't start session due to an issue with Snowpark Container Services: {errorDetail}",values:t}),unreachableContainerErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Session ended due to unreachable container."}),generalContainerClientErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Encountered error with service connection: {errorDetail}",values:t}),reusingExistingServiceMessage:e=>(null==e?void 0:e.duration)?(0,r.jsx)(c.Z,{id:"{duration} \xb7 Trying to reuse existing service. This can take 1–5 minutes…",values:e}):(0,r.jsx)(c.Z,{id:"Trying to reuse existing service. This can take 1–5 minutes…"}),oomWarehouseErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Notebook session ended due to out of memory issue. Try limiting your dataset or use a Snowpark-optimized warehouse."}),generalWarehouseErrorMessage:()=>(0,r.jsx)(c.Z,{id:"Notebook session ended due to error: {errorDetail}",values:t}),oomContainerErrorMessageWithoutLink:()=>(0,r.jsx)(c.Z,{id:"Your session had to restart due to an out-of-memory error. For more memory, try using a larger compute pool."}),oomContainerErrorMessageWithLink:()=>(0,r.jsx)(c.Z,{id:"Your session had to restart due to an out-of-memory error. For more memory, try using a larger compute pool. <link>Learn more</link>",values:{link:e=>(0,r.jsx)(i.h,{href:null!=n?n:"",external:!0,color:a.lx.reusableLinkDefault,children:e})}})})[e],I={STARTING_COMPUTE_POOL_INFO_STRING:"Compute pool node(s) are being provisioned",STARTING_SERVICE_INFO_STRING:"Waiting to start",FULL_COMPUTE_POOL_ERROR_SUBSTRING:"Notebook service is unschedulable in full compute pool",INSUFFICIENT_RESOURCES_ERROR_SUBSTRING:"Unschedulable due to insufficient",INSUFFICIENT_CAPACITY_ERROR_SUBSTRING:"Compute pool insufficient capacity error",UNREACHABLE_CONTAINER_ERROR_PREFIX:"UNAVAILABLE:",RUNNING_STRING:"Running",OOM_WAREHOUSE_ERROR_SUBSTRING:"Function available memory exhausted"},T=()=>(0,r.jsx)(c.Z,{id:"Packages updated successfully."}),R=(e,t,n)=>{var o,r,a;switch(e.topic){case 1:return m("initializingMessage");case 2:{let t=e.payload?JSON.parse(e.payload):void 0,n=Object.values(null!=(o=null==t?void 0:t.containers)?o:{}).flat().map(e=>e.message);if(n.includes(I.STARTING_COMPUTE_POOL_INFO_STRING))return m("startingComputePoolMessage");return n.includes(I.STARTING_SERVICE_INFO_STRING)||n.includes(I.RUNNING_STRING)||l.cM.warn(`Unrecognized service status message: ${e.payload}`),m("startingContainerServiceMessage")}case 3:return m("connectingServiceMessage");case 4:if(t===S.M.STREAMLIT)return m("waitingEndpointMessageStreamlit");return m("waitingEndpointMessage");case 5:if(t===S.M.STREAMLIT)return m("runningAppMessageStreamlit");return m("runningAppMessage");case 6:{let t=e.payload;if(null==t?void 0:t.includes(I.FULL_COMPUTE_POOL_ERROR_SUBSTRING))return m("fullComputePoolMessage");if((null==t?void 0:t.includes(I.INSUFFICIENT_CAPACITY_ERROR_SUBSTRING))||(null==t?void 0:t.includes(I.INSUFFICIENT_RESOURCES_ERROR_SUBSTRING)))return m("insufficientCapacityErrorMessage");return m("generalContainerRunErrorMessage",{errorDetail:t})}case 7:{let t=n?n("developer-guide/snowpark-container-services/working-with-compute-pool"):void 0;if("OOM_KILLED"===e.errorReason)return m(t?"oomContainerErrorMessageWithLink":"oomContainerErrorMessageWithoutLink",void 0,t);if(null==(r=e.payload)?void 0:r.startsWith(I.UNREACHABLE_CONTAINER_ERROR_PREFIX))return m("unreachableContainerErrorMessage");return m("generalContainerClientErrorMessage",{errorDetail:e.payload})}case 8:return m("reusingExistingServiceMessage");case 101:if(null==(a=e.payload)?void 0:a.includes(I.OOM_WAREHOUSE_ERROR_SUBSTRING))return m("oomWarehouseErrorMessage");return m("generalWarehouseErrorMessage",{errorDetail:e.payload});default:return void l.cM.warn(`Unrecognized lifecycle message topic: ${e.topic}`)}},C=(e,t,n=!1)=>{let o=(null==t?void 0:t.type)==="ReceivedStreamlitLifecycleMsg"?R(t.data,e):void 0,r=h(o),a="startingComputePoolMessage"===r||"startingContainerServiceMessage"===r||"reusingExistingServiceMessage"===r,{elapsedTimeMs:i}=p({epochName:"startingService",callbackFreqMs:a?1e3:null}),l=a?n?(0,g.qv)(i):u().duration(i,"milliseconds").format("h[h] m[m] s[s]",0,{trim:"all"}):void 0;return{displayTextSupplier:o,values:a?{duration:l}:void 0}},y=(e,t,n=!1)=>{let{displayTextSupplier:o,values:r}=C(e,t,n);return null==o?void 0:o(r)},v=e=>(null==e?void 0:e.length)?e.map(e=>e.error).join("\n"):null,N=e=>(null==e?void 0:e.length)?e.map(e=>e.message).join("\n"):null},65150:function(e,t,n){n.d(t,{a$:()=>a,fs:()=>l,gE:()=>i,gK:()=>s,tZ:()=>o,yN:()=>r});let o="ui_click",r="ui_visit",a="ui_impression",i="ui_keyboard",l="ui_response_success",s="ui_response_error"},522878:function(e,t,n){n.d(t,{J:()=>a});var o=n(80127),r=n(700577);function a(){let e=r.i.UI_ENABLE_NOTEBOOK_FEATURE_33();return o.v.addFeatureFlagEvaluation("EnableRunWhileCacheLoading",e),e}},916394:function(e,t,n){n.d(t,{S:()=>l});var o=n(847345),r=n(550891),a=n(415422);let i=r.H.cacheFiller;function l(e,t){let n=(0,a.q)(e,(e,t,n)=>{i.debug("New Start Document Cache Load Effect"),e.registerHandler(t.docCacheHandler)}),r=(0,a.q)(e,(e,t,n)=>{i.debug("New End Document Cache Load Effect"),e.unregisterHandler(t.docCacheHandler)}),l=(0,a.q)(e,(e,n,o)=>{i.debug("New Fetch Cache Results called");let r=n.cellIds.map(e=>({cellId:e})),a=0;e.connection.isConnected()&&r&&r.length>0&&(a=1e3*t,e.registerHandler(n.messageHandler),e.sendMessage({previousResults:{warmStart:!1,cellIds:r,allowResultsAfterStart:!0}})),setTimeout(()=>{i.debug("Cells Timedout",{cellIds:n.cellIds}),n.messageHandler.onCancel(n.cellIds,"Timeout")},a)}),s=(0,a.q)(e,(e,t,n)=>{i.debug("New Fetch Cache Results DONE called"),e.unregisterHandler(t.messageHandler)});return(0,o.useMemo)(()=>({newStartDocumentCachedLoad:n,newEndDocumentCachedLoad:r,newFetchCachedResults:l,newFetchCachedResultsDone:s}),[r,l,s,n])}},697056:function(e,t,n){n.d(t,{j:()=>i});var o=n(550891),r=n(53722);let a=o.H.cacheFiller,i={NEW_START_DOCUMENT_CACHE_LOAD:function(e,t,n){if(a.debug("NEW_START_DOCUMENT_CACHE_LOAD",{cacheLoadId:t.cacheLoadId}),"pending"===e.cacheStatus)return void a.reportError("unexpected_nested_document_cache_start","Should not get a start documnet cache load in pending",{action:t});e.cacheLoadId=t.cacheLoadId,e.cacheStatus="pending";let{id:o,role:r,secondaryRoles:i}=t;n({type:"newStartDocumentCachedLoad",id:o,role:r,secondaryRoles:i,docCacheHandler:t.docCacheHandler,pageMode:t.pageMode}),e.cacheLoadId=t.cacheLoadId,e.cacheStatus="pending"},NEW_END_DOCUMENT_CACHE_LOAD:function(e,t,n){if(a.debug("NEW_END_DOCUMENT_CACHE_LOAD"),null==t.cacheLoadId||e.cacheLoadId===t.cacheLoadId){e.cacheLoadId=void 0;let o=e.cacheStatus;a.assertOrReport("pending"===e.cacheStatus||"loaded"===e.cacheStatus,"end_document_cache_load_without_pending_cache_status","Running a cache load batch with the cacheStatus in a non-pending state",{cacheStatus:o,cacheLoadId:t.cacheLoadId}),"error"!==o&&(e.cacheStatus="loaded");let{id:r,role:i,secondaryRoles:l}=t;n({type:"newEndDocumentCachedLoad",id:r,role:i,secondaryRoles:l,pageMode:t.pageMode,docCacheHandler:t.docCacheHandler})}},NEW_START_FETCHING_CACHED_RESULT:function(e,t,n){let{id:o,role:r,secondaryRoles:i,cellIds:l}=t;a.debug("NEW_START_FETCHING_CACHED_RESULT",{cellIds:l}),(null==t.cacheLoadId||e.cacheLoadId===t.cacheLoadId)&&l&&l.length>0&&(a.assertOrReport("pending"===e.cacheStatus||"loaded"===e.cacheStatus,"active_batch_without_pending_cache_status","Running a cache load batch with the cacheStatus in a non-pending state",{cacheStatus:e.cacheStatus,cellIds:l,cacheLoadId:t.cacheLoadId}),"pending"!==e.cacheStatus&&"loaded"!==e.cacheStatus?t.messageHandler.onCancel(l,"RunAlreadyHappened"):n({type:"newFetchCachedResults",id:o,role:r,secondaryRoles:i,cellIds:t.cellIds,messageHandler:t.messageHandler,pageMode:t.pageMode,cacheLoadId:t.cacheLoadId}))},NEW_END_FETCHING_CACHED_RESULT:function(e,t,n){let{id:o,role:r,secondaryRoles:i}=t;a.debug("NEW_END_FETCHING_CACHED_RESULT"),n({type:"newFetchCachedResultsDone",id:o,role:r,secondaryRoles:i,messageHandler:t.messageHandler,pageMode:t.pageMode})},NEW_SET_CACHE_RESULTS:function(e,t,n){a.debug("NEW_SET_CACHE_RESULTS",{cellId:t.cellId});let o=e.notebookState;if(!o)return void a.error("No Notebook state when setting cache results");if(null==t.cacheLoadId||e.cacheLoadId===t.cacheLoadId){var i;let{cellId:n,messages:l}=t;a.debug("Updating cache state for cell",{cellId:n});let s=null==(i=e.notebookState)?void 0:i.getCellById(n);if(null==s||"neverRun"!==s.result.status.cellRunStatus)return void a.error("Cell is already updated before the cache result, so ignoring the cache result");if("pending"===e.cacheStatus||"loaded"===e.cacheStatus){let i=o.updateCellResult(n,{message:l});if(null!=t.cellCacheMetadata&&(a.debug("Cell has cellCacheMetadata",{cellId:n,cellCacheMetadata:t.cellCacheMetadata}),i=i.updateCellResult(n,{selfContentHash:t.cellCacheMetadata.selfContentHash,fullContentHash:t.cellCacheMetadata.fullContentHash,runId:t.cellCacheMetadata.runId,parentExecutionId:t.cellCacheMetadata.parentExecutionId,executionId:t.cellCacheMetadata.executionId,tempSelfContentHash:void 0,tempFullContentHash:void 0,tempRunId:void 0,tempParentExecutionId:void 0,tempExecutionId:void 0})),t.queryId){let o=t.messages.some(e=>(0,r.G)(e));e.notebookState=i.updateCellStatus(n,{cellRunStatus:o?"error":"success"})}else e.notebookState=i.updateCellStatus(n,{cellRunStatus:"idle"});a.debug("Updated cache state for cell",{cellId:n})}else a.reportError("active_batch_without_pending_cache_status","Running a cache load batch with the cacheStatus in a non-pending state",{cacheStatus:e.cacheStatus,cellId:n,cacheLoadId:t.cacheLoadId})}}}},708287:function(e,t,n){n.d(t,{W:()=>I});var o=n(286204),r=n(847345),a=n(797325),i=n(38362),l=n(620400),s=n(306148),u=n(700577),d=n(960058),c=n(343983),E=n(583700),f=n(852871),p=n(62678);let S=({sourceNotebookId:e,sessionSettings:t})=>{let n=u.i.UI_ENABLE_NOTEBOOKS_WH_PYTHON_ENVIRONMENT(),o=!!(0,p.C)(e),a=(0,r.useCallback)(e=>{var r,a,i,l;let s=(null!=(r=null==t?void 0:t.runtimeName)?r:e.runtimeName)||E.U;return{runtimeName:s,queryWarehouse:(null!=(a=null==t?void 0:t.queryWarehouse)?a:e.queryWarehouse)||void 0,warehouse:(null!=(i=null==t?void 0:t.codeWarehouse)?i:e.codeWarehouse)||void 0,...(0,c.V)(n&&!o&&(!!e.runtimeEnvironmentVersion||!!(null==t?void 0:t.runtimeEnvironmentVersion)),{runtimeEnvironmentVersion:(null==t?void 0:t.runtimeEnvironmentVersion)||e.runtimeEnvironmentVersion||void 0}),computePool:s===E.U?void 0:(null!=(l=null==t?void 0:t.computePool)?l:e.computePool)||void 0}},[n,o,t]),{sourceEntityDetails:i,duplicate:l,readyForDuplication:s}=(0,d.z)(e),S=(0,r.useCallback)(async e=>{var t,n;let o=null!=(n=null==e?void 0:e.newEntityName)?n:`Copy of ${null!=(t=null==i?void 0:i.name)?t:""}`,r=(0,f._t)(o);return await l({newEntityName:r,getAdditionalProps:a})},[l,null==i?void 0:i.name,a]);return{sourceNotebookDetails:i,duplicate:S,readyForDuplication:s}};var g=n(754198),_=n(742935),h=n(310887),m=n(53760);let I=r.memo(({hideLayer:e,sourceFullNotebookIdentifier:t,urlData:n,sessionSettings:u})=>{var d;let{formatMessage:c}=(0,a.Z)(),{sourceNotebookDetails:E,duplicate:f,readyForDuplication:p}=S({sourceNotebookId:t,sessionSettings:u}),{pageMode:I}=(0,g.T2)(),T=(0,r.useCallback)(e=>{i.k.navigate({region:n.region,org:n.org,entityIdStr:(0,l.m)(e)})},[n.org,n.region]),R=(0,r.useCallback)(e=>{let t=(0,m.V)(e);return(0,_.t)(t,c)},[c]),C=(0,r.useMemo)(()=>({notebookRuntime:(0,h.e)((null==u?void 0:u.runtimeName)||(null==E?void 0:E.runtimeName)),pageMode:I}),[null==E?void 0:E.runtimeName,null==u?void 0:u.runtimeName,I]);return(0,o.jsx)(s.j,{hideLayer:e,sourceEntityIdentifier:t,sourceEntityTitle:null!=(d=null==E?void 0:E.name)?d:"",dialogTitle:c({id:"Duplicate Notebook"}),openNewEntityButtonText:c({id:"Open notebook"}),readyForDuplication:p,duplicate:f,navigateToNewEntity:T,validateName:R,additionalTelemetryParams:C})});I.displayName="DuplicateNotebookDialog"},980142:function(e,t,n){n.d(t,{z:()=>_});var o=n(286204),r=n(70734),a=n(60575),i=n(173624),l=n(493076),s=n(314040),u=n(90373),d=n(529909),c=n(847345),E=n(645952),f=n(800840),p=n(360688),S=n(420174),g=n(940936);let _=({hide:e,fullNotebookIdentifier:t})=>{var n,d;let _=(0,c.useRef)(null),m=(0,f.fo)(),I=m.useGetSkippableNoThrow(t,p.Y.describe),T=(null==I||null==(d=I.result)||null==(n=d.columns[0])?void 0:n.externalAccessIntegrations)||[],[R,C]=m.useHydratedListNoThrow(S.M.EXTERNAL_ACCESS_INTEGRATION,p.Y.show,void 0);if(null==R||(0,g.M)(C)||(0,g.M)(I))return(0,o.jsx)(h,{});let y={};for(let e of R)y[e.name]=e;let v=T.filter(e=>{var t;return!(null==(t=y[e])?void 0:t.enabled)});return(0,o.jsxs)(r.Vq,{manuallyShown:!0,onHide:e,causalElement:_,children:[(0,o.jsx)(r.fK,{children:(0,o.jsx)(E.Z,{id:"Can't start Notebook"})}),(0,o.jsxs)(r.a7,{children:[(0,o.jsx)(a.n,{marginBottom:24,children:(0,o.jsx)(i.x,{color:l.Q2.secondaryTextColor,children:(0,o.jsx)(E.Z,{id:"There was a problem attaching one or more external access integrations to this notebook:"})})}),(0,o.jsx)("ul",{children:v.map(e=>(0,o.jsx)("li",{children:e},e))})]}),(0,o.jsx)(r.cN,{children:(0,o.jsxs)(s.g,{children:[(0,o.jsx)(u.zx,{onClick:e,children:(0,o.jsx)(E.Z,{id:"Close"})}),(0,o.jsx)(u.zx,{use:"primary",onClick:async function(){await m.alter(t,{externalAccessIntegrations:T.filter(e=>!v.includes(e))}),e()},marginLeft:8,children:(0,o.jsx)(E.Z,{id:"Remove unavailable integrations"})})]})})]})};function h(){let e=(0,c.useRef)(null);return(0,o.jsxs)(r.Vq,{manuallyShown:!0,causalElement:e,children:[(0,o.jsx)(r.fK,{}),(0,o.jsx)(r.a7,{display:"flex",justifyContent:"center",alignItems:"center",children:(0,o.jsx)(d.T,{})}),(0,o.jsx)(r.cN,{})]})}_.displayName="NotebookExternalAccessIntegrationErrorDialog",h.displayName="LoadingDialog"},925470:function(e,t,n){n.d(t,{T:()=>l,b:()=>i});var o=n(286204),r=n(847345);let a=(0,r.createContext)({triggerDialog:()=>{}}),i=()=>(0,r.useContext)(a);function l({children:e,triggerDialog:t}){let n=(0,r.useMemo)(()=>({triggerDialog:t}),[t]);return(0,o.jsx)(a.Provider,{value:n,children:e})}l.displayName="NotebookPaneShowDialogProvider"},177302:function(e,t,n){n.d(t,{k:()=>c});var o=n(700577),r=n(847345),a=n(640579),i=n(255490),l=n(190279),s=n(800840),u=n(134445),d=n(182699);let c=()=>{let{dataDiscoverRole:e,secondaryRoles:t}=(0,a.j)(),n=(0,s.fo)(e,{secondaryRoles:t}),{user:c}=(0,u.m)(["user"]),E=(0,i.U)();return(0,r.useCallback)(async({notebookId:r,sessionSettings:a,pageMode:i})=>{var s;let u=await E(r,e,t),f=c.api.query((0,l.HS)({notebookUrlId:u.urlId,sessionSettingsData:JSON.stringify(a)}),{role:e,secondaryRoles:t,isInternal:!0,desc:"save-notebook-session-settings"}),p="ownerMode"===i?{queryWarehouse:a.queryWarehouse&&a.queryWarehouse!==u.queryWarehouse?a.queryWarehouse:void 0,warehouse:a.codeWarehouse&&a.codeWarehouse!==u.codeWarehouse?a.codeWarehouse:void 0,runtimeName:a.runtimeName&&a.runtimeName!==u.runtimeName?a.runtimeName:void 0,computePool:a.computePool&&a.computePool!==u.computePool?a.computePool:void 0,runtimeEnvironmentVersion:a.runtimeEnvironmentVersion&&a.runtimeEnvironmentVersion.toLowerCase()!==(null==(s=u.runtimeEnvironmentVersion)?void 0:s.toLowerCase())?a.runtimeEnvironmentVersion:void 0,idleAutoShutdownTimeSeconds:a.idleAutoShutdownTimeSeconds&&a.idleAutoShutdownTimeSeconds!==u.idleAutoShutdownTimeSeconds?a.idleAutoShutdownTimeSeconds:void 0,externalAccessIntegrations:a.externalAccessIntegrations&&!(0,d.W)(a.externalAccessIntegrations||[],u.externalAccessIntegrations||[])?a.externalAccessIntegrations:void 0}:{},S=Object.keys(p).some(e=>!!p[e])&&!o.i._DP_UI_NOTEBOOK_UNWIND_SHARING_DPO_SAVE()?n.alter(r,p):Promise.resolve();await Promise.all([f,S])},[e,t,c,E,n])}},481263:function(e,t,n){n.d(t,{S:()=>l});var o=n(286204),r=n(70734),a=n(90373),i=n(645952);let l=({hide:e,restart:t})=>(0,o.jsxs)(r.Vq,{manuallyShown:!0,causalElement:{current:null},children:[(0,o.jsx)(r.fK,{children:(0,o.jsx)(i.Z,{id:"Restart required"})}),(0,o.jsx)(r.a7,{children:(0,o.jsx)(i.Z,{id:"Due to a conflict with updated packages, a session restart is required. This will reset any variables you might have created."})}),(0,o.jsxs)(r.cN,{children:[(0,o.jsx)(a.zx,{onClick:e,children:(0,o.jsx)(i.Z,{id:"Not now"})}),(0,o.jsx)(a.zx,{use:"primary",marginLeft:8,onClick:()=>{try{t()}finally{e()}},children:(0,o.jsx)(i.Z,{id:"Restart session"})})]})]});l.displayName="PackageUpdateAlertDialog"},691352:function(e,t,n){n.d(t,{e:()=>a});var o=n(184547),r=n(304241);function a(e){let t=(0,r.h)(e),n=e===o.GF,a=e===o.rJ;return t||n||a}},298448:function(e,t,n){n.d(t,{E:()=>d,U:()=>u});var o=n(286204),r=n(792851),a=n(847345);let[i,l]=(0,r.Z)(function(){let[e,t]=(0,a.useState)(null),n=(0,a.useCallback)(e=>{t(e)},[]),o=(0,a.useCallback)(()=>{t(null)},[]);return(0,a.useMemo)(()=>({openDialog:n,dialog:e,hideDialog:o}),[n,e,o])});function s(){let{dialog:e}=l();return(0,o.jsx)(o.Fragment,{children:e})}function u({children:e}){return(0,o.jsxs)(i,{children:[(0,o.jsx)(s,{}),e]})}function d(){let{openDialog:e,hideDialog:t}=l();return{openDialog:e,hideDialog:t}}s.displayName="Dialog",u.displayName="NotebookDialogProvider"},896909:function(e,t,n){n.d(t,{$:()=>o});let o=4},12935:function(e,t,n){n.d(t,{K7:()=>a,Q8:()=>r,hj:()=>o});let o=604800,r=15,a=3600},547709:function(e,t,n){n.d(t,{L:()=>_});var o=n(463198),r=n(700577),a=n(797325),i=n(640579),l=n(443547),s=n(255490),u=n(499273),d=n(126020),c=n(799787),E=n(606765),f=n(620400),p=n(27702),S=n(216591);let g=()=>{let e=(0,p.KP)(),t=(0,S.N)();return(0,o.z)(async n=>{try{return await e(n)}catch(e){if(e.message.match(/failed paddingTrim/iu))return console.error(e),t.logError({notebookIdentifier:(0,f.m)(n.id),error:"failed paddingTrim"}),Promise.resolve("");throw e}})},_=()=>{let e=(0,s.U)(),t=(0,u.h)(),n=(0,d.iA)(),f=g(),{formatMessage:p}=(0,a.Z)(),S=r.i.UI_ENABLE_NOTEBOOK_FEATURE_0(),{dataDiscoverRole:_}=(0,i.j)(),[h]=(0,E.zv)();return(0,o.z)(async(o,r,a)=>{let[i,s]=await Promise.all([e(o,r,a),h({applicationName:o.database,role:_})]),{mainFile:u,lastVersionLocationUri:d}=i,{rootLocation:E,kind:g,isLive:m}=(0,l.R)(i);if(!s.isError&&!0===s.data)return f({id:o,rootLocation:d,mainFile:u,throwRawError:S});if("checkouts"===g)return await t({id:o,role:r,secondaryRoles:a}),f({id:o,rootLocation:E,mainFile:u,throwRawError:S});if("versioned"===g){if(m)return f({id:o,rootLocation:E,mainFile:u,throwRawError:S});let e=await n({id:o,role:r,secondaryRoles:a});return f({id:o,rootLocation:(0,c.h)(e.liveVersionLocationUri,p({id:"Live version could not be created."})),mainFile:u,throwRawError:S})}throw Error(p({id:"Could not fetch notebook. Invalid or unsupported notebook location."}))})}},457632:function(e,t,n){n.d(t,{l:()=>c});var o=n(700577),r=n(847345),a=n(640579),i=n(583700),l=n(134445),s=n(691352),u=n(7163),d=n(913984);let c=()=>{let{dataDiscoverRole:e,secondaryRoles:t}=(0,a.j)(),n=(0,l.m)([]).untracked.user,c=o.i.UI_ENABLE_NOTEBOOK_DISABLED_SPCS_EXPERIENCE_FOR_ADMINS(),E=(0,u.U)();return(0,r.useCallback)(async r=>{let a=await E(r,e,t),l=!a.runtimeName||a.runtimeName===i.U,u=(0,s.e)(e);if(c&&!l&&u)return{additionalProtoParams:[],activeInstanceJobId:null,activeNotebookInstancesNum:0,additionalMetadata:{}};let f=(await (0,d.jX)({userStore:n,fullNotebookIdentifier:r,role:e,secondaryRoles:t})).filter(e=>e.isInteractive&&(!e.serviceType||l&&"WAREHOUSE_INSTANCE_TYPE"===e.serviceType||!l&&"SERVICE_INSTANCE_TYPE"===e.serviceType)),p=f.length,S={additionalProtoParams:[],activeInstanceJobId:p>0?f[0].serviceId:null,activeNotebookInstancesNum:p,additionalMetadata:{}};return p>0&&(!l||o.i._DP_UI_NOTEBOOK_GET_STREAMLIT_VERSION_FOR_WH_ACTIVE_INSTANCE())&&(S.additionalMetadata.streamlitVersionOfAlreadyRunningInstance=f[0].streamlitVersion),l&&(S.additionalProtoParams.push("reconnectEnabled"),p>0&&S.additionalProtoParams.push(`reconnect-job-${f[0].serviceId}`)),S},[e,t,n,E,c])}},446282:function(e,t,n){n.d(t,{M:()=>h});var o=n(700577),r=n(847345),a=n(134445),i=n(266046),l=n(468804),s=n(65150),u=n(329322),d=n(159771);let c=e=>new u.L().add("CALL SYSTEM$LIST_RUNNING_NOTEBOOK_INSTANCES(?)",(0,d.M)(e)).toQuery(),E=e=>{let[[t]]=e.rows;return JSON.parse(t)},f=async(e,t)=>{let{fullNotebookIdentifier:n,role:o,secondaryRoles:r}=t,a=c(n);return E(await e.api.query(a,{role:o,secondaryRoles:r,isInternal:!0,desc:"system-list-running-notebook-instance"}))};var p=n(913984);async function S({deleteAllRunningNotebookInstances:e,userStore:t,id:n,role:o,secondaryRoles:r,logNotebookEvent:a}){try{let i=await g({userStore:t,id:n,role:o,secondaryRoles:r,logNotebookEvent:a});e||(i=i.slice(0,1)),i.length>0&&(await Promise.all(i.map(e=>(0,p.Dy)(t,{fullNotebookIdentifier:n,role:o,secondaryRoles:r,serviceIdentifier:e}))),a({notebookId:n,event:l.fA1,eventType:s.fs,eventData:{},pageMode:"ownerMode"}))}catch(t){let e=`SPCS Notebooks: Failed to delete notebook instance. ${t}`;(0,i.k)(e,{fullNotebookIdentifier:n}),a({notebookId:n,event:l.XTd,eventType:s.gK,eventData:{error:e},pageMode:"ownerMode"})}}async function g({userStore:e,id:t,role:n,secondaryRoles:o,logNotebookEvent:r}){let a=(await f(e,{fullNotebookIdentifier:t,role:n,secondaryRoles:o})).filter(e=>e.isInteractive&&e.serviceId).map(e=>e.serviceId);return 0===a.length?((0,i.k)("SPCS Notebooks: No running service instance ID found",{fullNotebookIdentifier:t}),r({notebookId:t,event:l.phx,eventType:s.gK,eventData:{},pageMode:null}),[]):(a.length>1&&((0,i.k)("SPCS Notebooks: Found multiple running service instance IDs for interactive notebook.",{fullNotebookIdentifier:t}),r({notebookId:t,event:l.SKU,eventType:s.gK,eventData:{},pageMode:null})),a)}var _=n(216591);function h(){let{user:e}=(0,a.m)(["user"]),t=(0,_.N)(),n=o.i.UI_ENABLE_NOTEBOOK_FEATURE_44();return(0,r.useCallback)(async({id:o,role:r,secondaryRoles:a})=>await S({deleteAllRunningNotebookInstances:n,userStore:e,id:o,role:r,secondaryRoles:a,logNotebookEvent:t.logNotebookEvent}),[n,e,t.logNotebookEvent])}},45186:function(e,t,n){n.d(t,{P:()=>i});var o=n(847345),r=n(190279),a=n(134445);let i=()=>{let{user:e}=(0,a.m)(["user"]);return(0,o.useCallback)(async({id:t,queryId:n,role:o,secondaryRoles:a,isHistoryQueryResultEnabled:i})=>(await e.api.query((0,r.Zl)({fullNotebookIdentifier:t,queryId:i?n:void 0}),{isInternal:!0,role:o,secondaryRoles:a,desc:"generate-notebook-token"})).rows[0][0],[e.api])}},188081:function(e,t,n){n.d(t,{W:()=>i});var o=n(847345),r=n(190279),a=n(134445);let i=()=>{let{user:e}=(0,a.m)(["user"]);return(0,o.useCallback)(async({id:t,role:n,secondaryRoles:o,isPrivatelink:a})=>{let i=await e.api.query((0,r.eO)({fullNotebookIdentifier:t,isAccountUsingPrivateLink:a}),(0,r.wZ)(n,o));return(0,r.Te)(i.rows[0][0])},[e.api])}},479777:function(e,t,n){n.d(t,{X:()=>l,n:()=>s});var o=n(847345),r=n(420174),a=n(524225);let i=o.createContext(""),l=i.Provider,s=e=>{let t=(0,o.useContext)(i);return(0,o.useMemo)(()=>(0,a.J)(e||t,r.M.NOTEBOOK),[e,t])}},62678:function(e,t,n){n.d(t,{C:()=>d});var o=n(700577),r=n(51802),a=n(800840),i=n(583700),l=n(360688),s=n(940936),u=n(902960);function d(e){var t,n,d,c,E;let f=(0,a.fo)(),p=o.i.UI_ENABLE_NOTEBOOK_FEATURE_40(),S=(0,r.$)(),{editorState:g}=(0,u.P)();if(S)return!1;if(!p){let t=f.get(e,l.Y.describe);if((0,s.M)(t))return null;let n=null==t||null==(E=t.result)?void 0:E.columns[0];return!!(null==n?void 0:n.runtimeName)&&n.runtimeName!==i.U}return(null==g?void 0:g.notebookRuntime)==="spcs"||!!(null==g||null==(n=g.notebookSessionSettingsState)||null==(t=n.settings)?void 0:t.runtimeName)&&(null==g||null==(c=g.notebookSessionSettingsState)||null==(d=c.settings)?void 0:d.runtimeName)!=="SYSTEM$WAREHOUSE_RUNTIME"}},45103:function(e,t,n){n.d(t,{w:()=>r});var o=n(700577);function r(){return o.i.UI_ENABLE_NOTEBOOK_SINGLE_IFRAME()}},902960:function(e,t,n){n.d(t,{P:()=>u});var o=n(847345),r=n(640579),a=n(672340),i=n(226309),l=n(479777),s=n(754198);function u(){var e,t;let{dataDiscoverRole:n,secondaryRoles:u}=(0,r.j)(),d=(0,l.n)(),{pageMode:c,pageModeDetails:E}=(0,s.T2)(),{getNotebookEditorState:f,dispatchNotebookEditorStatesMap:p,connectToWebSocket:S,disconnectWebsocket:g,subscribe:_,setHeartbeatPollEndTimeUpdateCallback:h,getWebsocketConnection:m}=(0,i.PW)(),{childFrame:I}=(0,a.KE)()||{},T=(0,o.useCallback)(e=>{var t,o;if(null==I||null==(t=I.snowbooks)?void 0:t.dispatchNotebookEditorState){let t=Object.fromEntries(Object.entries(e).filter(([e,t])=>"function"!=typeof t));I.snowbooks.dispatchNotebookEditorState(t)}else p({id:d,role:n,secondaryRoles:u,queryId:null==E||null==(o=E.historyQueryData)?void 0:o.queryId,pageMode:c,...e})},[p,null==E||null==(e=E.historyQueryData)?void 0:e.queryId,d,n,u,I,c]);return{editorState:f(d,n,u),dispatchNotebookEditorState:T,disconnectWebsocket:(0,o.useCallback)(e=>g(d,n,u,e),[g,d,n,u]),connectToWebSocket:(0,o.useCallback)(e=>{var t;return S({id:d,role:n,secondaryRoles:u,pageMode:c,urlInfo:e,queryId:null==E||null==(t=E.historyQueryData)?void 0:t.queryId})},[S,null==E||null==(t=E.historyQueryData)?void 0:t.queryId,d,n,u,c]),subscribe:_,setHeartbeatPollEndTimeUpdateCallback:h,getWebsocketConnection:(0,o.useCallback)(()=>m(d,n,u),[m,d,n,u])}}},307239:function(e,t,n){n.d(t,{U:()=>s});var o=n(847345),r=n(640579),a=n(664983),i=n(190279),l=n(414710);function s(){let e="get-notebook-history-file-url",{dataDiscoverRole:t,secondaryRoles:n}=(0,r.j)(),{executeQuery:s}=(0,l.U)(t,n,""),{fetchId:u}=(0,a.m)(e);return(0,o.useCallback)(async({notebookId:t,historyQueryId:n})=>{var o,r;let a=(0,i.zd)({fullNotebookIdentifier:t,queryId:n}),{tableData:l}=await s(a,e,u,!0);if(null==(r=l.rows)||null==(o=r[0])?void 0:o[0]){let e=JSON.parse(l.rows[0][0]);if(e.content)return e.content}return""},[e,s,u])}},754198:function(e,t,n){n.d(t,{T2:()=>i,rB:()=>a});var o=n(847345);let r=(0,o.createContext)({pageMode:null,pageModeDetails:null,ownerRole:""}),a=r.Provider,i=()=>(0,o.useContext)(r)},216591:function(e,t,n){n.d(t,{N:()=>I});var o=n(928874),r=n(847345),a=n(620400),i=n(75065),l=n(80127),s=n(403771),u=n(338291),d=n(739716),c=n(468804),E=n(194838),f=n(520669),p=n(45103);let S="ui_response_success",g="ui_response_error",_="ui_click",h="ui_visit",m=new Set([c.AzE,c.K5H,c.Uzq,c.RSw,c.y10,c.ua8,c.MSS,c.ImF,c.lWk,c.zrf,c.d0B,c.Mhg,c.zGh,c.iJ8,c.UcJ,c.xAk,c.Ht5,c.vwS,c.wi4,c.dJY,c.MKg,c._KU,c.Hn4,c.YeT,c.foX,c.aDE,c.QuQ,c.z_f,c.yzn,c.F1$,c.AK5,c.Ari,c.ZOT,c.$aC,c.DsD,c.mBO,c.FXf,c.w08,c.G0u,c.ru7,c.kDJ,c.NJ3,c.rxA,c.BdL,c.ZL3,c.$V2,c.hPp,c.nJK]);function I(){let{logEventToSnowflakeAndDatadog:e,markEventStart:t,measureEventDuration:n,markE2EEventStart:I,isMarkerSet:T,_getDurationsFromMarker:R}=(0,s.z)(),{logEvent:C}=(0,o.f1)(),y=(0,d.d)(),v=(0,p.w)(),N=(0,r.useCallback)(t=>{t.data={...t.data,isPrivateLink:y(),isSingleFrame:v},m.has(t.event)&&i.A.isDisallowedDatadogEvent(t)?e(t):C(t)},[y,e,C,v]),A=(0,r.useCallback)(e=>{var t;N({event:c.ImF,type:"ui_performance",data:{...e,notebookRuntime:null!=(t=e.notebookRuntime)?t:"unknown"}})},[N]),b=(0,r.useCallback)((e,t)=>{var n,o;let r=t?R(t):{};N({event:c.lWk,type:S,data:{...e,...r,notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown",sourceType:null!=(o=e.sourceType)?o:"unknown"}})},[N,R]),O=(0,r.useCallback)((e,t)=>{var n,o;let r=t?R(t):{};N({event:c.zrf,type:g,data:{...e,...r,notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown",sourceType:null!=(o=e.sourceType)?o:"unknown"}})},[N,R]),L=(0,r.useCallback)((e,t)=>{var n;let o=t?R(t):{};N({event:c.ua8,type:S,data:{...e,...o,notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown"}})},[N,R]),k=(0,r.useCallback)((e,t)=>{var n;let o=t?R(t):{};N({event:c.MSS,type:g,data:{...e,...o,notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown"}})},[N,R]),w=(0,r.useCallback)((e,t)=>{var n;let o=t?R(t):{};N({event:c.AzE,type:h,data:{...e,...o,notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown"}})},[N,R]),M=(0,r.useCallback)(e=>{N({event:c.G$y,type:g,data:e})},[N]),D=(0,r.useCallback)((e,t,n,o)=>{let r=o?R(o):{};N({event:t,type:_,data:{...n,...r,notebookIdentifier:(0,a.m)(e)}})},[N,R]),U=(0,r.useCallback)((e,t,n,o,r)=>{let i=r?R(r):{};t===c.Hn4&&(i.e2eDurationMs=(r?R({...r,event:E.QX,isUserE2E:!0}):{}).e2eDurationMs),N({event:t,type:o?"ui_response_success":"ui_response_error",data:{...n,...i,notebookIdentifier:(0,a.m)(e)}})},[N,R]),P=(0,r.useCallback)((e,t,n)=>{let o=n?R(n):{};N({event:c.Mhg,type:S,data:{...t,...o,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N,R]),x=(0,r.useCallback)((e,t)=>{N({event:c.zGh,type:S,data:{...t,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N]),F=(0,r.useCallback)((e,t)=>{N({event:c.QtC,type:S,data:{...t,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N]),B=(0,r.useCallback)((e,t,n)=>{let o=n?R(n):{},r=(0,f.ne)(t.reason);N({event:r?c.YeT:c.iJ8,type:r?g:S,data:{...t,...o,error:t.error?t.error:r?t.reason:void 0,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N,R]),G=(0,r.useCallback)((e,t,n)=>{let o=n?R(n):{},r={...t,...o,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)};N({event:c.d0B,type:h,data:r}),t.isReconnect&&N({event:c.foX,type:h,data:r})},[N,R]),V=(0,r.useCallback)((e,t,n)=>{let o=n?R(n):{};N({event:c.xAk,type:h,data:{...t,...o,notebookIdentifier:(0,a.m)(e)}})},[R,N]),K=(0,r.useCallback)((e,t,n)=>{let o=n?R(n):{};N({event:c.Ht5,type:h,data:{...t,...o,notebookIdentifier:(0,a.m)(e)}})},[R,N]),W=(0,r.useCallback)((e,t,n)=>{let o=n?R(n):{};N({event:c.vwS,type:h,data:{...t,...o,notebookIdentifier:(0,a.m)(e)}})},[R,N]),H=(0,r.useCallback)((e,t,n)=>{let o=n?R(n):{};N({event:c.UcJ,type:g,data:{...t,...o,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e),isReconnect:!!t.isReconnect}}),t.isReconnect&&N({event:c.YeT,type:g,data:{...t,...o,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N,R]),$=(0,r.useCallback)((e,t)=>{var n;let o=R({event:E.Sc,markers:[(0,a.m)(e),null!=(n=t.connectionId)?n:""]})||{};N({event:c.K5H,type:_,data:{...t,...o,notebookRuntime:t.notebookRuntime,notebookIdentifier:(0,a.m)(e)}})},[R,N]),Q=(0,r.useCallback)((e,n)=>{t(E.Ti,(0,a.m)(e),n.connectionId||""),N({event:c.Uzq,type:_,data:{...n,notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N,t]),j=(0,r.useCallback)((e,t)=>{var n;let o=R({event:E.Ti,markers:[(0,a.m)(e),null!=(n=t.connectionId)?n:""]})||{};N({event:c.y10,type:S,data:{...t,...o,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[R,N]),Y=(0,r.useCallback)((e,t)=>{var n;let o=R({event:E.Ti,markers:[(0,a.m)(e),null!=(n=t.connectionId)?n:""]})||{};N({event:c.RSw,type:g,data:{...t,...o,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[R,N]),z=(0,r.useCallback)((e,t)=>{N({event:c.b0z,type:g,data:{...t,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N]),q=(0,r.useCallback)((e,t)=>{var n;let o=R({event:E.Ff,markers:[(0,a.m)(e),null!=(n=t.connectionId)?n:""]})||{};N({event:t.error?c.YeT:c.aDE,type:t.error?g:S,data:{...t,...o,reconnectDurationMs:o.durationMs,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}}),(null==o?void 0:o.durationMs)&&l.v.addDurationVital(c.qyZ,{startTime:Date.now()-o.durationMs,duration:o.durationMs})},[N,R]),Z=(0,r.useCallback)((e,t,n,o)=>{let r=o?R(o):{};N({event:c.wi4,type:null!=n?n:S,data:{...t,...r,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N,R]),J=(0,r.useCallback)((e,t,n,o)=>{let r=o?R(o):{};N({event:c.wi4,type:null!=n?n:g,data:{...t,...r,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N,R]),X=(0,r.useCallback)((e,t,n,o,r)=>{let i=r?R(r):{};N({event:t,type:o?S:g,data:{...n,...i,notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N,R]),ee=(0,r.useCallback)((e,t,n,o,r)=>{let i=r?R(r):{};N({event:t,type:null!=o?o:S,data:{...n,...i,notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N,R]),et=(0,r.useCallback)(({notebookId:e,event:t,eventData:n,eventType:o,markerInfo:r,pageMode:i})=>{let l=r?R(r):{};N({event:t,type:o,data:{...n,...l,notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e),pageMode:i}})},[N,R]),en=(0,r.useCallback)((e,t,n,o,r)=>{let i=r?R(r):{};N({event:t,type:null!=o?o:S,data:{...n,...i,notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N,R]),eo=(0,r.useCallback)((e,n,o)=>{t(E.nL,(0,a.m)(e),n.connectionId||"");let r={...n,notebookRuntime:n.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)};N({event:c.QuQ,type:_,data:r})},[N,t]),er=(0,r.useCallback)((e,t)=>{var n;let o=R({event:E.nL,markers:[(0,a.m)(e),null!=(n=t.connectionId)?n:""]})||{};N({event:t.error?c.yzn:c.z_f,type:t.error?g:S,data:{...t,...o,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[R,N]),ea=(0,r.useCallback)((e,t)=>{var n;let o=R({event:E.Ff,markers:[(0,a.m)(e),null!=(n=t.connectionId)?n:""]})||{};N({event:c.FXf,type:t.error?g:S,data:{...t,...o,reconnectDurationMs:o.durationMs,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[R,N]),ei=(0,r.useCallback)((e,t)=>{N({event:c.Nr9,type:"ui_impression",data:{...t,notebookRuntime:t.notebookRuntime||"unknown",notebookIdentifier:(0,a.m)(e)}})},[N]),el=(0,r.useCallback)(e=>{var t;N({event:c.rxA,type:S,data:{...e,notebookRuntime:null!=(t=e.notebookRuntime)?t:"unknown"}})},[N]),es=(0,r.useCallback)((e,t)=>{var n;let o=t?R(t):{};N({event:e.error?c.ZL3:c.BdL,type:e.error?g:S,data:{...e,...o,notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown"}})},[N,R]),eu=(0,r.useCallback)(e=>{var t;N({event:c.$V2,type:S,data:{...e,notebookRuntime:null!=(t=e.notebookRuntime)?t:"unknown"}})},[N]),ed=(0,r.useCallback)((e,t)=>{var n;let o=t?R(t):{};N({event:e.error?c.hPp:c.nJK,type:e.error?g:S,data:{...e,...o,notebookRuntime:null!=(n=e.notebookRuntime)?n:"unknown"}})},[N,R]),ec=(0,r.useCallback)((t,n)=>{var o,r;let i=R({event:u.Vm,markers:[(0,a.m)(t)]})||{};e({event:(null==(o=n.error)?void 0:o.errorMessage)?c.gRi:c.vSJ,type:(null==(r=n.error)?void 0:r.errorMessage)?g:S,data:{...i,controlResponse:n}})},[R,e]),eE=(0,r.useCallback)((e,t)=>{N({event:c.Z6m,type:S,data:{notebookIdentifier:(0,a.m)(e),connectionId:t.connectionId}})},[N]),ef=(0,r.useCallback)((e,t)=>{N({event:c.JVZ,type:S,data:{notebookIdentifier:(0,a.m)(e),connectionId:t.connectionId}})},[N]),ep=(0,r.useCallback)((e,t)=>{N({event:c.GO4,type:S,data:{notebookIdentifier:(0,a.m)(e),connectionId:t.connectionId,interactionType:t.interactionType}})},[N]);return(0,r.useMemo)(()=>({logCreateStarted:A,logCreateSuccess:b,logCreateFailed:O,logRenameSuccess:L,logRenameFailed:k,logNotebookEditEvent:en,logOpenDetailPage:w,logError:M,logCellUITelemetry:D,logCellRunTelemetry:U,logWebsocketConnected:P,logWebsocketDisconnected:B,logWebsocketControlMessage:x,logWebsocketStartConnecting:G,logWebsocketHeartbeat:V,logWebsocketHeartbeatStart:K,logWebsocketHeartbeatEnd:W,logWebsocketConnectError:H,logWebsocketConnectionStateChange:F,logSessionReconnectCompleted:q,logSessionEnd:$,logSessionStarting:Q,logSessionStartSuccess:j,logSessionStartFailed:Y,logSessionErrorMessage:z,logKernelRestartBegin:eo,logKernelRestartEnd:er,logRunRequested:Z,logRunRequestedError:J,logRunEvent:X,logIPYNBEvent:ee,markEventStart:t,markE2EEventStart:I,measureEvent:n,isMarkerSet:T,logNotebookEvent:et,logSessionReconnectDetails:ea,logNotebookPackageUpdateAlert:ei,logSharePageLoadStarted:el,logSharePageLoadCompleted:es,logShareStarted:eu,logShareCompleted:ed,logCondaPackageUpdateTelemetry:ec,logResourceMonitorOpened:eE,logResourceMonitorClosed:ef,logResourceMonitorInteraction:ep}),[U,D,A,O,en,b,M,ee,w,k,L,X,Z,J,H,P,x,G,B,F,V,K,W,q,$,Q,j,Y,z,eo,er,t,I,n,T,et,ea,ei,el,es,eu,ed,ec,eE,ef,ep])}},550891:function(e,t,n){n.d(t,{H:()=>a});var o=n(266046);let r={debug:10,info:20,error:30,reportError:40},a={cacheFiller:new class{constructor(e,t){this.debug=(e,t)=>{if(this.logLevel<=r.debug){let n=null!=t?JSON.stringify(t):"";console.debug(this.category+e,n)}},this.error=(e,t)=>{if(this.logLevel<=r.error){let n=null!=t?JSON.stringify(t):"";console.error(this.category+e,n)}},this.info=(e,t)=>{if(this.logLevel<=r.info){let n=null!=t?JSON.stringify(t):"";console.info(this.category+e,n)}},this.reportError=(e,t,n)=>{this.logLevel<=r.reportError&&(0,o.k)(t,{domain:"notebooks",loggingCategory:this.rawCategory,type:e,...n})},this.assertOrReport=(e,t,n,o)=>{e||this.reportError(t,n,o)},this.logLevel=null!=t?t:r.reportError,this.rawCategory=null!=e?e:"NOTEBOOK",this.category="["+this.rawCategory+"] "}}("CACHE_FILLER",r.error)}},672340:function(e,t,n){n.d(t,{KE:()=>l,QI:()=>i,r9:()=>a});var o=n(286204),r=n(847345);let a=(0,r.createContext)(null),i=({children:e,...t})=>{let[n,i]=(0,r.useState)(null),[l,s]=(0,r.useState)(null),[u,d]=(0,r.useState)(t.methods||null),[c,E]=(0,r.useState)(t.iframeSrcProps||null),f=(0,r.useMemo)(()=>({methods:u,childFrame:n,childIframeEl:l,iframeSrcProps:c,setMethods:d,setChildFrame:i,setChildIframeEl:s,setIframeSrcProps:E}),[u,n,l,c]);return(0,o.jsx)(a.Provider,{value:f,children:e})};i.displayName="NotebookIframeProvider";let l=()=>{let e=(0,r.useContext)(a);return e||null}},827335:function(e,t,n){n.d(t,{JM:()=>s,VN:()=>l,ZF:()=>u,k$:()=>d});var o=n(819260),r=n(792851),a=n(330702),i=n(847345);let[l,s,u,d]=(0,r.Z)(function({parentOrigin:e}){let t=(0,i.useRef)(null),n=(0,i.useRef)(null),[r,l]=(0,i.useState)(null),[s,u]=(0,i.useState)(void 0),[d,c]=(0,i.useState)(null);return(0,i.useEffect)(()=>{n.current=d},[d]),(0,i.useEffect)(()=>{null===t.current&&(t.current=(0,a.y1)({parentOrigin:e,methods:{snowbooks:{syncState:e=>{u({...e})},dispatchNotebookEditorState:e=>{var t;null==(t=n.current)||t.call(n,e)}}},debug:!1}),t.current.promise.then(e=>{l(e)}).catch(e=>{o.log.error("[Snowbooks] Error connecting to parent:",e)}))},[e]),(0,i.useEffect)(()=>()=>{var e;null==(e=t.current)||e.destroy(),l(null)},[]),{snowbooksParent:r,snowbooksState:s,setDispatchNotebookEditorState:c}},e=>e.snowbooksParent,e=>e.snowbooksState,e=>e.setDispatchNotebookEditorState)},7163:function(e,t,n){n.d(t,{U:()=>l});var o=n(255490),r=n(827335),a=n(24930);function i(){let e=(0,r.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.describeFileBasedEntity}function l(){return(0,a.U)(o.U,i)()}},316181:function(e,t,n){n.d(t,{L:()=>l});var o=n(547709),r=n(827335),a=n(24930);function i(){let e=(0,r.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.checkoutOrAddVersionAndRead}function l(){return(0,a.U)(o.L,i)()}},152384:function(e,t,n){n.d(t,{HE:()=>i,LU:()=>a});var o=n(819260),r=n(781708);class a{send(e){if(this.readyState===WebSocket.CONNECTING)return void this.messageQueue.push(e.toString());if(this.readyState!==WebSocket.OPEN)throw Error("WebSocket is not open");window.parent.postMessage({type:"NOTEBOOK_IFRAME_WEBSOCKET_SEND",connectionId:this.connectionId,payload:e},this.origin)}close(e,t){this.readyState!==WebSocket.CLOSED&&(this.readyState=WebSocket.CLOSING,window.parent.postMessage({type:"NOTEBOOK_IFRAME_WEBSOCKET_CLOSE",connectionId:this.connectionId,payload:{code:e,reason:t}},this.origin))}destroy(){window.removeEventListener("message",this.handleParentMessage)}constructor(e,t){this.messageQueue=[],this.readyState=WebSocket.CONNECTING,this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this.CONNECTING=WebSocket.CONNECTING,this.OPEN=WebSocket.OPEN,this.CLOSING=WebSocket.CLOSING,this.CLOSED=WebSocket.CLOSED,this.binaryType="blob",this.protocol="",this.url="",this.bufferedAmount=0,this.extensions="",this.handleParentMessage=e=>{var t,n,o,r;if(e.origin!==window.__SNOWSIGHT_NOTEBOOK_PARENT_ORIGIN||e.source!==window.parent)return;let{type:a,connectionId:i,payload:l}=e.data;if(i===this.connectionId)switch(a){case"NOTEBOOK_PARENT_WEBSOCKET_OPEN":this.readyState=WebSocket.OPEN,null==(t=this.onopen)||t.call(this,new Event("open")),this.messageQueue.forEach(e=>this.send(e)),this.messageQueue=[];break;case"NOTEBOOK_PARENT_WEBSOCKET_MESSAGE":null==(n=this.onmessage)||n.call(this,new MessageEvent("message",{data:l}));break;case"NOTEBOOK_PARENT_WEBSOCKET_ERROR":null==(o=this.onerror)||o.call(this,new Event("error"));break;case"NOTEBOOK_PARENT_WEBSOCKET_CLOSE":this.readyState=WebSocket.CLOSED,null==(r=this.onclose)||r.call(this,new CloseEvent("close",l))}},this.url=e,this.protocol=Array.isArray(t)?t[0]:t||"",this.origin=window.__SNOWSIGHT_NOTEBOOK_PARENT_ORIGIN||"null",this.connectionId=(0,r.Z)(),window.addEventListener("message",this.handleParentMessage),window.parent.postMessage({type:"NOTEBOOK_IFRAME_WEBSOCKET_CREATE",connectionId:this.connectionId,payload:{url:e,protocols:t}},this.origin)}}a.CONNECTING=0,a.OPEN=1,a.CLOSING=2,a.CLOSED=3;class i{createWebSocket(e,t,n){if(!this.supportedUrls.includes(t))return void o.log.error("Unsupported URL");let r=new WebSocket(t,n);r.binaryType="arraybuffer";let a={websocket:r,childWindow:this.childWindow,origin:this.origin};this.connections.set(e,a),r.onopen=()=>{this.childWindow.postMessage({type:"NOTEBOOK_PARENT_WEBSOCKET_OPEN",connectionId:e},this.origin)},r.onmessage=t=>{this.childWindow.postMessage({type:"NOTEBOOK_PARENT_WEBSOCKET_MESSAGE",connectionId:e,payload:t.data},this.origin)},r.onerror=()=>{this.childWindow.postMessage({type:"NOTEBOOK_PARENT_WEBSOCKET_ERROR",connectionId:e},this.origin)},r.onclose=t=>{this.childWindow.postMessage({type:"NOTEBOOK_PARENT_WEBSOCKET_CLOSE",connectionId:e,payload:{code:t.code,reason:t.reason,wasClean:t.wasClean}},this.origin),this.connections.delete(e)}}destroy(){for(let[e,t]of(window.removeEventListener("message",this.handleChildMessage),this.connections))t.websocket.close(),this.connections.delete(e)}constructor(e,t,n){this.connections=new Map,this.handleChildMessage=e=>{let t;if(e.origin!==this.origin||e.source!==this.childWindow)return;let{type:n,connectionId:o,payload:r}=e.data;switch(n){case"NOTEBOOK_IFRAME_WEBSOCKET_CREATE":this.createWebSocket(o,r.url,r.protocols);break;case"NOTEBOOK_IFRAME_WEBSOCKET_SEND":var a;null==(a=this.connections.get(o))||a.websocket.send(r);break;case"NOTEBOOK_IFRAME_WEBSOCKET_CLOSE":(t=this.connections.get(o))&&(t.websocket.close(r.code,r.reason),this.connections.delete(o))}},this.childWindow=e,this.origin=t,this.supportedUrls=n,window.addEventListener("message",this.handleChildMessage)}}},24930:function(e,t,n){n.d(t,{U:()=>a});var o=n(847345),r=n(45103);function a(e,t){let n=(0,o.useRef)(e),a=(0,o.useRef)(!1),i=(0,r.w)();return window.__SNOWSIGHT_NOTEBOOK_PARENT_ORIGIN&&i&&!a.current&&(a.current=!0,n.current=t),n.current}},226309:function(e,t,n){n.d(t,{Hx:()=>e8,PW:()=>e7,QE:()=>e5});var o=n(286204),r=n(463198),a=n(995780),i=n(411733),l=n(792851),s=n(367963),u=n.n(s),d=n(847345),c=n(797325),E=n(452374),f=n(781708),p=n(620400),S=n(603419),g=n(134445),_=n(739716),h=n(955407),m=n(7163),I=n(80127),T=n(700577),R=n(623368),C=n(271343),y=n(522878),v=n(916394),N=n(708287),A=n(980142),b=n(925470),O=n(184547);let L=(e,t)=>{let n={primaryRole:e};if(t===O.Bq||""===t)n.allSelected=!0;else if(t===O.sM)n.noneSelected=!0;else if(t){let e=t.split(",").map(e=>e.trim()).filter(e=>!!e);e.length>0&&(n.selected={role:e})}return n},k=e=>{var t;return e.allSelected?O.Bq:e.noneSelected?O.sM:(null==(t=e.selected)?void 0:t.role)?e.selected.role.join(","):""};var w=n(481263),M=n(298448),D=n(12935),U=n(45103),P=n(978005),x=n(711081),F=n(827335),B=n(24930);function G(){let e=(0,F.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.refreshLastUpdatedInfo}var V=n(316181),K=n(307239);function W(){let e=(0,F.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.getNotebookHistoryFile}var H=n(27702);function $(){let e=(0,F.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.writeToStageByObject}var Q=n(596633),j=n(306490);let Y=()=>{let e=(0,B.U)(K.U,W)(),t=(0,V.L)(),n=T.i.UI_ENABLE_APEX_FEATURE_32(),o=T.i.FEATURE_UI_ENABLE_NOTEBOOKS_SCHEDULING(),i=T.i.UI_ENABLE_NOTEBOOK_FEATURE_10();return(0,r.z)(async(r,l)=>{let{id:s,role:u,secondaryRoles:d,queryId:c,pageMode:E}=r;try{let r=c?await e({notebookId:s,historyQueryId:c}):await t(s,u,d);c&&!r&&(r=await t(s,u,d)),l({type:"LOAD_SUCCEEDED",id:s,role:u,secondaryRoles:d,pageMode:E,error:null,result:r,enforceUUIDAsCellId:n,enableSafeCellIdGeneration:o,isCellNameAndVariableConflictDetectionEnabled:i})}catch(e){(0,a.w)({content:e.message,type:"alert",autoDismiss:!1}),l({type:"LOAD_FAILED",id:s,role:u,secondaryRoles:d,error:e,pageMode:E})}})},z=()=>{let e=(0,B.U)(H.Nk,$)(),t=(0,B.U)(x._,G)(),n=(0,m.U)(),{localTimeToServerTime:o}=(0,j.h)(),i=T.i.UI_ENABLE_NOTEBOOK_FEATURE_24(),l=T.i.UI_ENABLE_NOTEBOOK_FEATURE_0(),s=(0,Q.d)(),u=(0,g.m)(["user"]);return(0,r.z)(async(r,d)=>{var c,E,f,p,S,g,_,h,m;let I,T,{id:R,role:C,secondaryRoles:y,content:v,lastEditStatus:N,isSourceCodeChange:A,lastestNotebookLoadTime:b,currentNotebookViewId:O,pageMode:L}=r,k=v,w="",M="canSave";try{if(i){let{urlId:e}=await n(R,C,y);w=e;let{checkStatus:t,lastEditStatusRetrieved:o}=await s({id:R,urlId:e,currentNotebookViewId:O,lastEditStatusInMemory:N,lastestNotebookLoadTime:b});M=t,T=null!=o?o:void 0,I=null!=(c=null!=o?o:N)?c:void 0}if("canSave"!==M){if(!A)return void d({type:"SAVE_SUCCEEDED",id:R,role:C,secondaryRoles:y,error:null,editStatusToUpdate:T,saveDone:!1,isSourceCodeChange:A,pageMode:L});d({type:"SAVE_FAILED",id:R,role:C,secondaryRoles:y,error:null,editStatusToUpdate:T,isSourceCodeChange:A,saveEligibilityCheckStatus:M,editingUserId:null!=(E=null==I?void 0:I.authorId)?E:"",editingUserName:null!=(f=null==I?void 0:I.authorName)?f:"",editingUserEmail:null==I?void 0:I.authorEmail,lastEditTime:null==I?void 0:I.lastEditTime,pageMode:L});return}if(i&&A){let e=Date.now(),t=o(e);T={notebookId:w,authorId:null!=(g=u.user.currentUserId)?g:"",authorName:null!=(_=null==(p=u.user.currentUser)?void 0:p.username)?_:"",authorEmail:null==(S=u.user.currentUser)?void 0:S.email,sessionId:O,lastEditTime:t};let n=JSON.parse(v);n.metadata.lastEditStatus=T,k=JSON.stringify(n,null,1),I=T}await e(R,C,y,k,!0),d({type:"SAVE_SUCCEEDED",id:R,role:C,secondaryRoles:y,error:null,editStatusToUpdate:T,saveDone:!0,isSourceCodeChange:A,pageMode:L}),await t(R,C,y)}catch(e){if(l&&(0,P.e)(e))return void d({type:"NETWORK_CONDITION_CHANGED",id:R,role:C,secondaryRoles:y,onlineToSnowflakeServer:!1,pageMode:L});if(i&&!A)return void d({type:"SAVE_SUCCEEDED",id:R,role:C,secondaryRoles:y,error:null,editStatusToUpdate:T,saveDone:!1,isSourceCodeChange:A,pageMode:L});(0,a.w)({content:e.message,type:"alert"}),d({type:"SAVE_FAILED",id:R,role:C,secondaryRoles:y,error:e,editStatusToUpdate:T,editingUserId:null!=(h=null==I?void 0:I.authorId)?h:"",editingUserName:null!=(m=null==I?void 0:I.authorName)?m:"",editingUserEmail:null==I?void 0:I.authorEmail,lastEditTime:null==I?void 0:I.lastEditTime,isSourceCodeChange:A,pageMode:L})}})},q=()=>{let e=Y(),t=z();return(0,d.useMemo)(()=>({readFromStage:e,writeToStage:t}),[e,t])};var Z=n(216591),J=n(457632);function X(){let e=(0,F.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.createWebsocketProtoParams}var ee=n(446282);function et(){let e=(0,F.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.deleteNotebookInstances}var en=n(45186);function eo(){let e=(0,F.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.fetchNotebookAuthToken}var er=n(188081);function ea(){let e=(0,F.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.fetchNotebookUrlInfo}var ei=n(177302);function el(){let e=(0,F.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.saveNotebookUserSessionSettings}function es(){let e=(0,F.JM)();return(null==e?void 0:e.snowbooks)?t=>{var n;if(!t.notebookState)return;let o={...t,notebookState:null==(n=t.notebookState)?void 0:n.toJson()};e.snowbooks.reifyNotebookEditorState(o)}:()=>{}}function eu(){return()=>{}}let ed=()=>(0,B.U)(eu,es)();var ec=n(152384),eE=n(194838),ef=n(639090),ep=n(550748),eS=n(795400),eg=n(399808),e_=n(697056);let eh=["SAVE_SUCCEEDED","SAVE_FAILED","START_NOTEBOOK","RUN_NOTEBOOK","CANCEL_EXECUTION","UPDATE_PACKAGE"],em=e=>!!eh.includes(e.type)&&("RUN_NOTEBOOK"!==e.type&&"START_NOTEBOOK"!==e.type||!1!==e.userTriggered);var eI=n(583853),eT=n(468804),eR=n(766120),eC=n(187604);let ey=e=>!e||"ownerMode"===e;var ev=n(645952);let eN=()=>(0,o.jsx)(ev.Z,{id:"Can’t start container notebooks using the ACCOUNTADMIN, SECURITYADMIN, or ORGADMIN roles. Switch your role by clicking your profile icon in the left navigation menu, and then try again."});var eA=n(691352),eb=n(53760);function eO(e,t,n){var r,a,i;let l=e.notebookState,s=e.udfConnectionStatus,u="spcs"===e.notebookRuntime,d=T.i.UI_ENABLE_NOTEBOOK_DISABLED_SPCS_EXPERIENCE_FOR_ADMINS(),c=(0,eA.e)(t.role)&&d&&u;if(!l)return void console.debug("Notebook state is not yet loaded");if(c)return void n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,notificationProps:{type:"alert",content:eN(),autoDismiss:!1}});if(u){let e=function(e){switch(e){case"valid":return null;case"empty":return(0,o.jsx)(ev.Z,{id:"Missing"});case"tooLong":return(0,o.jsx)(ev.Z,{id:"Couldn’t start notebook. Notebook name exceeds maximum length of 255 characters"});case"invalidCharacters":return(0,o.jsx)(ev.Z,{id:"Couldn’t start notebook. Notebook name can only include letters, numbers, spaces, underscores, -, $, and :"})}}((0,eb.V)(t.id.name));if(e)return void n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,notificationProps:{type:"alert",content:e,autoDismiss:!1}})}if((null==(r=e.sessionLifecycleState)?void 0:r.isReplayingMessagesAfterReconnect)||s!==ef.Q.Connecting&&s!==ef.Q.Reconnecting)s===ef.Q.NotConnected&&(e.udfConnectionStatus=ef.Q.Connecting,e.sessionLifecycleState={...null!=(i=e.sessionLifecycleState)?i:{},sessionStartTimeMs:Date.now(),sessionEndTimeMs:void 0,sessionEndReason:void 0,sessionStartId:f.Z()},n({type:"logNotebookStartingSessionTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode}));else{(null==(a=e.sessionLifecycleState)?void 0:a.sessionEndReason)&&(e.sessionLifecycleState.sessionEndReason=void 0);return}"running"!==e.runStatus&&(e.runStatus="waiting");let E=l.getCellsProto().filter(e=>"markdown"!==e.type);t.clearCodeResults&&(E=E.map(e=>({...e,code:""}))),n({id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,type:"runCells",cellRunType:t.cellRunType,runCellId:t.runCellId,clientState:t.clientState,cells:E,eventType:t.eventType,notebookRuntime:e.notebookRuntime,pageMode:t.pageMode})}function eL(e,t,n){var o,r,a,i,l;if(!ey(t.pageMode))return;let s=e.notebookState;if(!s)return;let u=null==(o=e.notebookState)?void 0:o.data.cells,d=(0,eC.i)(null!=u?u:[]),c=(0,eR.B)(t.cellType,d),E=s.addCell(t.index,c);return e.notebookState=E,e.selectedCell=c.id,n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:E.toJson(),currentNotebookViewId:null!=(a=null==(r=e.sessionLifecycleState)?void 0:r.notebookViewId)?a:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(i=e.lastestNotebookLoadTime)?i:0,lastEditStatus:null!=(l=e.notebookState.getLastEditStatus())?l:null,pageMode:t.pageMode}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.JW3,data:{cellId:c.id,cellIndex:t.index,cellType:t.cellType},pageMode:t.pageMode}),E}var ek=n(237911),ew=n(509983),eM=n(799787),eD=n(420174),eU=n(80726);let eP=()=>(0,o.jsx)(ev.Z,{id:"Kernel restarted. Your notebook is ready to run."});var ex=n(819260),eF=n(53722),eB=n(311582),eG=n(266046),eV=n(543145);let eK={UPDATE_RESULT:(e,t)=>{let n=t.cellId,o=e.notebookState;if(!o)return;let r=o.getCellResult(n);if(!r)return;let a=o,i=r.runId,l=r.tempRunId;if(!l||l!==i)if("running"===r.status.cellRunStatus)a=a.updateCellResult(n,{message:[t.result]});else{let e=r.message;a=a.updateCellResult(n,{message:[...e,t.result]})}let s=r.status.cellRunStatus;(0,eV.be)(s)?(0,eG.k)("Received forward message for a cell already done",{cellId:n}):a=a.updateCellStatus(n,{cellRunStatus:(0,eF.G)(t.result)?"unfinishedError":"populatingResults"}),e.notebookState=a},CELL_RUN_STARTED:(e,t)=>{var n,o,r,a,i,l;let s=t.cellRunInfo.cellId,u=e.notebookState;u&&s&&(e.notebookState=u.updateCellResult(s,{tempSelfContentHash:null!=(o=t.cellRunInfo.selfContentHash)?o:void 0,tempFullContentHash:null!=(r=t.cellRunInfo.fullContentHash)?r:void 0,tempRunId:null!=(a=t.cellRunInfo.runId)?a:void 0,tempParentExecutionId:null!=(i=t.cellRunInfo.parentExecutionId)?i:void 0,tempExecutionId:null!=(l=t.cellRunInfo.executionId)?l:void 0}).updateCellStatus(s,{cellRunStatus:"running",startedAt:t.cellRunInfo.startedAt?"number"==typeof t.cellRunInfo.startedAt?t.cellRunInfo.startedAt:null==(n=t.cellRunInfo.startedAt)?void 0:n.toNumber():void 0,endAt:void 0,pushdownQueries:[]}))},CELL_RUN_FINISHED:(e,t)=>{var n;let o,{cellId:r}=t,a=e.notebookState;if(!a)return;let i=a.getCellResult(r);if(!i)return;let l=a;"error"!==t.state&&(l=(l=l.updateCellResult(r,{selfContentHash:i.tempSelfContentHash,fullContentHash:i.tempFullContentHash,runId:i.tempRunId,parentExecutionId:i.tempParentExecutionId,executionId:i.tempExecutionId,tempSelfContentHash:void 0,tempFullContentHash:void 0,tempRunId:void 0,tempParentExecutionId:void 0,tempExecutionId:void 0})).updatePredictExecutionId(r)),"running"===i.status.cellRunStatus&&(l=l.updateCellResult(r,{message:[]})),o="unfinishedError"===i.status.cellRunStatus?"idle"===t.state?"idle":"error":"errorStopRunning"===t.state?"error":t.state,l=l.updateCellStatus(r,{cellRunStatus:o}),(null==(n=e.intelligentEditorAgentState)?void 0:n.generatedCellIdForVisualization)===r&&(e.intelligentEditorAgentState.generatedCellRunStatus=o),0!==t.timestamp&&(l=l.updateCellStatus(r,{endAt:t.timestamp})),e.notebookState=l},NOTEBOOK_RUN_FINISHED:(e,t)=>{let n=e.notebookState;if(!n)return;let o=n;for(let e of n.data.cells)("running"===e.result.status.cellRunStatus||"populatingResults"===e.result.status.cellRunStatus)&&(o=o.updateCellStatus(e.id,{cellRunStatus:"error"})),"waiting"===e.result.status.cellRunStatus&&(3===t.state||4===t.state)&&(o=o.updateCellStatus(e.id,{cellRunStatus:e.result.status.cellRunStatusBeforeExecution}));e.notebookState=o,e.runStatus="idle"},NOTEBOOK_RUN_STARTED:(e,t)=>{e.runStatus="running",e.cacheStatus="loaded";let n=e.notebookState;if(!n)return;let o=n;for(let e of t.cellIdsToRun){var r,a;o=o.updateCellStatus(e,{cellRunStatus:"waiting",cellRunStatusBeforeExecution:null!=(a=null==(r=o.getCellById(e))?void 0:r.result.status.cellRunStatus)?a:"neverRun"})}e.notebookState=o,e.udfConnectionStatus!==ef.Q.Connected&&(e.udfConnectionStatus=ef.Q.Connected,e.sessionLifecycleState={...e.sessionLifecycleState,sessionEndReason:void 0}),e.bottomBarState=void 0},NOTEBOOK_CACHE_STARTED:e=>{e.cacheStatus="fetching"},NOTEBOOK_CACHE_DONE:e=>{e.cacheStatus="loaded"},NOTEBOOK_CELL_STATUS:(e,t)=>{let n=e.notebookState;if(!n)return;let o=t.cellStatus.cellId,r=n.getCellById(o);if(r){if((0,ek.ro)(r))e.notebookState=n.updateCellStatus(t.cellStatus.cellId,{pushdownQueries:[]});else if((0,ek.XN)(r)){var a,i;e.notebookState=n.updateCellStatus(t.cellStatus.cellId,{pushdownQueries:null!=(i=null==(a=t.cellStatus.sqlCellStatus)?void 0:a.pushdownQueries)?i:[]})}}},NOTEBOOK_UPDATE_RESOURCE_USAGE:(e,t)=>{var n;e.resourceStats=null==(n=t.resourceUtilization)?void 0:n.resourceStats},NOTEBOOK_SESSION_SETTINGS_UPDATED:(e,t,n)=>{let{id:o,role:r,secondaryRoles:a,sessionSettings:i,pageMode:l}=t,{queryWarehouse:s,role:u}=i,d={...e.notebookSessionSettingsState.settings};s&&(d.queryWarehouse=s),u&&(d.role=u.primaryRole||d.role,d.secondaryRoles=k(u)||d.secondaryRoles),e.notebookSessionSettingsState.settings=d,e.notebookSessionSettingsState.settingsUpdateSource="RuntimeCodes",e.notebookSessionSettingsState.settingsUpdateTime=Date.now(),e.notebookSessionSettingsState.settingsCheckResponse={status:"success"},n({type:"saveNotebookSessionSettings",id:o,role:r,secondaryRoles:a,sessionSettings:d,pageMode:l})}},eW=(e,t,n)=>{let o=eK[t.type];void 0!==o&&o(e,t,n)};var eH=n(520669);function e$({notebookViewId:e,notebookUrlInfo:t}){return{loadStatus:"notLoaded",notebookState:null,runStatus:"notStarted",websocketStatus:{status:ef.Q.NotConnected,error:null},selectedCell:void 0,cacheStatus:"notLoaded",cacheLoadId:void 0,udfConnectionStatus:ef.Q.NotConnected,sessionLifecycleState:{notebookViewId:null!=e?e:f.Z(),onlineToSnowflakeServer:!0},urlId:"",resultHeightMap:{},cellContentMetadata:{},notebookUrlInfo:t,notebookSessionSettingsState:{settings:{}}}}let eQ={START_LOADING:(e,t,n)=>{n({type:"readFromStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,queryId:t.queryId,pageMode:t.pageMode}),e.loadStatus="loading",n({type:"logNotebookIPYNBTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.weH,eventType:"ui_visit",pageMode:t.pageMode})},LOAD_SUCCEEDED:(e,t,n)=>{try{var o,r;e.notebookState=ew.v.fromJson(t.result,{enforceUUIDAsCellId:null!=(o=t.enforceUUIDAsCellId)&&o,enableSafeCellIdGeneration:null!=(r=t.enableSafeCellIdGeneration)&&r,isCellNameAndVariableConflictDetectionEnabled:t.isCellNameAndVariableConflictDetectionEnabled}),e.loadStatus="loaded",e.lastestNotebookLoadTime=Date.now(),n({type:"logNotebookIPYNBTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,event:eT.j4e,eventType:"ui_response_success"})}catch(o){e.error=o,e.loadStatus="error",n({type:"logNotebookIPYNBTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,event:eT.vJg,eventType:"ui_response_error",data:{error:null==o?void 0:o.message}})}},LOAD_FAILED:(e,t,n)=>{var o;e.error=t.error,e.loadStatus="error",n({type:"logNotebookIPYNBTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,event:eT.vJg,eventType:"ui_response_error",data:{error:null==(o=t.error)?void 0:o.message}})},START_SAVING:(e,t,n)=>{var o,r,a,i;let l=e.notebookState;"loaded"===e.loadStatus&&l&&n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:l.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(a=e.lastestNotebookLoadTime)?a:0,lastEditStatus:null!=(i=l.getLastEditStatus())?i:null,pageMode:t.pageMode})},SAVE_SUCCEEDED:function(e,t,n){let{editStatusToUpdate:o,saveDone:r,isSourceCodeChange:a}=t;r&&(e.lastestNotebookLoadTime=Date.now()),(null==e?void 0:e.notebookState)&&o&&(e.notebookState=e.notebookState.updateLastEditStatus(o)),n({type:"logNotebookEditTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,event:eT.ZOT,eventType:"ui_response_success",data:{currentEditingUser:null==o?void 0:o.authorId,lastEditTime:null==o?void 0:o.lastEditTime,saveEligibilityCheckStatus:"canSave",saveDone:r,isSourceCodeChange:a}})},SAVE_FAILED:function(e,t,n){var o;e.error=t.error;let{editStatusToUpdate:r,saveEligibilityCheckStatus:a,editingUserId:i,editingUserName:l,editingUserEmail:s,lastEditTime:u,isSourceCodeChange:d}=t;(null==e?void 0:e.notebookState)&&r&&(e.notebookState=e.notebookState.updateLastEditStatus(r)),a&&"canSave"!==a&&n({type:"onNotebookConcurrentEditAlert",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,saveEligibilityCheckStatus:a,editingUserName:null!=l?l:"",editingUserEmail:s}),n({type:"logNotebookEditTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,event:eT.Ari,eventType:"ui_response_error",error:a&&"canSave"!==a?a:String(null!=(o=t.error)?o:""),data:{currentEditingUser:i,lastEditTime:u,saveEligibilityCheckStatus:a,isSourceCodeChange:d}})},UPDATE_NOTEBOOK_RUNTIME:function(e,t){e.notebookRuntime=t.notebookRuntime},SET_URL_ID_AND_RESULT_HEIGHT_MAP:function(e,t){e.urlId=t.urlId,e.resultHeightMap=t.resultHeightMap},FETCH_RESOURCE_USAGE:function(e,t,n){let{id:o,role:r,secondaryRoles:a}=t;e.udfConnectionStatus===ef.Q.Connected&&n({type:"fetchResourceUsage",id:o,role:r,secondaryRoles:a,pageMode:t.pageMode})},SET_BOTTOM_BAR_STATE:function(e,t){var n;t.expectedPrevType&&(null==(n=e.bottomBarState)?void 0:n.type)!==t.expectedPrevType||(e.bottomBarState=t.bottomBarState)},UPDATE_EDIT_STATUS:function(e,t){let{editStatusToUpdate:n}=t;(null==e?void 0:e.notebookState)&&n&&(e.notebookState=e.notebookState.updateLastEditStatus(n))},SET_NOTEBOOK_URL_INFO:function(e,t){let{urlInfo:n}=t;e.notebookUrlInfo=n},ADD_CELL:eL,MODIFIED_CELL:function(e,t,n){if(!ey(t.pageMode))return;let o=t.writeToStage,r=e.notebookState;if(!r)return;let a=r.modifyCell(t.index,t.content);if(t.language&&(a=a.setLanguage(t.index,t.language)),t.isProgrammaticContentUpdate){e.cellContentMetadata||(e.cellContentMetadata={});let n=a.data.cells[t.index].id;e.cellContentMetadata[n]||(e.cellContentMetadata[n]={}),e.cellContentMetadata[n].lastProgrammaticUpdateTime=Date.now()}if(e.notebookState=a,o){var i,l,s,u;n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:a.toJson(),currentNotebookViewId:null!=(l=null==(i=e.sessionLifecycleState)?void 0:i.notebookViewId)?l:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(s=e.lastestNotebookLoadTime)?s:0,lastEditStatus:null!=(u=e.notebookState.getLastEditStatus())?u:null,pageMode:t.pageMode})}return a},ADD_AND_MODIFY_CELL:function(e,t,n){var o,r,a,i,l,s;let{id:u,role:d,secondaryRoles:c,addAfterCell:E,newCellName:f,cellType:p,content:S,runCellAfterCreation:g,allowModifyWithoutSourceCodeEditingPrivilege:_,pageMode:h,source:m}=t,I=ey(h);if(!_&&!I)return;let T=e.notebookState;if(!T)return;let R=E||e.selectedCell,C=T.data.cells.findIndex(e=>e.id===R),y=-1===C?T.data.cells.length:C+1,v=null==(o=e.notebookState)?void 0:o.data.cells,N=f||(0,eC.i)(null!=v?v:[]),A=(0,eR.B)(p,N,S),b=T.addCell(y,A);e.notebookState=b,e.selectedCell=A.id,I?(n({type:"writeToStage",id:u,role:d,secondaryRoles:c,content:b.toJson(),currentNotebookViewId:null!=(a=null==(r=e.sessionLifecycleState)?void 0:r.notebookViewId)?a:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(i=e.lastestNotebookLoadTime)?i:0,lastEditStatus:null!=(l=e.notebookState.getLastEditStatus())?l:null,pageMode:h}),n({type:"logNotebookCellUITelemetry",id:u,role:d,secondaryRoles:c,event:eT.JW3,data:{cellId:A.id,cellIndex:y,cellType:p},pageMode:h})):e.cellContentMetadata[A.id].cellNotPersisted=!0,"cellVisualization"===m&&(e.notebookState=e.notebookState.setContentState(y,{collapsed:!1,codeCollapsed:!0}),e.intelligentEditorAgentState={...null!=(s=e.intelligentEditorAgentState)?s:{},generatedCellIdForVisualization:A.id}),g&&eO(e,{...t,type:"RUN_NOTEBOOK",runCellId:A.id,cellRunType:0,userTriggered:!0},n)},CELL_LANGUAGE:(e,t,n)=>{var o,r,a,i;if(!ey(t.pageMode))return;let l=e.notebookState;if(!l)return;let s=l.setLanguage(t.index,t.language);e.notebookState=s,n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:s.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(a=e.lastestNotebookLoadTime)?a:0,lastEditStatus:null!=(i=e.notebookState.getLastEditStatus())?i:null,pageMode:t.pageMode})},CELL_CONTENT_STATE:(e,t)=>{let n=e.notebookState;n&&(e.notebookState=n.setContentState(t.index,t.contentState))},CELL_RESULT_HEIGHT:(e,t,n)=>{e.resultHeightMap[t.cellId]=t.resultHeight,t.shouldSave&&n({type:"saveResultHeight",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,urlId:e.urlId,cellId:t.cellId,resultHeight:t.resultHeight,pageMode:t.pageMode})},REMOVE_CELL:(e,t,n)=>{var o,r,a,i;if(!ey(t.pageMode))return;let l=e.notebookState;if(!l)return;let s=l.data.cells[t.index],u=s.id,d=(0,ek.DA)(s),c=l.removeCell(t.index);e.notebookState=c;let E=Math.min(c.data.cells.length-1,t.index);e.selectedCell=E>=0?c.data.cells[E].id:void 0,n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:c.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(a=e.lastestNotebookLoadTime)?a:0,lastEditStatus:null!=(i=e.notebookState.getLastEditStatus())?i:null,pageMode:t.pageMode}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.Q_$,data:{cellId:u,cellIndex:t.index,cellType:d},pageMode:t.pageMode})},INSERT_BEFORE_CELL:(e,t,n)=>{var o,r,a,i;if(!ey(t.pageMode))return;let l=e.notebookState;if(!l)return;e.selectedCell=l.data.cells[t.from].id;let s=l.insertBefore(t.from,t.to);e.notebookState=s,n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:s.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(a=e.lastestNotebookLoadTime)?a:0,lastEditStatus:null!=(i=e.notebookState.getLastEditStatus())?i:null,pageMode:t.pageMode}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.jSd,pageMode:t.pageMode})},MOVE_CELL_UP:(e,t,n)=>{var o,r,a,i;if(!ey(t.pageMode))return;let l=e.notebookState;if(!l)return;let s=l.data.cells[t.index],u=s.id,d=(0,ek.DA)(s),c=l.moveCellUp(t.index);e.notebookState=c;let E=l.getCellResult(u);n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:c.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(a=e.lastestNotebookLoadTime)?a:0,lastEditStatus:null!=(i=e.notebookState.getLastEditStatus())?i:null,pageMode:t.pageMode}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.ETJ,data:{cellId:u,cellIndex:t.index,cellType:d,runId:null==E?void 0:E.runId},pageMode:t.pageMode})},MOVE_CELL_DOWN:(e,t,n)=>{var o,r,a,i;if(!ey(t.pageMode))return;let l=e.notebookState;if(!l)return;let s=l.data.cells[t.index],u=s.id,d=(0,ek.DA)(s),c=l.moveCellDown(t.index);e.notebookState=c;let E=l.getCellResult(u);n({type:"writeToStage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,content:c.toJson(),currentNotebookViewId:null!=(r=null==(o=e.sessionLifecycleState)?void 0:o.notebookViewId)?r:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(a=e.lastestNotebookLoadTime)?a:0,lastEditStatus:null!=(i=e.notebookState.getLastEditStatus())?i:null,pageMode:t.pageMode}),n({type:"logNotebookCellUITelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,event:eT.G1R,data:{cellId:u,cellIndex:t.index,cellType:d,runId:null==E?void 0:E.runId},pageMode:t.pageMode})},ADVANCE_CELL:function(e,t,n){let o=e.notebookState;if(!o)return;let r=o.data.cells,a=o.getCellById(t.runCellId),i=o.getCellIndexById(t.runCellId);a&&void 0!==i&&(i+1>=r.length?eL(e,{type:"ADD_CELL",cellType:(0,ek.M1)(a)?a.metadata.language:"markdown",index:i+1,role:t.role,secondaryRoles:t.secondaryRoles,id:t.id,pageMode:t.pageMode},n):e.selectedCell=r[i+1].id||void 0)},UPDATE_SELECTED_CELL:function(e,t){e.selectedCell=t.cellId},UNSELECT_CELL:function(e){e.selectedCell=void 0},RENAME_CELL:function(e,t,n){if(!ey(t.pageMode))return;let o=e.notebookState;if(!o)return;let{newCellName:r,index:a,id:i,role:l,secondaryRoles:s}=t;e.runStatus="idle";let{isValid:u}=(0,ep.Ke)(r,o.getGlobalVariables()),d=(0,ep.ae)(o.data.cells,r,a);if(u&&d){var c,E,f,p;let u=o.renameCell(a,r);n({type:"writeToStage",id:i,role:l,secondaryRoles:s,content:u.toJson(),currentNotebookViewId:null!=(E=null==(c=e.sessionLifecycleState)?void 0:c.notebookViewId)?E:"",isSourceCodeChange:!0,lastestNotebookLoadTime:null!=(f=e.lastestNotebookLoadTime)?f:0,lastEditStatus:null!=(p=u.getLastEditStatus())?p:null,pageMode:t.pageMode}),e.notebookState=u}d||n({type:"onNotebookError",id:i,role:l,secondaryRoles:s,error:ep._y.DUPLICATE,logError:!1,pageMode:t.pageMode})},UPDATE_MARKDOWN_CELL_RESULT:function(e,t){let n=e.notebookState;if(!n)return void console.error("Cannot update markdown result as Notebook state is not initialized yet");let{cellId:o,message:r}=t;e.notebookState=n.updateCellResult(o,{message:[r]}).updateCellStatus(o,{cellRunStatus:"idle"})},RECEIVE_MESSAGE:(e,t,n)=>{var o,r,a,i,l,s,u,d,c,E,f,p,S,g,_,h,m,I;let{message:T,id:C,role:y,secondaryRoles:v,pageMode:N}=t;if(null==(o=T.notebookStart)?void 0:o.isCache)eW(e,{type:"NOTEBOOK_CACHE_STARTED"},n),n({type:"logNotebookRunTelemetry",event:eT.F1$,id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,data:{isCache:!0}});else if(null==(r=T.notebookStart)?void 0:r.cellIdsToRun){let o=e.udfConnectionStatus;eW(e,{type:"NOTEBOOK_RUN_STARTED",cellIdsToRun:T.notebookStart.cellIdsToRun},n),o!==e.udfConnectionStatus&&e.udfConnectionStatus===ef.Q.Connected&&(o===ef.Q.Reconnecting?(e.sessionLifecycleState&&(e.sessionLifecycleState.reconnectResultInfo={}),n({type:"fetchLatestNotebookSessionSettings",id:C,role:y,secondaryRoles:v,pageMode:N}),n({type:"logSessionReconnectCompleted",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,data:{}}),n({type:"logSessionReconnectDetails",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N})):o===ef.Q.Connecting&&n({type:"logNotebookSessionTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,data:{isSuccess:!0,previousUdfStatus:o}}));let r=(0,eg.Js)(e),a=[];for(let e of T.notebookStart.cellIdsToRun){let t=null==r||null==(i=r.notebookState)?void 0:i.getCellById(e);t?a.push((0,ek.DA)(t)):a.push("unknown")}n({type:"logNotebookRunTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,event:eT.dJY,data:{cellIdsToRun:T.notebookStart.cellIdsToRun,cellTypes:a}}),n({type:"startRunningNotebookHeartbeat",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N})}else if(T.cellRunInfo&&T.cellRunInfo.cellId&&T.cellRunInfo.runId){let o=(0,eg.Js)(e),r=T.cellRunInfo.cellId?null==o||null==(l=o.notebookState)?void 0:l.getCellById(T.cellRunInfo.cellId):void 0;eW(e,{type:"CELL_RUN_STARTED",cellRunInfo:T.cellRunInfo},n);let a=T.cellRunInfo.cellId;(0,R.H$)(eE.kk,a),n({type:"logNotebookCellRunTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,event:eT._KU,data:{cellId:a,runId:T.cellRunInfo.runId,cellType:r?(0,ek.DA)(r):""},markerInfo:{event:eE.QX,markers:[a]}})}else if(T.cellRunDone&&T.cellRunDone.cellId){let o=e.cacheStatus,r=1===T.cellRunDone.state,a=T.cellRunDone.cellId,i="success";"fetching"===o?i="idle":r||(i=4===T.cellRunDone.state?"errorStopRunning":"error"),eW(e,{type:"CELL_RUN_FINISHED",cellId:a,state:i,timestamp:"number"==typeof T.cellRunDone.timestamp?T.cellRunDone.timestamp:T.cellRunDone.timestamp.toNumber(),role:y,secondaryRoles:v,id:C},n);let l=e.notebookState;if(!l)return;let d=l.getCellResult(a),c=l.getCellById(a),E=c?(0,ek.DA)(c):"",f=l.getCellResultSize(a),p=l.getCellResultQueryId(a);n({type:"logNotebookCellRunTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,event:eT.Hn4,data:{cellId:T.cellRunDone.cellId,isSuccess:r,error:r?void 0:null!=(s=T.cellRunDone.errorId)?s:void 0,cause:r?void 0:null!=(u=T.cellRunDone.additionalErrorMessage)?u:void 0,cellType:E,bytesLoaded:f,queryId:p,runId:null==d?void 0:d.runId},markerInfo:{event:eE.kk,markers:[T.cellRunDone.cellId]}})}else if(T.cellForwardMsg){let o=null==(d=T.cellForwardMsg)?void 0:d.forwardMsg,r=T.cellForwardMsg.cellId;if(!r&&o&&(0,eF.G)(o)){let r=null==o||null==(p=o.delta)||null==(f=p.newElement)||null==(E=f.exception)?void 0:E.message,a=e.udfConnectionStatus===ef.Q.Connecting,i=e.udfConnectionStatus===ef.Q.Reconnecting;(a||i)&&(e.udfConnectionStatus=ef.Q.NotConnected),a?n({type:"logNotebookSessionTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,data:{isSuccess:!1,error:r}}):i?(e.sessionLifecycleState&&(e.sessionLifecycleState.reconnectResultInfo={error:r}),n({type:"logSessionReconnectCompleted",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,data:{error:r}}),n({type:"logSessionReconnectDetails",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N})):n({type:"logNotebookSessionErrorMessage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,data:{error:r}}),n(r&&(0,eB.T)(r)?{type:"onExternalAccessIntegrationError",id:C,role:y,secondaryRoles:v,pageMode:N,error:r}:{type:"onNotebookError",id:C,role:y,secondaryRoles:v,pageMode:N,error:null!=r?r:""}),eW(e,{type:"NOTEBOOK_RUN_FINISHED",state:2},n)}if(!r)return;let a=null==(c=e.notebookState)?void 0:c.getCellById(r);if(void 0===a)return;(null==o?void 0:o.delta)&&eW(e,{type:"UPDATE_RESULT",cellId:a.id,result:o},n)}else if(null==(a=T.notebookDone)?void 0:a.isCache){eW(e,{type:"NOTEBOOK_CACHE_DONE"},n);let o=e.udfConnectionStatus===ef.Q.Reconnecting;n({type:"logNotebookRunTelemetry",event:eT.AK5,id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,data:{isCache:!0,isReconnect:o}})}else if(T.controlResponse){if(T.controlResponse.resourceUtilization)eW(e,{type:"NOTEBOOK_UPDATE_RESOURCE_USAGE",resourceUtilization:T.controlResponse.resourceUtilization},n);else if(T.controlResponse.requestId){let e=null!=(g=T.controlResponse.requestId)?g:"";ex.log.warn(`Received controlResponse with id: ${e}`),n({type:"controlResponseStatus",id:C,role:y,secondaryRoles:v,requestId:T.controlResponse.requestId,status:null!=(_=null==(S=T.controlResponse)?void 0:S.status)?_:void 0,pageMode:N})}}else if(T.notebookDone&&T.notebookDone.state){let o=2===T.notebookDone.state,r=null==(h=e.sessionLifecycleState)?void 0:h.isReplayingMessagesAfterReconnect;e.sessionLifecycleState={...null!=(m=e.sessionLifecycleState)?m:{},isReplayingMessagesAfterReconnect:!1},o&&T.notebookDone.additionalErrorMessage&&n({type:"onNotebookError",id:C,role:y,secondaryRoles:v,error:T.notebookDone.additionalErrorMessage,pageMode:N}),eW(e,{type:"NOTEBOOK_RUN_FINISHED",state:T.notebookDone.state},n),n({type:"logNotebookRunTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N,event:eT.MKg,data:{isSuccess:!o,error:o&&null!=(I=T.notebookDone.additionalErrorMessage)?I:void 0,isReplayingMessagesAfterReconnect:r}}),n({type:"stopRunningNotebookHeartbeat",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:N})}else T.cellStatus?eW(e,{type:"NOTEBOOK_CELL_STATUS",cellStatus:T.cellStatus},n):T.sessionSettings&&eW(e,{type:"NOTEBOOK_SESSION_SETTINGS_UPDATED",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,sessionSettings:T.sessionSettings,pageMode:N},n)},RECEIVE_CONTROL_MESSAGE:(e,t,n)=>{var o,r,a,i,l,s,u,d,c,E,f,p,S,g;let{message:_,updatePackageTimeoutId:h,isNotebookRestartKernelEnabled:m}=t,I=e.notebookState,R=T.i._DP_UI_NOTEBOOK_PACKAGE_UPDATE_ALERT(),C=t=>{(0,eM.h)(0===t.level),e.bottomBarState={type:"ReceivedStreamlitLifecycleMsg",data:{level:0,topic:t.topic,payload:t.payload}}};switch(_.type){case"lifecycleMsg":{let r=(0,eM.h)(_.lifecycleMsg);switch(r.level){case 0:switch(r.topic){case 2:{let t=r.payload?JSON.parse(r.payload):void 0;(null==t?void 0:t.serviceStatus)==="RUNNING"&&(e.serviceStatusInfo=t),C(r);break}case 3:case 4:m&&e.udfConnectionStatus===ef.Q.RestartingKernel&&(e.notebookState=I.clearAllExecutionStates(),e.runStatus="notStarted"),C(r);break;case 5:m&&e.udfConnectionStatus===ef.Q.RestartingKernel&&(e.udfConnectionStatus=ef.Q.Connected,n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,notificationProps:{type:"success",content:eP(),autoDismiss:!0},pageMode:t.pageMode}),n({type:"logNotebookKernelRestartEnd",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode})),C(r);break;case 1:case 8:C(r)}break;case 1:case 2:{let a=null==(o=(0,eU.xe)(r,eD.M.NOTEBOOK,t.getDocsUrl))?void 0:o(),i=`${r.topic}. ${r.payload}`;T.i.ENABLE_NOTEBOOK_UNIFIED_LIFECYCLE_ERROR_MSG()&&n({type:"logUnifiedLifecycleErrorTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,data:{level:r.level,error:i,udfConnectionStatus:e.udfConnectionStatus,errorReason:r.errorReason,errorCode:r.errorCode,isUserError:r.isUserError}}),e.udfConnectionStatus===ef.Q.Connecting?(e.udfConnectionStatus=ef.Q.NotConnected,n({type:"logNotebookSessionTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,data:{isSuccess:!1,error:i}})):e.udfConnectionStatus===ef.Q.Reconnecting?(e.udfConnectionStatus=ef.Q.NotConnected,e.sessionLifecycleState&&(e.sessionLifecycleState.reconnectResultInfo={error:i}),n({type:"logSessionReconnectCompleted",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,data:{error:i}}),n({type:"logSessionReconnectDetails",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode})):n(e.udfConnectionStatus===ef.Q.RestartingKernel&&m?{type:"logNotebookKernelRestartEnd",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,data:{error:i}}:{type:"logNotebookSessionErrorMessage",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,data:{error:i}}),n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,notificationProps:{type:"alert",content:a,autoDismiss:!1}}),n({type:"onNotebookError",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,error:(null==a?void 0:a.props.id)||i,silent:!0})}}break}case"clientControlResponse":{clearTimeout(h);let o=(0,eM.h)(_.clientControlResponse);if(o.executeConfigurationUpdateResponse){let l=o.executeConfigurationUpdateResponse,s=!!(null==l||null==(r=l.resolutionErrors)?void 0:r.length);e.notebookSessionSettingsState.settingsCheckResponse={status:s?"error":"success",resolutionErrors:null!=(a=l.resolutionErrors)?a:void 0},s&&"UserActionOnPage"===e.notebookSessionSettingsState.settingsUpdateSource&&n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,notificationProps:{type:"alert",content:(0,eU.XJ)(null!=(i=l.resolutionErrors)?i:void 0),autoDismiss:!1}})}else if(o.updateSessionSettingsResponse){let r=o.updateSessionSettingsResponse;(null==r||null==(l=r.error)?void 0:l.length)&&"UserActionOnPage"===e.notebookSessionSettingsState.settingsUpdateSource&&n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,notificationProps:{type:"alert",content:(0,eU.C$)(null!=(s=r.error)?s:void 0),autoDismiss:!1}})}else if(o.getSessionSettingsResponse){let r=o.getSessionSettingsResponse.sessionSettings;if(!r)return;let a=e.notebookSessionSettingsState.settings,i={...a,queryWarehouse:r.queryWarehouse||a.queryWarehouse,role:(null==(u=r.role)?void 0:u.primaryRole)||a.role,secondaryRoles:(null==(d=r.role)?void 0:d.allSelected)?O.Bq:(null==(c=r.role)?void 0:c.noneSelected)?O.sM:a.secondaryRoles};(i.queryWarehouse!==a.queryWarehouse||i.role!==a.role||i.secondaryRoles!==a.secondaryRoles)&&(e.notebookSessionSettingsState.settings=i,e.notebookSessionSettingsState.settingsUpdateSource="RuntimeCodes",e.notebookSessionSettingsState.settingsUpdateTime=Date.now(),e.notebookSessionSettingsState.settingsCheckResponse={status:"success"},n({type:"saveNotebookSessionSettings",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,sessionSettings:i}))}else if(R&&o.updateCondaEnvironment&&1===o.updateCondaEnvironment.environmentStatus){let e=o.updateCondaEnvironment.packageUpdates;(null==e?void 0:e.length)&&e.length>0&&(n({type:"openPackageUpdateAlert",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode}),n({type:"logNotebookPackageUpdateAlertTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode}))}else{o.updateCondaEnvironment&&n({type:"logCondaPackageUpdateTelemetry",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode,controlResponse:o});let r=1===o.status||(null==(E=o.error)?void 0:E.errorMessage);e.runStatus=r?"updatingPackagesFailed":"idle",r||n({type:"pushNotification",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,notificationProps:{type:"success",content:(0,eU.Oz)(),autoDismiss:!0},pageMode:t.pageMode})}break}case"notebookUserChannelStarted":{let o=(null==(f=t.message.notebookUserChannelStarted)?void 0:f.whReconnectMode)?({0:"FAST",1:"NEW_JOB"})[null==(p=t.message.notebookUserChannelStarted)?void 0:p.whReconnectMode]:void 0,r=(null==(S=t.message.notebookUserChannelStarted)?void 0:S.whReconnectInstance)?({0:"CONTROL",1:"USER"})[null==(g=t.message.notebookUserChannelStarted)?void 0:g.whReconnectInstance]:void 0;e.sessionLifecycleState&&(e.sessionLifecycleState.userChannelStartedInfo={...t.message.notebookUserChannelStarted,whReconnectMode:o,whReconnectInstance:r}),n({type:"logSessionReconnectDetails",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,pageMode:t.pageMode})}}},RUN_NOTEBOOK:eO,CLEAR_CODE_RESULTS:(e,t,n)=>{eO(e,{...t,type:"RUN_NOTEBOOK",cellRunType:1,runCellId:"",clearCodeResults:!0,userTriggered:!0},n)},RUN_NOTEBOOK_FAILED:e=>{e.runStatus="idle"},CANCEL_EXECUTION:function(e,t,n){let{id:o,role:r,secondaryRoles:a}=t;"running"===e.runStatus&&(e.runStatus="cancelling",n({type:"cancelExecution",id:o,role:r,secondaryRoles:a,pageMode:t.pageMode}))},SHUTDOWN_NOTEBOOK:(e,t,n)=>{let{id:o,role:r,secondaryRoles:a,isContainerRuntime:i,pageMode:l}=t;n({type:"shutdownNotebook",id:o,role:r,secondaryRoles:a,isContainerRuntime:i,pageMode:l})},START_NOTEBOOK:(e,t,n)=>{var o;if("loaded"!==e.loadStatus)return;let r=f.Z();e.sessionLifecycleState={...null!=(o=e.sessionLifecycleState)?o:{},sessionStartId:r,isReplayingMessagesAfterReconnect:t.isReplayingMessagesAfterReconnect},eO(e,{...t,type:"RUN_NOTEBOOK",cellRunType:7,runCellId:"",userTriggered:t.userTriggered},n)},RECONNECT_NOTEBOOK:function(e,t,n){let{id:o,role:r,secondaryRoles:a,pageMode:i}=t;n({type:"reconnectSession",id:o,role:r,secondaryRoles:a,pageMode:i})},RESTART_NOTEBOOK:function(e,t,n){let{id:o,role:r,secondaryRoles:a,isContainerRuntime:i,pageMode:l}=t;n({type:"restartNotebook",id:o,role:r,secondaryRoles:a,isContainerRuntime:i,pageMode:l})},RESTART_KERNEL:function(e,t,n){let{id:o,role:r,secondaryRoles:a,pageMode:i}=t;e.udfConnectionStatus=ef.Q.RestartingKernel,n({type:"restartNotebookKernel",id:o,role:r,secondaryRoles:a,pageMode:i})},CLEAR_DISCONNECT_REASON:function(e){let t=e.sessionLifecycleState;t&&(t.sessionEndReason=void 0)},UPDATE_NOTEBOOK_SESSION_SETTINGS:(e,t,n)=>{let{id:o,role:r,secondaryRoles:a,sessionSettings:i,updatedBy:l,pageMode:s,bypassDatabasePersist:u}=t,d={...e.notebookSessionSettingsState.settings,...i};e.notebookSessionSettingsState.settings=d,e.notebookSessionSettingsState.settingsUpdateSource=l,e.notebookSessionSettingsState.settingsUpdateTime=Date.now(),e.notebookSessionSettingsState.settingsCheckResponse=void 0,i.runtimeName&&(e.notebookRuntime=i.runtimeName&&"SYSTEM$WAREHOUSE_RUNTIME"!==i.runtimeName?"spcs":"wh"),!0!==u&&n({type:"saveNotebookSessionSettings",id:o,role:r,secondaryRoles:a,sessionSettings:d,pageMode:s})},SET_EXECUTION_CONFIGURATIONS:(e,t,n)=>{let{id:o,role:r,secondaryRoles:a,executionConfigurations:i,pageMode:l}=t;n({type:"updateExecuteConfiguration",id:o,role:r,secondaryRoles:a,executionConfiguration:i,pageMode:l})},WEBSOCKET_UNMOUNTED:function(e){let t=e.notebookState;t&&(e.runStatus="notStarted",e.cacheStatus="notLoaded",e.notebookState=t.clearAllResults(),e.sessionLifecycleState={})},WEBSOCKET_START_CONNECTING:function(e,t){let{numOfActiveSessions:n}=t;if(e.websocketStatus.status=n?ef.Q.Reconnecting:ef.Q.Connecting,void 0!==n){var o;n&&(e.udfConnectionStatus=ef.Q.Reconnecting),e.sessionLifecycleState={...null!=(o=e.sessionLifecycleState)?o:{},numberOfRunningSessions:n}}},WEBSOCKET_CONNECTED:function(e,t){console.log("Websocket connected"),e.websocketStatus.status=ef.Q.Connected,e.websocketStatus.idOfAlreadyRunningInstance=t.idOfAlreadyRunningInstance,e.websocketStatus.error=null,e.websocketStatus.streamlitVersionOfAlreadyRunningInstance=t.streamlitVersionOfAlreadyRunningInstance},WEBSOCKET_DISCONNECTED:function(e,t,n){var o,r,a;let{id:i,role:l,secondaryRoles:s,reason:u,pageMode:d}=t;console.log("Websocket disconnected due to reason:",u);let c=e.notebookState;c&&(t.reason&&"string"==typeof t.reason&&(e.sessionLifecycleState={...null!=(r=e.sessionLifecycleState)?r:{},sessionEndReason:t.reason}),e.sessionLifecycleState&&(e.sessionLifecycleState={...e.sessionLifecycleState,reconnectResultInfo:void 0,userChannelStartedInfo:void 0}),!(0,eH.vi)({udfConnectionStatus:e.udfConnectionStatus,disconnectReason:u})||(null==e||null==(o=e.sessionLifecycleState)?void 0:o.isNonInteractiveSession)?(e.websocketStatus.status=ef.Q.NotConnected,e.runStatus="updatingPackages"===e.runStatus?"updatingPackagesFailed":"idle",e.notebookState=c.clearAllExecutionStates(),e.udfConnectionStatus=ef.Q.NotConnected,e.bottomBarState=void 0,e.sessionLifecycleState={...null!=(a=e.sessionLifecycleState)?a:{},sessionEndTimeMs:Date.now()},(0,eH.ne)(u)&&"loaded"!==e.cacheStatus&&(console.debug("[Notebook] Reconnect websocket to load cache results after reconnecting existing session failed"),e.cacheStatus="notLoaded",n({type:"connectWebsocket",id:i,role:l,secondaryRoles:s,connectExistingSession:!1,loadCachedResultsAfterConnection:!0,pageMode:d})),u===ef.w.USER_NOTEBOOK_SHUTDOWN&&(e.runStatus="notStarted")):(e.websocketStatus.status=ef.Q.Reconnecting,e.udfConnectionStatus=ef.Q.Reconnecting,n({type:"reconnectSession",id:i,role:l,secondaryRoles:s,pageMode:d})))},WEBSOCKET_CONNECTION_ERROR:function(e,t,n){let{id:o,role:r,secondaryRoles:a,pageMode:i}=t;e.udfConnectionStatus=ef.Q.NotConnected,e.websocketStatus.status=ef.Q.NotConnected,e.websocketStatus.idOfAlreadyRunningInstance=void 0,e.websocketStatus.error=t.error,e.bottomBarState=void 0,e.runStatus="updatingPackages"===e.runStatus?"updatingPackagesFailed":"notStarted"===e.runStatus?"notStarted":"idle";let l=e.sessionLifecycleState;l&&(l.sessionEndTimeMs=Date.now()),n({type:"onNotebookError",id:o,role:r,secondaryRoles:a,error:"Unable to establish web socket connection after max attempts"===t.error?"Unable to connect.":"Unable to connect. A firewall or ad blocker might be preventing you from connecting.",pageMode:i})},NETWORK_CONDITION_CHANGED:function(e,t,n){var o;let{id:r,role:a,secondaryRoles:i,onlineToSnowflakeServer:l,pageMode:s}=t,u=null!=(o=e.sessionLifecycleState)?o:{},d=void 0===u.onlineToSnowflakeServer||u.onlineToSnowflakeServer,c=void 0!==l?l:d;e.sessionLifecycleState={...u,onlineToSnowflakeServer:c},c===d&&c||(console.debug("User's network condition changed.",{onlineToSnowflakeServer:c}),n({type:"networkConditionChanged",id:r,role:a,secondaryRoles:i,onlineToSnowflakeServer:c,pageMode:s}))},UPDATE_PACKAGE:(e,t,n)=>{let{id:o,role:r,secondaryRoles:a,isContainerRuntime:i,pageMode:l}=t;if(e.udfConnectionStatus!==ef.Q.Connected)return void console.warn(`UPDATE_PACKAGE is only applicable when UDF Connection Status is connected but got ${e.udfConnectionStatus}`);e.runStatus="updatingPackages",n(i?{type:"updatePackage",isContainerRuntime:i,imports:t.imports,id:o,role:r,secondaryRoles:a,pageMode:l}:{type:"updatePackage",data:t.data,isContainerRuntime:i,id:o,role:r,secondaryRoles:a,pageMode:l})},UPDATE_PACKAGE_FAILED:e=>{"updatingPackages"===e.runStatus&&(e.runStatus="updatingPackagesFailed")},UPDATE_PACKAGE_DONE:e=>{"updatingPackages"===e.runStatus&&(e.runStatus="idle")},START_FETCHING_CACHED_RESULTS:function(e,t,n){var o;let{id:r,role:a,secondaryRoles:i,pageMode:l}=t;(0,R.OY)(eE.bZ,(0,p.m)(r)),null==(o=e.notebookState)||o.getCellsProto().forEach(e=>{var t;(0,R.OY)(eE.QX,null!=(t=e.id)?t:"")}),n({type:"fetchCachedResults",id:r,role:a,secondaryRoles:i,pageMode:l})},START_FETCHING_CACHE_RESULT:function(e,t){let{cacheLoadId:n}=t;e.cacheStatus="pending",e.cacheLoadId=n},FETCHING_CACHE_TIMED_OUT:function(e,t,n){let{id:o,role:r,secondaryRoles:a,cacheLoadId:i,pageMode:l}=t;i===e.cacheLoadId&&(0,eI.P)(e.cacheStatus)&&(e.cacheStatus="error",n({type:"onNotebookError",id:o,role:r,secondaryRoles:a,error:"Some cell results could not be loaded.",silent:!0,pageMode:l}))},SET_NON_INTERACTIVE_MODE:function(e){var t;e.sessionLifecycleState={...null!=(t=e.sessionLifecycleState)?t:{},isNonInteractiveSession:!0}},RESET_STATE:function(e){var t;let n=e$({notebookViewId:null==(t=e.sessionLifecycleState)?void 0:t.notebookViewId,notebookUrlInfo:e.notebookUrlInfo});Object.assign(e,{},n)},REPLACE_STATE:function(e,t){Object.assign(e,{},t.state)},UPDATE_EDITOR_INTELLIGENCE_AGENT:function(e,t,n){var o;let{intelligentEditorAgentState:r}=t;r&&(e.intelligentEditorAgentState={...null!=(o=e.intelligentEditorAgentState)?o:{},...r})},...e_.j},ej=(e,t,n)=>(o,r,a)=>{a(()=>(function(e,t){for(let n of t)try{n(e)}catch(e){i.cM.error(e,{message:"An error occurred in the notebook event listener"})}})(r,e));let l=(0,eg.ZP)(o,e=>{let{type:t,id:n,role:o,secondaryRoles:i,pageMode:l}=r,s=(0,eS.E)(n,o,i);if(e[s]||(e[s]=e$({})),em(r)){var u;e[s].sessionLifecycleState={...null!=(u=e[s].sessionLifecycleState)?u:{},latestUserInteractionTime:Date.now()},a({type:"triggerUserInteractionKeepalive",id:n,role:o,secondaryRoles:i,pageMode:l})}let d=eQ[t];void 0!==d&&d(e[s],r,a)});if(n&&t){let{id:e,role:t,secondaryRoles:n,pageMode:o}=r;a({type:"syncNotebookEditorState",notebookEditorState:l[(0,eS.E)(e,t,n)],id:e,role:t,secondaryRoles:n,pageMode:o})}return l};var eY=n(574883),ez=n(275436);function eq(e,t){let n=(0,ez.mk)(),o=t.urlId,r=n.get(o)||{};r[t.cellId]=t.resultHeight,n.delete(o),n.set(o,r),n.size>=ez.Dz&&(n=new Map(Array.from(n.entries()).slice(-ez.Dz))),localStorage.setItem(ez.Y7,JSON.stringify(Array.from(n.entries())))}var eZ=n(928874),eJ=n(65150);let eX=({websocketMapRef:e})=>{let{logEvent:t}=(0,eZ.f1)(),n=(0,Z.N)(),o=(0,r.z)((t,o)=>{var r,a;let{id:i,event:l,data:s={},role:u,secondaryRoles:d,pageMode:c}=o,E=(0,eS.E)(i,u,d),f=e.current[E],p=t[E];n.logCellUITelemetry(i,l,{...s,connectionId:null!=(a=null==f?void 0:f.connectionId)?a:"",notebookViewId:null==p||null==(r=p.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==p?void 0:p.notebookRuntime,pageMode:c},{event:eE.Xv,markers:[`${s.cellIndex}`]})}),a=(0,r.z)((t,o)=>{var r,a;let{id:i,event:l,data:s,role:u,secondaryRoles:d,markerInfo:c,pageMode:E}=o,f=(0,eS.E)(i,u,d),p=e.current[f],S=t[f];n.logCellRunTelemetry(i,l,{...s,connectionId:null!=(a=null==p?void 0:p.connectionId)?a:"",notebookViewId:null==S||null==(r=S.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==S?void 0:S.notebookRuntime,pageMode:E},s.isSuccess,c)}),i=(0,r.z)((t,o)=>{var r,a,i;let{id:l,event:s,data:u,role:d,secondaryRoles:c,pageMode:E}=o,f=(0,eS.E)(l,d,c),S=e.current[f],g=t[f];n.logRunEvent(l,s,{...u,connectionId:null!=(i=null==S?void 0:S.connectionId)?i:"",notebookViewId:null==g||null==(r=g.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==g?void 0:g.notebookRuntime,pageMode:E,isReplayingMessage:!!(s===eT.MKg&&u&&u.isReplayingMessagesAfterReconnect),reconnectInstanceId:null==g||null==(a=g.websocketStatus)?void 0:a.idOfAlreadyRunningInstance},u?u.isSuccess:void 0,{event:eE.bZ,markers:[(0,p.m)(l)],isUserE2E:!0})}),l=(0,r.z)((t,o)=>{var r,a;let{id:i,event:l,eventType:s,role:u,secondaryRoles:d,data:c={},pageMode:E}=o,f=(0,eS.E)(i,u,d),S=e.current[f],g=t[f];n.logIPYNBEvent(i,l,{...c,connectionId:null!=(a=null==S?void 0:S.connectionId)?a:"",notebookViewId:null==g||null==(r=g.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==g?void 0:g.notebookRuntime,pageMode:E},s,{event:eE.sW,markers:[(0,p.m)(i)]})}),s=(0,r.z)((t,o)=>{var r,a;let{id:i,role:l,secondaryRoles:s,pageMode:u}=o,d=(0,eS.E)(i,l,s),c=e.current[d],E=t[d];n.logSessionStarting(i,{connectionId:null==c?void 0:c.connectionId,sessionStartId:null==E||null==(r=E.sessionLifecycleState)?void 0:r.sessionStartId,notebookViewId:null==E||null==(a=E.sessionLifecycleState)?void 0:a.notebookViewId,notebookRuntime:null==E?void 0:E.notebookRuntime,pageMode:u})}),u=(0,r.z)((t,o)=>{var r,a,i,l,s,u,d,c,E;let{id:f,role:S,secondaryRoles:g,data:_,pageMode:h}=o,m=(0,eS.E)(f,S,g),I=e.current[m],R=t[m],C=2===_.level,y={connectionId:null==I?void 0:I.connectionId,notebookRuntime:null==R?void 0:R.notebookRuntime,notebookViewId:null==R||null==(r=R.sessionLifecycleState)?void 0:r.notebookViewId,udfConnectionStatus:_.udfConnectionStatus,error:_.error,errorReason:_.errorReason||"",sqlErrorCode:_.errorCode||"",isUserError:!!_.isUserError,isUnifiedLifecycleError:!0};if(C)switch(_.udfConnectionStatus){case ef.Q.Connecting:n.logNotebookEvent({notebookId:f,event:eT.NJ3,eventType:eJ.gK,eventData:{...y,sessionStartId:null==R||null==(a=R.sessionLifecycleState)?void 0:a.sessionStartId},pageMode:h,markerInfo:{event:eE.Ti,markers:[(0,p.m)(f),null!=(i=y.connectionId)?i:""]}});break;case ef.Q.Reconnecting:{let e={...y,reconnectInstanceId:null==R||null==(l=R.websocketStatus)?void 0:l.idOfAlreadyRunningInstance},t={event:eE.Ff,markers:[(0,p.m)(f),null!=(d=y.connectionId)?d:""]};n.logNotebookEvent({notebookId:f,event:eT.ru7,eventType:eJ.gK,eventData:e,markerInfo:t,pageMode:h});let o=null==(s=R.sessionLifecycleState)?void 0:s.reconnectResultInfo,r=null==(u=R.sessionLifecycleState)?void 0:u.userChannelStartedInfo;o&&r&&n.logNotebookEvent({notebookId:f,event:eT.G0u,eventType:eJ.gK,eventData:{...e,...o,...r},markerInfo:t,pageMode:h})}break;case ef.Q.RestartingKernel:T.i.UI_ENABLE_NOTEBOOK_FEATURE_30()&&n.logNotebookEvent({notebookId:f,event:eT.w08,eventType:eJ.gK,eventData:y,markerInfo:{event:eE.nL,markers:[(0,p.m)(f),null!=(c=y.connectionId)?c:""]},pageMode:h})}else n.logNotebookEvent({notebookId:f,event:eT.kDJ,eventType:eJ.gK,eventData:{...y,sessionStartId:null==R||null==(E=R.sessionLifecycleState)?void 0:E.sessionStartId},pageMode:h})}),c=(0,r.z)((t,o)=>{var r,a;let{id:i,role:l,secondaryRoles:s,data:u,pageMode:d}=o,c=(0,eS.E)(i,l,s),E=e.current[c],f=t[c],p={connectionId:null==E?void 0:E.connectionId,notebookRuntime:null==f?void 0:f.notebookRuntime,sessionStartId:null==f||null==(r=f.sessionLifecycleState)?void 0:r.sessionStartId,notebookViewId:null==f||null==(a=f.sessionLifecycleState)?void 0:a.notebookViewId,pageMode:d};u.isSuccess?n.logSessionStartSuccess(i,p):n.logSessionStartFailed(i,{...p,error:u.error})}),E=(0,r.z)((t,o)=>{var r,a;let{id:i,role:l,secondaryRoles:s,data:u,pageMode:d}=o,c=(0,eS.E)(i,l,s),E=e.current[c],f=t[c];n.logSessionErrorMessage(i,{connectionId:null==E?void 0:E.connectionId,sessionStartId:null==f||null==(r=f.sessionLifecycleState)?void 0:r.sessionStartId,notebookViewId:null==f||null==(a=f.sessionLifecycleState)?void 0:a.notebookViewId,notebookRuntime:null==f?void 0:f.notebookRuntime,error:u.error,pageMode:d})}),f=(0,r.z)((t,o)=>{var r,a;let{id:i,role:l,secondaryRoles:s,data:u,pageMode:d}=o,c=(0,eS.E)(i,l,s),E=e.current[c],f=t[c];n.logSessionReconnectCompleted(i,{connectionId:null==E?void 0:E.connectionId,notebookViewId:null==f||null==(r=f.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==f?void 0:f.notebookRuntime,error:u.error,reconnectInstanceId:null==f||null==(a=f.websocketStatus)?void 0:a.idOfAlreadyRunningInstance,pageMode:d})}),S=(0,r.z)((t,o)=>{var r,a,i,l;let{id:s,role:u,secondaryRoles:d,pageMode:c}=o,E=(0,eS.E)(s,u,d),f=t[E],p=e.current[E],S=null==(r=f.sessionLifecycleState)?void 0:r.reconnectResultInfo,g=null==(a=f.sessionLifecycleState)?void 0:a.userChannelStartedInfo;S&&g&&n.logSessionReconnectDetails(s,{connectionId:null==p?void 0:p.connectionId,notebookViewId:null==f||null==(i=f.sessionLifecycleState)?void 0:i.notebookViewId,notebookRuntime:null==f?void 0:f.notebookRuntime,reconnectInstanceId:null==f||null==(l=f.websocketStatus)?void 0:l.idOfAlreadyRunningInstance,...S,...g,pageMode:c})}),g=(0,r.z)((e,n)=>{var o;let{id:r,role:a,secondaryRoles:i,event:l,eventType:s,data:u={},pageMode:d}=n,c=e[(0,eS.E)(r,a,i)];t({data:{notebookIdentifier:(0,p.m)(r),...u,notebookViewId:null==c||null==(o=c.sessionLifecycleState)?void 0:o.notebookViewId,pageMode:d},event:l,type:s})}),_=(0,r.z)((e,t)=>{var o;let{id:r,event:a,eventType:i,role:l,secondaryRoles:s,error:u,data:d={},pageMode:c}=t,E=e[(0,eS.E)(r,l,s)];n.logNotebookEditEvent(r,a,{...d,notebookViewId:null==E||null==(o=E.sessionLifecycleState)?void 0:o.notebookViewId,notebookRuntime:null==E?void 0:E.notebookRuntime,error:u,pageMode:c},i,{event:eE.gr,markers:[(0,p.m)(r)]})}),h=(0,r.z)((t,o)=>{var r;let{id:a,role:i,secondaryRoles:l,data:s,pageMode:u}=o,d=(0,eS.E)(a,i,l),c=e.current[d],E=t[d];n.logKernelRestartEnd(a,{connectionId:null==c?void 0:c.connectionId,notebookViewId:null==E||null==(r=E.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==E?void 0:E.notebookRuntime,error:null==s?void 0:s.error,pageMode:u})}),m=(0,r.z)((t,o)=>{var r;let{id:a,role:i,secondaryRoles:l,pageMode:s}=o,u=(0,eS.E)(a,i,l),d=e.current[u],c=t[u];n.logNotebookPackageUpdateAlert(a,{connectionId:null==d?void 0:d.connectionId,notebookViewId:null==c||null==(r=c.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:null==c?void 0:c.notebookRuntime,pageMode:s})}),I=(0,r.z)((e,t)=>{let{id:o,controlResponse:r}=t;n.logCondaPackageUpdateTelemetry(o,r)});return(0,d.useMemo)(()=>({logNotebookTelemetry:g,logNotebookIPYNBTelemetry:l,logNotebookCellUITelemetry:o,logNotebookCellRunTelemetry:a,logNotebookRunTelemetry:i,logNotebookStartingSessionTelemetry:s,logNotebookSessionTelemetry:c,logNotebookSessionErrorMessage:E,logSessionReconnectCompleted:f,logSessionReconnectDetails:S,logNotebookKernelRestartEnd:h,logNotebookEditTelemetry:_,logNotebookPackageUpdateAlertTelemetry:m,logUnifiedLifecycleErrorTelemetry:u,logCondaPackageUpdateTelemetry:I}),[g,l,o,a,i,c,E,s,f,S,h,_,m,u,I])};var e0=n(415422),e1=n(510514);async function e4({isParallelFetchEnabled:e,urlInfo:t,getNotebookUrlInfo:o,getWebsocketProtoParams:r}){if(t&&!e){let{ConnectionManager:e}=await Promise.all([n.e("94641"),n.e("13664"),n.e("7987"),n.e("67025"),n.e("73213")]).then(n.bind(n,901873));return{ConnectionManager:e,webSocketProtoParams:await r(),urlInfo:t}}let[{ConnectionManager:a},i,l]=await Promise.all([Promise.all([n.e("94641"),n.e("13664"),n.e("7987"),n.e("67025"),n.e("73213")]).then(n.bind(n,901873)),r(),o()]);return{ConnectionManager:a,webSocketProtoParams:i,urlInfo:l}}let[e3,e2]=(0,l.Z)(()=>(function(){let{formatMessage:e}=(0,c.Z)(),t=(0,m.U)(),{openDialog:n,hideDialog:l}=(0,M.E)(),{triggerDialog:s}=(0,b.b)(),O=(0,Z.N)(),k=T.i.UI_ENABLE_NOTEBOOK_LARGE_MESSAGE_CACHE(),P=T.i.FEATURE_UI_ENABLE_NOTEBOOKS_SCHEDULING(),x=T.i.NOTEBOOK_ENABLE_IDLE_HEARTBEAT(),F=T.i.NOTEBOOK_IDLE_HEARTBEAT_TIMEOUT_SECONDS(),G=T.i.NOTEBOOK_CACHE_FETCHING_TIMEOUT_SECONDS(),V=T.i.UI_ENABLE_NOTEBOOK_FEATURE_1(),K=T.i.UI_ENABLE_NOTEBOOK_FEATURE_21(),W=T.i.UI_ENABLE_NOTEBOOK_FEATURE_22(),H=(0,U.w)(),$=void 0!==window.__SNOWSIGHT_NOTEBOOK_PARENT_ORIGIN,Q=(0,y.J)(),j=T.i.NOTEBOOK_UPDATE_PACKAGE_TIMEOUT_SECONDS()||300,Y=T.i.UI_ENABLE_NOTEBOOK_JUPYTER_VARIABLE_SEMANTICS(),z=T.i.UI_ENABLE_NOTEBOOK_FEATURE_25(),es=T.i.UI_ENABLE_NOTEBOOK_FEATURE_30(),eu=T.i.UI_ENABLE_NOTEBOOK_FEATURE_40(),eg=(0,d.useRef)({}),e_=T.i.STREAMLIT_WEBSOCKET_IDLE_TIMEOUT(),eh=T.i.UI_ENABLE_NOTEBOOK_FEATURE_45()||H,em=(0,d.useRef)(null),{organization:eI}=(0,g.m)(["organization"]),{region:eT,org:eR}=eI.currentRegionAndOrgInfoFromOrganization,{readFromStage:eC,writeToStage:ey}=q(),ev=(0,B.U)(ei.k,el)(),{getDocsUrl:eN}=(0,e1.V)(),eA=(0,d.useCallback)((e,t,n)=>void eC(t,n),[eC]),eb=(0,d.useCallback)((e,t,n)=>{let{id:o}=t;O.markEventStart(eE.gr,(0,p.m)(o)),ey(t,n)},[ey,O]),eO=(0,d.useMemo)(()=>u()(eb,3e3,{trailing:!0}),[eb]),eL=(0,_.d)(),ek=(0,B.U)(J.l,X)(),ew=(0,B.U)(ee.M,et)(),eM=(0,B.U)(er.W,ea)(),eD=(0,B.U)(en.P,eo)(),eU=(0,r.z)(async({id:e,role:t,secondaryRoles:n,urlInfo:o,queryId:r,connectExistingSession:a=!0,loadCachedResultsAfterConnection:i=!1,pageMode:l})=>{var s,u,d;let c=(0,eS.E)(e,t,n),E=eg.current;(null==(s=E[c])?void 0:s.connection.isConnected())&&(null==(d=E[c])||d.connection.disconnect("NOTEBOOK_RECONNECT"));let S=f.Z(),g=ty[c],_=null==g?void 0:g.notebookRuntime,m=!!r,R=a&&!m,{ConnectionManager:y,webSocketProtoParams:v,urlInfo:N}=await e4({isParallelFetchEnabled:T.i.UI_ENABLE_NOTEBOOK_FEATURE_54(),urlInfo:o,getNotebookUrlInfo:()=>eM({id:e,role:t,secondaryRoles:n,isPrivatelink:eL()}),getWebsocketProtoParams:()=>R?ek(e):Promise.resolve({additionalProtoParams:[],activeInstanceJobId:null,activeNotebookInstancesNum:void 0,additionalMetadata:void 0})});tv({type:"SET_NOTEBOOK_URL_INFO",id:e,role:t,secondaryRoles:n,urlInfo:N,pageMode:l});let{additionalProtoParams:A,activeInstanceJobId:b,activeNotebookInstancesNum:L,additionalMetadata:w}=v,M=[(0,p.m)(e),S];O.markEventStart(eE.x5,...M),O.markEventStart(eE.wT,S||"UNKNOWN"),L&&O.markEventStart(eE.Ff,(0,p.m)(e),S),O.logWebsocketStartConnecting(e,{connectionId:S,notebookViewId:null==g||null==(u=g.sessionLifecycleState)?void 0:u.notebookViewId,notebookRuntime:_,pageMode:l,isReconnect:!!L,reconnectInstanceId:null!=b?b:void 0,skipPingEnabled:eh}),tv({type:"WEBSOCKET_START_CONNECTING",id:e,role:t,secondaryRoles:n,pageMode:l,numOfActiveSessions:L});let D=!!(L&&g&&"notStarted"!==g.runStatus&&!m),U=[],x=e=>{U.includes(e)||U.push(e)},F=e=>{let t=U.indexOf(e);t>=0&&U.splice(t,1)},B=e=>{let t=!0;for(let n of U)if(!(t=n.onMessage(e)))break;return t},G=e=>{let t=!0;for(let n of U)if(!(t=n.onSendMessage(e)))break;return t},V=e=>{let t=!0;for(let n of U)if(!(t=n.onControlMessage(e)))break;return t},K=(e,t,n)=>{let o=[];for(let r of U)r.onConnectionChange(e,t,n)||o.push(r);for(let e of o)F(e)},j=Date.now();return new Promise((o,a)=>{E[c]={registerHandler:x,unregisterHandler:F,sendMessage:e=>{if(G(e)){var t;null==(t=E[c])||t.connection.sendMessage(e)}},connection:new y({connectionId:S,additionalProtocolParams:A,skipPingEnabled:eh,onMessage:o=>{var r;S===(null==(r=E[c])?void 0:r.connectionId)&&(Q?B(o)&&tv({type:"RECEIVE_MESSAGE",id:e,role:t,secondaryRoles:n,message:o,pageMode:l}):tv({type:"RECEIVE_MESSAGE",id:e,role:t,secondaryRoles:n,message:o,pageMode:l}))},onControlMessage:o=>{var r,a;S===(null==(r=E[c])?void 0:r.connectionId)&&(Q?V(o)&&tv({type:"RECEIVE_CONTROL_MESSAGE",id:e,role:t,secondaryRoles:n,message:o,isNotebookRestartKernelEnabled:es,pageMode:l,updatePackageTimeoutId:tu.current,getDocsUrl:eN}):tv({type:"RECEIVE_CONTROL_MESSAGE",id:e,role:t,secondaryRoles:n,message:o,isNotebookRestartKernelEnabled:es,updatePackageTimeoutId:tu.current,pageMode:l,getDocsUrl:eN}),O.logWebsocketControlMessage(e,{connectionId:S,notebookViewId:null==g||null==(a=g.sessionLifecycleState)?void 0:a.notebookViewId,notebookRuntime:_,messageJson:o.toJSON(),pageMode:l}))},onConnectionError:o=>{var r,i;if(S!==(null==(r=E[c])?void 0:r.connectionId))return;let s="string"==typeof o?o:"Unknown error";O.logWebsocketConnectError(e,{connectionId:S,notebookViewId:null==g||null==(i=g.sessionLifecycleState)?void 0:i.notebookViewId,notebookRuntime:_,error:s,pageMode:l,isReconnect:!!L,reconnectInstanceId:null!=b?b:void 0},{event:eE.x5,markers:M}),tv({type:"WEBSOCKET_CONNECTION_ERROR",id:e,role:t,secondaryRoles:n,error:s,pageMode:l}),a()},connectionStateChanged:(r,s,u)=>{var d,f,p,h,m,T,R;if(S===(null==(d=E[c])?void 0:d.connectionId))switch(K(r,s,u),r){case C.e.CONNECTED:tv({type:"WEBSOCKET_CONNECTED",id:e,role:t,secondaryRoles:n,idOfAlreadyRunningInstance:null!=b?b:void 0,pageMode:l,streamlitVersionOfAlreadyRunningInstance:null==w?void 0:w.streamlitVersionOfAlreadyRunningInstance}),D&&tv({type:"START_NOTEBOOK",id:e,role:t,secondaryRoles:n,userTriggered:!1,pageMode:l,isReplayingMessagesAfterReconnect:!0}),i&&tv({type:"START_FETCHING_CACHED_RESULTS",id:e,role:t,secondaryRoles:n,pageMode:l}),O.logWebsocketConnected(e,{connectionId:S,notebookViewId:null==g||null==(f=g.sessionLifecycleState)?void 0:f.notebookViewId,notebookRuntime:_,connectionState:"CONNECTED",reason:u,error:s,isReconnect:!!L,reconnectInstanceId:null!=b?b:void 0,pageMode:l},{event:eE.x5,markers:M}),I.v.addDurationVital(eE.P7,{startTime:j,duration:Date.now()-j,context:{isReconnect:!!L,reconnectInstanceId:null!=b?b:void 0,skipPingEnabled:eh}}),o();break;case C.e.DISCONNECTED_FOREVER:tv({type:"WEBSOCKET_DISCONNECTED",id:e,role:t,secondaryRoles:n,pageMode:l,reason:u}),null==(p=e6.current)||p.stop(),e6.current=null,W&&e2(-1),O.logWebsocketDisconnected(e,{connectionId:S,notebookViewId:null==g||null==(h=g.sessionLifecycleState)?void 0:h.notebookViewId,notebookRuntime:_,connectionState:r,reason:u,error:s,isReconnect:!!L,reconnectInstanceId:null!=b?b:void 0,pageMode:l},{event:eE.x5,markers:M}),u===ef.w.NOTEBOOK_IDLE_TIMEOUT&&O.logSessionEnd(e,{connectionId:S,notebookViewId:null==g||null==(m=g.sessionLifecycleState)?void 0:m.notebookViewId,sessionStartId:null==g||null==(T=g.sessionLifecycleState)?void 0:T.sessionStartId,notebookRuntime:_,connectionState:r,reason:u,error:s,isReconnectEnabled:!0,pageMode:l}),a();break;default:O.logWebsocketConnectionStateChange(e,{connectionId:S,notebookViewId:null==g||null==(R=g.sessionLifecycleState)?void 0:R.notebookViewId,notebookRuntime:_,connectionState:r,reason:u,error:s,isReconnect:!!L,reconnectInstanceId:null!=b?b:void 0,pageMode:l})}},claimHostAuthToken:async()=>await eD({id:e,role:t,secondaryRoles:n,queryId:r,isHistoryQueryResultEnabled:P}),resetHostAuthToken:h.EI,setAllowedOriginsResp:h.EI,baseUriParts:N.baseUriParts,isHttps:N.isHttps,isLargeMessageCacheEnabled:k,createWebSocket:(e,t)=>H&&$?new ec.LU(e,t):new WebSocket(e,t)}),urlInfo:N,connectionId:S}})}),eP=(0,r.z)((e,t,n,o)=>{var r;let a=(0,eS.E)(e,t,n),i=null==(r=eg.current[a])?void 0:r.connection;i&&(null==i||i.disconnect(o),eg.current[a]=void 0)}),ex=(0,r.z)(async(t,n)=>{var o,r,i;let{id:l,role:s,secondaryRoles:u,cellRunType:d,runCellId:c,cells:E,clientState:f,eventType:S,notebookRuntime:g,pageMode:_}=t,h=(0,eS.E)(l,s,u);(1===d||7===d)&&O.markEventStart(eE.bZ,(0,p.m)(l)),E.forEach(e=>{var t,n;O.markEventStart(eE.QX,null!=(t=e.id)?t:""),O.markE2EEventStart(eE.QX,null!=(n=e.id)?n:"")});let m=tN(l,s,u),I=eg.current[h];if(void 0===I||I.connection.isDisconnected()){try{await eU({id:l,role:s,secondaryRoles:u,pageMode:_}),I=eg.current[h]}catch(e){}if(eu&&I){let{settingsUpdateTime:e,settings:t}=null!=(o=null==m?void 0:m.notebookSessionSettingsState)?o:{};e&&t&&I.connection.sendControlMessage({clientControlRequest:{executeConfigurationUpdateRequest:{runtime:t.runtimeName,queryWarehouse:t.queryWarehouse,codeWarehouse:t.codeWarehouse,computePool:t.computePool,externalIntegrations:t.externalAccessIntegrations,roleSelection:L(t.role,t.secondaryRoles),idleShutdownSecs:t.idleAutoShutdownTimeSeconds,...t.mainFilePath?{mainFile:t.mainFilePath}:{}}}})}}else try{await I.connection.waitForConnection()}catch(e){}if(void 0!==I&&I.connection.isConnected()){let e={cellRunType:d,cellUpdateSemantics:1,cellInteractionSemantics:+!Y,runCellId:c};z&&(e={...e,userErrorHandlingSemantics:0}),Q?I.sendMessage({runCells:{...e,cells:E,clientState:f}}):I.connection.sendMessage({runCells:{...e,cells:E,clientState:f}}),O.logRunRequested(l,{...e,connectionId:I.connectionId,notebookViewId:null==m||null==(i=m.sessionLifecycleState)?void 0:i.notebookViewId,notebookRuntime:g,runId:c,pageMode:_},null!=S?S:"ui_click")}else(0,a.w)({content:e({id:"Connection is not ready yet"}),type:"alert",autoDismiss:!1}),O.logRunRequestedError(l,{error:"Connection is not ready yet",connectionId:(null==I?void 0:I.connectionId)||"",notebookViewId:null==m||null==(r=m.sessionLifecycleState)?void 0:r.notebookViewId,notebookRuntime:g,pageMode:_,runId:c},null!=S?S:"ui_response_error"),n({type:"RUN_NOTEBOOK_FAILED",id:l,role:s,secondaryRoles:u,pageMode:_})}),eF=(0,e0.q)(eg.current,e=>{e.connection.isConnected()&&(Q?e.sendMessage({controlRequest:{cancelExecution:{cancelType:0}}}):e.connection.sendMessage({controlRequest:{cancelExecution:{cancelType:0}}}))}),eB=(0,e0.q)(eg.current,e=>{V&&e.connection.isConnected()&&(Q?e.sendMessage({controlRequest:{resourceUtilization:{resourceTypes:[0,1]}}}):e.connection.sendMessage({controlRequest:{resourceUtilization:{resourceTypes:[0,1]}}}))}),eG=(0,e0.q)(eg.current,(e,t,n)=>{var o,r,a;let{id:i,role:l,secondaryRoles:s,pageMode:u}=t,d=null==(o=tN(i,l,s))?void 0:o.notebookState,c=null==d||null==(a=d.data)||null==(r=a.cells)?void 0:r.filter(e=>"markdown"!==e.cell_type).map(e=>({cellId:e.id}));if(O.markEventStart(eE.bZ,(0,p.m)(i)),null==c||c.forEach(e=>{O.markEventStart(eE.QX,e.cellId)}),e.connection.isConnected()&&c&&c.length>0){let t=f.Z();n({type:"START_FETCHING_CACHE_RESULT",id:i,role:l,secondaryRoles:s,pageMode:u,cacheLoadId:t}),Q?e.sendMessage({previousResults:{warmStart:!1,cellIds:c}}):e.connection.sendMessage({previousResults:{warmStart:!1,cellIds:c}}),setTimeout(()=>{n({type:"FETCHING_CACHE_TIMED_OUT",id:i,role:l,secondaryRoles:s,pageMode:u,cacheLoadId:t})},1e3*G)}}),eV=(0,d.useCallback)((e,t,n)=>{ex(t,n)},[ex]),eK=(0,d.useCallback)((t,n)=>{var o,r;n.silent||(0,a.w)({content:(r=n.error.replace(/Stack trace[\s\S]*/iu,"").trim(),Object.keys(ep._y).includes(r)?(0,ep.Ex)(r,e):e({id:"Something went wrong. {message}"},{message:r})),type:"alert",autoDismiss:!1}),(null==(o=n.logError)||o)&&(O.logError({notebookIdentifier:(0,p.m)(n.id),error:n.error,pageMode:n.pageMode}),i.cM.error(n.error))},[e,O]),eW=(0,d.useCallback)((e,t)=>{H?s({type:"externalAccessIntegrationError",fullNotebookIdentifier:t.id}):n((0,o.jsx)(A.z,{fullNotebookIdentifier:t.id,hide:l})),O.logError({notebookIdentifier:(0,p.m)(t.id),error:t.error,pageMode:t.pageMode}),i.cM.warn(t.error)},[H,O,s,n,l]),eH=(0,r.z)(e=>{n((0,o.jsx)(N.W,{urlData:{region:eT,org:eR},sourceFullNotebookIdentifier:e,hideLayer:l}))}),e$=(0,r.z)((e,t)=>{var r,a;let{id:i,role:u,secondaryRoles:d,saveEligibilityCheckStatus:c,editingUserName:E,editingUserEmail:f}=t,p=tN(i,u,d);H?s({type:"concurrentEditAlert",saveEligibilityCheckStatus:c,editingUserName:E,editingUserEmail:f,notebookViewId:null==p||null==(r=p.sessionLifecycleState)?void 0:r.notebookViewId,fullNotebookIdentifier:i,role:u,region:eT,org:eR}):n((0,o.jsx)(eY.n,{hide:l,role:u,saveEligibilityCheckStatus:c,editingUserName:E,editingUserEmail:f,fullNotebookIdentifier:i,onDuplicateNotebook:eH,notebookViewId:null==p||null==(a=p.sessionLifecycleState)?void 0:a.notebookViewId,notebookRuntime:null==p?void 0:p.notebookRuntime}))}),eQ=(0,e0.q)(eg.current,(e,t)=>{var n;if(!es)return;e.connection.sendMessage({controlRequest:{restartKernelRequest:{restartKernel:!0}}});let{id:o,role:r,secondaryRoles:a,pageMode:i}=t,l=tN(o,r,a);O.logKernelRestartBegin(o,{connectionId:e.connectionId,notebookViewId:null==l||null==(n=l.sessionLifecycleState)?void 0:n.notebookViewId,notebookRuntime:null==l?void 0:l.notebookRuntime,pageMode:i})}),ez=(0,r.z)((e,t)=>{var n,o;let{id:r,role:a,secondaryRoles:i}=t,l=(0,eS.E)(r,a,i),s=eg.current[l],u=null==s?void 0:s.connection,d=(null==u?void 0:u.getConnectionId())||"UNKNOWN",c=tN(r,a,i),E=null==c||null==(n=c.sessionLifecycleState)?void 0:n.latestUserInteractionTime;if(O.logWebsocketHeartbeat(r,{connectionId:d,notebookViewId:null==c||null==(o=c.sessionLifecycleState)?void 0:o.notebookViewId,isConnected:(null==u?void 0:u.isConnected())||!1,isEnableIdleHeartbeat:x,idleHeartbeatTimeoutSeconds:F,isNotebookRunning:(null==c?void 0:c.runStatus)==="running"},{event:eE.wT,markers:[d]}),!(null==u?void 0:u.isConnected()))return!1;let f=Date.now();return Q?null==s||s.sendMessage({heartbeatRequest:{browserState:E&&f-E<=6e4?1:0}}):u.sendMessage({heartbeatRequest:{browserState:E&&f-E<=6e4?1:0}}),console.debug("[Notebook] Heartbeat sent with browser state: ",E&&f-E<=6e4?"ACTIVE":"IDLE"),!0}),eZ=(0,d.useMemo)(()=>u()(ez,e_/5||6e4,{leading:!0}),[e_,ez]),eJ=(0,d.useRef)(-1),e3=(0,d.useRef)(null),e2=(0,d.useCallback)(e=>{var t;eJ.current=e,null==(t=e3.current)||t.call(e3,e)},[]),e7=(0,d.useCallback)(async e=>{let{id:n,role:o,secondaryRoles:r}=e,a=await t(n,o,r);return(null==a?void 0:a.idleAutoShutdownTimeSeconds)||F||e_/1e3||D.K7},[t,F,e_]),e5=(0,d.useCallback)(async e=>{let{unsetNull:t,effect:n}=e;if(null==eJ.current&&!t)return;let o=await e7(n);K?e2(new Date().getTime()+1e3*o):e2(new Date().getTime()+Math.max(1e3*o-(e_||0),0))},[e7,K,e2,e_]),e9=(0,r.z)((e,t)=>{x?e5({effect:t}):eZ(e,t)}),e8=(0,d.useCallback)(()=>{e2(null)},[e2]),e6=(0,d.useRef)(null),te=(0,r.z)((e,t)=>{var n,o,r;if(x&&(e8(),e6.current))return void e6.current.restart();let{id:a,role:i,secondaryRoles:l}=t,s=(0,eS.E)(a,i,l),u=tN(a,i,l),d=null==(n=eg.current[s])?void 0:n.connection.getConnectionId();e6.current&&(O.logWebsocketHeartbeatEnd(a,{connectionId:d,notebookViewId:null==u||null==(r=u.sessionLifecycleState)?void 0:r.notebookViewId,isEnableIdleHeartbeat:x,idleHeartbeatTimeoutSeconds:F},{event:eE.wT,markers:[d||"UNKNOWN"]}),e6.current.stop()),O.logWebsocketHeartbeatStart(a,{connectionId:d,notebookViewId:null==u||null==(o=u.sessionLifecycleState)?void 0:o.notebookViewId,isEnableIdleHeartbeat:x,idleHeartbeatTimeoutSeconds:F});let c=(0,S.zp)(()=>{let n=!0;console.debug("Running heartbeater loop ",eJ.current),console.debug("Sending heartbeat"),console.debug("Received response from heartbeat: ",n=ez(e,{...t})),n||(K?console.debug("No heartbeat sent but continuing to keep the heartbeat active."):(console.debug("Stopping heartbeater because no heartbeat was sent ",{heartbeatPollEndTimeMs:null==eJ?void 0:eJ.current}),c.stop()))},{pollingIntervalInSec:60,shouldPauseOnInactive:!1});e6.current=c,c.start()}),tt=(0,d.useCallback)((e,t)=>{var n,o;let{id:r,role:a,secondaryRoles:i}=t,l=(0,eS.E)(r,a,i),s=null==(n=eg.current[l])?void 0:n.connection.getConnectionId();x?e5({unsetNull:!0,effect:t}):(O.logWebsocketHeartbeatEnd(r,{connectionId:s,isEnableIdleHeartbeat:x,idleHeartbeatTimeoutSeconds:F},{event:eE.wT,markers:[s||"UNKNOWN"]}),null==(o=e6.current)||o.stop())},[x,F,O,e5]),tn=eX({websocketMapRef:eg}),to=(0,r.z)(async e=>{var t,n,o;let{id:r,role:a,secondaryRoles:i,isContainerRuntime:l,reason:s,pageMode:u}=e,d=(0,eS.E)(r,a,i),c=tN(r,a,i),E=null==(t=eg.current[d])?void 0:t.connection,f=(null==E?void 0:E.getConnectionId())||"";(0,R.H$)(eE.Sc,(0,p.m)(r),f),eP(r,a,i,"USER_NOTEBOOK_SHUTDOWN"),await ew({id:r,role:a,secondaryRoles:i}),O.logSessionEnd(r,{connectionId:f,notebookViewId:null==c||null==(n=c.sessionLifecycleState)?void 0:n.notebookViewId,sessionStartId:null==c||null==(o=c.sessionLifecycleState)?void 0:o.sessionStartId,reason:s,notebookRuntime:l?"spcs":"wh",isReconnectEnabled:!0,pageMode:u})}),tr=(0,r.z)((e,t)=>{to({...t,reason:"USER_NOTEBOOK_SESSION_SHUTDOWN"})}),ta=(0,r.z)(async(e,t)=>{let{id:n,role:o,secondaryRoles:r,isContainerRuntime:a,pageMode:i}=e;await to({...e,type:"shutdownNotebook",isContainerRuntime:a,reason:"NOTEBOOK_SESSION_RESTART"}),t({id:n,role:o,secondaryRoles:r,type:"START_NOTEBOOK",userTriggered:!0,isReplayingMessagesAfterReconnect:!1,pageMode:i})}),ti=(0,r.z)((e,t,n)=>{ta(t,n)}),tl=(0,d.useCallback)((e,t)=>{let{notificationProps:n,notificationRefCallback:o}=t;if(n.content){let e=(0,a.w)(n);null==o||o(e)}},[]),ts=(0,d.useRef)(""),tu=(0,d.useRef)(),td=(0,e0.q)(eg.current,(e,t,n)=>{if(!e.connection.isConnected())return;let{id:o,role:r,secondaryRoles:a,data:i,isContainerRuntime:l,imports:s,pageMode:u}=t;if(i&&e.connection.sendControlMessage({clientControlRequest:{updateCondaEnvironment:{packageSpec:i.dependencies}}}),l&&void 0!==s){let t=f.Z();ts.current=t,Q?e.sendMessage({controlRequest:{installPackage:{importUrls:s},requestId:t}}):e.connection.sendMessage({controlRequest:{installPackage:{importUrls:s},requestId:t}})}clearTimeout(tu.current),tu.current=setTimeout(()=>{n({type:"UPDATE_PACKAGE_FAILED",id:o,role:r,secondaryRoles:a,pageMode:u})},1e3*j)}),tc=(0,e0.q)(eg.current,(e,t,n)=>{if(!e.connection.isConnected())return;let{id:o,role:r,secondaryRoles:a,executionConfiguration:i}=t,l=tN(o,r,a),{mainFilePath:s}=i;(null==l?void 0:l.udfConnectionStatus)!==ef.Q.Connected?e.connection.sendControlMessage({clientControlRequest:{executeConfigurationUpdateRequest:{runtime:i.runtimeName,queryWarehouse:i.queryWarehouse,codeWarehouse:i.codeWarehouse,computePool:i.computePool,externalIntegrations:i.externalAccessIntegrations,roleSelection:L(i.role,i.secondaryRoles),idleShutdownSecs:i.idleAutoShutdownTimeSeconds,...s?{mainFile:s}:{}}}}):e.connection.sendControlMessage({clientControlRequest:{updateSessionSettingsRequest:{sessionSettings:{queryWarehouse:i.queryWarehouse,role:L(i.role,i.secondaryRoles),idleTimeoutSecs:i.idleAutoShutdownTimeSeconds}}}})}),tE=(0,e0.q)(eg.current,(e,t,n)=>{if(!eu||!e.connection.isConnected())return;let{id:o,role:r,secondaryRoles:a}=t,i=tN(o,r,a);(null==i?void 0:i.udfConnectionStatus)===ef.Q.Connected&&e.connection.sendControlMessage({clientControlRequest:{getSessionSettingsRequest:{}}})}),tf=(0,r.z)((e,t,n)=>{let{id:o,role:r,secondaryRoles:a,requestId:l,status:s,pageMode:u}=t,d=ts.current;ts.current="",""!==d&&d===l&&(0===s?n({type:"UPDATE_PACKAGE_DONE",id:o,role:r,secondaryRoles:a,pageMode:u}):1===s?n({type:"UPDATE_PACKAGE_FAILED",id:o,role:r,secondaryRoles:a,pageMode:u}):i.cM.warn(`Unknown status response for package import update: ${s}`))}),tp=(0,d.useCallback)((e,t,n)=>{let{id:o,role:r,secondaryRoles:a,queryId:i,pageMode:l}=t,s=(0,eS.E)(o,r,a),u=eg.current[s];(null==u?void 0:u.connection.isConnected())?n({type:"START_NOTEBOOK",id:o,role:r,secondaryRoles:a,userTriggered:!1,isReplayingMessagesAfterReconnect:!0,pageMode:l}):eU({id:o,role:r,secondaryRoles:a,urlInfo:void 0,queryId:i,pageMode:l})},[eU]),tS=(0,d.useCallback)((e,t,n)=>{let{id:o,role:r,secondaryRoles:a,queryId:i,connectExistingSession:l,loadCachedResultsAfterConnection:s,pageMode:u}=t,d=(0,eS.E)(o,r,a),c=eg.current[d];(null==c?void 0:c.connection.isConnected())||eU({id:o,role:r,secondaryRoles:a,queryId:i,urlInfo:void 0,connectExistingSession:l,loadCachedResultsAfterConnection:s,pageMode:u})},[eU]),tg=(0,r.z)((e,t)=>{let{id:n,sessionSettings:o,pageMode:r}=t;ev({notebookId:n,sessionSettings:o,pageMode:r})}),t_=(0,d.useCallback)((t,n,o)=>{let{id:r,role:i,secondaryRoles:l,queryId:s,onlineToSnowflakeServer:u,pageMode:d}=n,c=(0,eS.E)(r,i,l);if(u){var E;null==(E=em.current)||E.hide(),em.current=null;let e=eg.current[c];(null==e?void 0:e.connection.isConnected())||eU({id:r,role:i,secondaryRoles:l,urlInfo:null==e?void 0:e.urlInfo,queryId:s,pageMode:d});return}em.current||(em.current=(0,a.w)({content:e({id:"Notebook connection lost. Check your internet or wifi connection."}),type:"alert",autoDismiss:!1,onDismiss:()=>{em.current=null}}),eP(r,i,l,"NETWORK_DOWN"))},[eP,e,eU]),th=(0,d.useRef)([]),tm=(0,d.useCallback)(e=>(th.current.push(e),function(){let t=th.current.indexOf(e);t<0||th.current.splice(t,1)}),[]),tI=(0,v.S)(eg.current,10*G),tT=ed(),tR=(0,r.z)((e,t)=>{tT(t.notebookEditorState)}),tC=(0,r.z)((e,t,r)=>{H?s({type:"packageUpdateAlert"}):n((0,o.jsx)(w.S,{hide:l,restart:()=>r({type:"RESTART_NOTEBOOK",id:t.id,role:t.role,secondaryRoles:t.secondaryRoles,isContainerRuntime:!1,pageMode:t.pageMode})}))}),[ty,tv]=(0,E.M)(ej(th.current,$,H),{},{readFromStage:eA,writeToStage:eb,writeToStageThrottled:eO,runCells:eV,onNotebookError:eK,fetchCachedResults:eG,saveResultHeight:eq,triggerUserInteractionKeepalive:e9,startRunningNotebookHeartbeat:te,stopRunningNotebookHeartbeat:tt,shutdownNotebook:tr,restartNotebook:ti,cancelExecution:eF,fetchResourceUsage:eB,restartNotebookKernel:eQ,pushNotification:tl,updatePackage:td,controlResponseStatus:tf,onExternalAccessIntegrationError:eW,onNotebookConcurrentEditAlert:e$,reconnectSession:tp,connectWebsocket:tS,networkConditionChanged:t_,syncNotebookEditorState:tR,saveNotebookSessionSettings:tg,updateExecuteConfiguration:tc,openPackageUpdateAlert:tC,fetchLatestNotebookSessionSettings:tE,...tI,...tn}),tN=(0,d.useCallback)((e,t,n)=>ty[(0,eS.E)(e,t,n)],[ty]),tA=(0,d.useCallback)(e=>{e3.current=e},[]),tb=(0,d.useCallback)((e,t,n)=>{let o=(0,eS.E)(e,t,n);return eg.current[o]},[]);return(0,d.useMemo)(()=>({getNotebookEditorState:tN,dispatchNotebookEditorStatesMap:tv,connectToWebSocket:eU,disconnectWebsocket:eP,subscribe:tm,setHeartbeatPollEndTimeUpdateCallback:tA,getWebsocketConnection:tb}),[eU,eP,tv,tN,tm,tA,tb])})()),e7=e2,e5=function({children:e}){return(0,o.jsx)(M.U,{children:(0,o.jsx)(e3,{children:e})})};e5.displayName="NotebookEditorGlobalProvider";let e9=()=>({cellRunStatus:"neverRun",pushdownQueries:[],startedAt:void 0,endAt:void 0,cellRunStatusBeforeExecution:"neverRun"}),e8=()=>({status:e9(),message:[]})},509983:function(e,t,n){n.d(t,{v:()=>f});var o=n(411733),r=n(399808),a=n(825725),i=n(237911),l=n(766120),s=n(483196),u=n(946723),d=n(432405),c=n(135392),E=n(226309);class f{swapCell(e,t){return new f((0,r.ZP)(this.data,n=>{let o=n.cells;return e>=0&&e<o.length&&t>=0&&t<o.length&&([o[e],o[t]]=[o[t],o[e]]),n}),this.options)}static fromJson(e,t){let{enforceUUIDAsCellId:n=!1,enableConvertRawToMarkdown:o=!1,enableSafeCellIdGeneration:r=!1,convertRawToMarkdown:a=!1,isCellNameAndVariableConflictDetectionEnabled:i=!1}=t||{};try{let l=JSON.parse(e),u=(0,c.J)(l,{enforceUUIDAsCellId:n,enableConvertRawToMarkdown:o,enableSafeCellIdGeneration:r,convertRawToMarkdown:a});for(let e of u.cells)e.result=(0,E.Hx)();let d=!1;return i&&s.bW.pythonModule&&(u.globalVariableDefiningCellsCount=f.analyzeGlobalVars(u.cells),d=!0),new f(u,{...null!=t?t:{},globalVariablesAnalyzed:d})}catch(e){if(e instanceof c.m)throw e;throw Error(`Failed to parse nbformat string. ${null==e?void 0:e.message}`)}}toJson(){let e=[];for(let t of this.data.cells){let{result:n,...o}=t;e.push(o)}return JSON.stringify({metadata:this.data.metadata,nbformat_minor:this.data.nbformat_minor,nbformat:this.data.nbformat,cells:e},null,1)}static analyzeGlobalVars(e){let t={};for(let n of e)(0,i.ro)(n)&&(0,s.a_)((0,d.V)(n)).forEach(e=>{t[e]=(t[e]||0)+1});return t}checkAndAnalyzeGlobalVars(e){s.bW.pythonModule&&!this.options.globalVariablesAnalyzed&&(e.globalVariableDefiningCellsCount=f.analyzeGlobalVars(e.cells),this.options.globalVariablesAnalyzed=!0)}addCell(e,t){return new f((0,r.ZP)(this.data,n=>{if(this.options.isCellNameAndVariableConflictDetectionEnabled&&this.checkAndAnalyzeGlobalVars(n),n.cells.splice(e,0,t),this.options.isCellNameAndVariableConflictDetectionEnabled&&(0,i.ro)(t)){let e=(0,s.a_)((0,d.V)(t));n.globalVariableDefiningCellsCount||(n.globalVariableDefiningCellsCount={}),e.forEach(e=>{n.globalVariableDefiningCellsCount[e]=(n.globalVariableDefiningCellsCount[e]||0)+1})}}),this.options)}removeCell(e){return new f((0,r.ZP)(this.data,t=>{this.options.isCellNameAndVariableConflictDetectionEnabled&&this.checkAndAnalyzeGlobalVars(t);let n=t.cells[e];if(t.cells.splice(e,1),this.options.isCellNameAndVariableConflictDetectionEnabled&&(0,i.ro)(n)){let e=(0,s.a_)((0,d.V)(n));t.globalVariableDefiningCellsCount||(t.globalVariableDefiningCellsCount={}),e.forEach(e=>{t.globalVariableDefiningCellsCount[e]&&(t.globalVariableDefiningCellsCount[e]-=1)})}}),this.options)}insertBefore(e,t){return new f((0,r.ZP)(this.data,n=>{if(e<0||e>=n.cells.length||t<0||t>=n.cells.length)return;let[o]=n.cells.splice(e,1);n.cells.splice(t,0,o)}),this.options)}moveCellUp(e){return this.swapCell(e,e-1)}moveCellDown(e){return this.swapCell(e,e+1)}modifyCell(e,t){return new f((0,r.ZP)(this.data,n=>{this.options.isCellNameAndVariableConflictDetectionEnabled&&this.checkAndAnalyzeGlobalVars(n);let o=(0,d.V)(n.cells[e]);if(n.cells[e].source=t,this.options.isCellNameAndVariableConflictDetectionEnabled&&(0,i.ro)(n.cells[e])){let e=(0,s.a_)(t),r=(0,s.a_)(o),a=[...e].filter(e=>!r.has(e)),i=[...r].filter(t=>!e.has(t));n.globalVariableDefiningCellsCount||(n.globalVariableDefiningCellsCount={}),a.forEach(e=>{n.globalVariableDefiningCellsCount[e]=(n.globalVariableDefiningCellsCount[e]||0)+1}),i.forEach(e=>{n.globalVariableDefiningCellsCount[e]&&(n.globalVariableDefiningCellsCount[e]-=1)})}}),this.options)}updateCellResult(e,t){let n=this.cellIndexById[e];if(void 0===n)return o.cM.warn("can not find cell corresponding to the cellId"),this;let a={...this.data.cells[n].result,...t};return new f((0,r.ZP)(this.data,e=>{e.cells[n].result=a}),this.options)}updateCellStatus(e,t){let n=this.cellIndexById[e];if(void 0===n)return o.cM.warn("can not find cell corresponding to the cellId"),this;let a={...this.data.cells[n].result.status,...t};return new f((0,r.ZP)(this.data,e=>{e.cells[n].result.status=a}),this.options)}updatePredictExecutionId(e){let t=this.cellIndexById[e];return void 0===t?(o.cM.warn("can not find cell corresponding to the cellId"),this):new f((0,r.ZP)(this.data,e=>{var n;let o=null!=(n=(0,r.Js)(e.cells))?n:[],a=t>0?o[t-1].result.executionId:void 0;for(let n=t;n<o.length;n++){let t=(0,u.b)(a,e.cells[n].result.selfContentHash,e.cells[n].result.runId);e.cells[n].result.predictedExecutionId=t,a=t}}),this.options)}setLanguage(e,t){return new f((0,r.ZP)(this.data,n=>{let o=n.cells[e],r=(0,i.ro)(o);if(this.options.isCellNameAndVariableConflictDetectionEnabled&&this.checkAndAnalyzeGlobalVars(n),(0,i.NT)(o)&&"markdown"!==t?n.cells[e]=function(e,t){let n=(0,l.B)(t,e.metadata.name);return n.metadata.collapsed=e.metadata.collapsed,n.metadata.codeCollapsed=e.metadata.collapsed,n.source=e.source,n.id=e.id,n}(o,t):(0,i.M1)(o)&&"markdown"===t?n.cells[e]=function(e){let t=(0,l.B)("markdown",e.metadata.name);return t.metadata.collapsed=e.metadata.collapsed&&e.metadata.codeCollapsed,t.source=e.source,t.id=e.id,t}(o):(0,i.M1)(o)&&"markdown"!==t&&(o.metadata.language=t),n.globalVariableDefiningCellsCount||(n.globalVariableDefiningCellsCount={}),r||"python"!==t){if(r&&"python"!==t){let t=(0,d.V)(n.cells[e]);(0,s.a_)(t).forEach(e=>{n.globalVariableDefiningCellsCount[e]&&(n.globalVariableDefiningCellsCount[e]-=1)})}}else{let t=(0,d.V)(n.cells[e]);(0,s.a_)(t).forEach(e=>{n.globalVariableDefiningCellsCount[e]=(n.globalVariableDefiningCellsCount[e]||0)+1})}}),this.options)}setWarehouse(e,t){return new f((0,r.ZP)(this.data,n=>{let o=n.cells[e];if(!(0,i.XN)(o))throw Error("setting warehouse on non-SQL cell not yet supported");o.metadata.EXECUTION_WAREHOUSE=t}),this.options)}setContentState(e,t){return new f((0,r.ZP)(this.data,n=>{if(void 0!==e){let o=n.cells[e];void 0!==t.collapsed&&(o.metadata.collapsed=t.collapsed),(0,i.M1)(o)&&void 0!==t.codeCollapsed&&(o.metadata.codeCollapsed=t.codeCollapsed)}else{let e=this.data.cells;for(let o=0;o<e.length;o++){let e=n.cells[o];void 0!==t.collapsed&&(e.metadata.collapsed=t.collapsed),(0,i.M1)(e)&&void 0!==t.codeCollapsed&&(e.metadata.codeCollapsed=t.codeCollapsed)}}}),this.options)}updateLastEditStatus(e){return new f((0,r.ZP)(this.data,t=>{t.metadata.lastEditStatus=e}),this.options)}renameCell(e,t){return new f((0,r.ZP)(this.data,n=>{n.cells[e].metadata.name=t}),this.options)}getCellsProto(){let e=[];for(let n of this.data.cells){var t;let{id:o,metadata:r,cell_type:a,source:i}=n,l={};for(let e in r)("string"==typeof r[e]||r[e]instanceof String)&&(l[e]=r[e]);e.push({id:o,name:null!=(t=r.name)?t:"",metadata:l,type:"code"===a?r.language:a,code:"string"==typeof i?i:i.join(""),outputFormat:r.outputFormat})}return e}getCellIndexById(e){return this.cellIndexById[e]}getCellById(e){return this.data.cells[this.cellIndexById[e]]}getCellResult(e){var t;return null==(t=this.getCellById(e))?void 0:t.result}getCellResultSize(e){var t;return(0,a.Q)(null==(t=this.getCellResult(e))?void 0:t.message)}getCellResultQueryId(e){var t,n,o;let r=null==(t=this.getCellResult(e))?void 0:t.status,[a]=null!=(n=null==r?void 0:r.pushdownQueries)?n:[];return null!=(o=null==a?void 0:a.queryId)?o:void 0}getLastEditStatus(){var e,t;return null==(t=this.data)||null==(e=t.metadata)?void 0:e.lastEditStatus}getGlobalVariables(){var e;return null!=(e=this.data.globalVariableDefiningCellsCount)?e:{}}clearAllResults(){let e=this.data.cells;return new f((0,r.ZP)(this.data,t=>{for(let n=0;n<e.length;n++)t.cells[n].result=(0,E.Hx)()}),this.options)}clearAllExecutionStates(){let e=this.data.cells;return new f((0,r.ZP)(this.data,t=>{for(let n=0;n<e.length;n++)"neverRun"!==t.cells[n].result.status.cellRunStatus&&(t.cells[n].result.status.cellRunStatus="idle")}),this.options)}isAllCellsExpanded(){let e=!0;return this.data.cells.forEach(t=>{(0,i.M1)(t)&&t.metadata.codeCollapsed&&t.metadata.collapsed&&(e=!1),(0,i.NT)(t)&&t.metadata.collapsed&&(e=!1)}),e}isCellResultCollapsed(e){var t;let n=this.cellIndexById[e];return!!(null==(t=this.data.cells[n])?void 0:t.metadata.collapsed)}constructor(e,t={}){this.data=e,this.options=t,this.cellIndexById={};for(let t=0;t<e.cells.length;t++){let n=e.cells[t];this.cellIndexById[n.id]=t}}}},574883:function(e,t,n){n.d(t,{n:()=>C});var o=n(286204),r=n(463198),a=n(887463),i=n(60575),l=n(493076),s=n(173624),u=n(440993),d=n(70734),c=n(314040),E=n(90373),f=n(856631),p=n(357139),S=n(938687),g=n(847345),_=n(797325),h=n(645952),m=n(468804),I=n(691352),T=n(700577),R=n(216591);let C=({hide:e,saveEligibilityCheckStatus:t,editingUserName:n,editingUserEmail:C,fullNotebookIdentifier:y,onDuplicateNotebook:v,notebookViewId:N,role:A,causalElement:b,notebookRuntime:O})=>{let L=(0,r.z)(()=>{w(y,m.DsD,{notebookViewId:N,saveEligibilityCheckStatus:t,pageMode:"ownerMode"},"ui_click"),window.location.reload()}),{formatMessage:k}=(0,_.Z)(),{logNotebookEditEvent:w}=(0,R.N)(),M="spcs"===O,D=T.i.UI_ENABLE_NOTEBOOK_DISABLED_SPCS_EXPERIENCE_FOR_ADMINS(),U=(0,g.useMemo)(()=>(0,o.jsxs)(a.s,{width:"100%",rowGap:12,children:[(0,o.jsx)(i.n,{color:l.Q2.primaryTextColor,children:k({id:"{userName}{emailPart} is editing this notebook."},{userName:(0,o.jsx)(s.x,{fontWeight:600,children:n}),emailPart:C?` (${C}) `:""})}),(0,o.jsx)(i.n,{color:l.Q2.primaryTextColor,marginTop:24,children:k({id:"To prevent overwriting each other, wait until {userName} stops editing for 1 minute. You can also duplicate this notebook to make your own copy."},{userName:n})})]}),[n,C,k]),P=(0,g.useMemo)(()=>(0,o.jsxs)(a.s,{width:"100%",rowGap:16,children:[(0,o.jsx)(i.n,{color:l.Q2.primaryTextColor,children:k({id:"{userName}{emailPart} recently edited this notebook. Reload to see their latest changes."},{userName:(0,o.jsx)(s.x,{fontWeight:600,children:n}),emailPart:C?` (${C}) `:""})}),(0,o.jsx)(u.j,{marginTop:16,theme:"yellow",icon:"warning-triangle",title:(0,o.jsx)(s.x,{color:l.Q2.statusWarningColor,fontSize:14,weight:500,children:k({id:"Reloading will discard your unsaved changes."})})})]}),[n,C,k]),x=(0,g.useMemo)(()=>(0,o.jsx)(i.n,{color:l.Q2.primaryTextColor,children:k({id:"You recently edited this notebook in another browser tab. Reload to see your latest changes."})}),[k]),F=(0,g.useCallback)(()=>{e(),v(y),w(y,m.$aC,{notebookViewId:N,saveEligibilityCheckStatus:t,pageMode:"ownerMode"},"ui_click")},[e,v,y,N,t,w]),B=(0,g.useCallback)(()=>{w(y,m.mBO,{notebookViewId:N,saveEligibilityCheckStatus:t,pageMode:"ownerMode"},"ui_click"),e()},[e,y,N,t,w]),G=(0,g.useMemo)(()=>{if("cannotSaveDueToRecentChangeFromSameUser"===t)return(0,o.jsx)(d.cN,{marginTop:8,children:(0,o.jsxs)(c.g,{children:[(0,o.jsx)(E.zx,{onClick:B,children:(0,o.jsx)(h.Z,{id:"Close"})}),(0,o.jsx)(E.zx,{use:"primary",onClick:L,marginLeft:8,children:(0,o.jsx)(h.Z,{id:"Reload notebook"})})]})});let e=M&&(0,I.e)(A)&&D,n=(0,o.jsx)(f.h,{onClick:e?void 0:F,textDecorationLine:"none",color:e?l.Q2.textButtonDisabledColor:l.Q2.textButtonColor,disabled:e,children:k({id:"Duplicate notebook"})});return(0,o.jsxs)(d.cN,{align:"justify",verticalAlign:"middle",marginTop:8,children:[e?(0,o.jsx)(p.u,{text:k({id:"Can't duplicate container notebooks using the ACCOUNTADMIN, SECURITYADMIN, or ORGADMIN roles. Try a different role."}),children:n}):n,(0,o.jsxs)(c.g,{children:[(0,o.jsx)(E.zx,{onClick:B,children:(0,o.jsx)(h.Z,{id:"Close"})}),"cannotSaveDueToRecentChangeFromOtherUser"===t&&(0,o.jsx)(E.zx,{use:"primary",onClick:L,marginLeft:8,children:(0,o.jsx)(h.Z,{id:"Reload notebook"})})]})]})},[t,F,D,L,k,B,M,A]);return(0,o.jsxs)(d.Vq,{manuallyShown:!0,behaviors:[S.O],onHide:e,causalElement:b,width:500,children:[(0,o.jsx)(d.fK,{children:(0,o.jsx)(h.Z,{id:"Can't save changes"})}),(0,o.jsxs)(d.a7,{marginBottom:12,children:["cannotSaveDueToEditLocked"===t&&U,"cannotSaveDueToRecentChangeFromOtherUser"===t&&P,"cannotSaveDueToRecentChangeFromSameUser"===t&&x]}),G]})};C.displayName="NotebookConcurrentEditAlertDialog"},596633:function(e,t,n){n.d(t,{d:()=>c});var o=n(700577),r=n(847345),a=n(640579),i=n(686762),l=n(134445);let s=({observerEnabled:e,visibleCallback:t})=>{(0,r.useEffect)(()=>{let n=()=>{e&&"visible"===document.visibilityState&&t&&t()};return document.addEventListener("visibilitychange",n),()=>{document.removeEventListener("visibilitychange",n)}},[e,t])};var u=n(316181),d=n(306490);let c=()=>{let{dataDiscoverRole:e,secondaryRoles:t}=(0,a.j)(),n=(0,l.m)(["user"]),c=o.i.UI_ENABLE_NOTEBOOK_FEATURE_38(),{localTimeToServerTime:f}=(0,d.h)(),p=(0,u.L)(),S=(0,r.useRef)(!1),g=(0,r.useCallback)(async n=>{var o;return null!=(o=JSON.parse(await p(n,e,t)).metadata.lastEditStatus)?o:null},[p,e,t]);return s({observerEnabled:c,visibleCallback:(0,r.useCallback)(()=>{S.current=!0},[])}),(0,r.useCallback)(async({id:e,urlId:t,currentNotebookViewId:o,lastEditStatusInMemory:r,lastestNotebookLoadTime:a})=>{let l=!1,s=r;if(!n.user.currentUserId)return{checkStatus:"cannotSaveDueToEditLocked",lastEditStatusRetrieved:null};let u=f();if(!(null==s?void 0:s.lastEditTime)||u-s.lastEditTime>6e4||c&&n.user.currentUserId===s.authorId&&s.sessionId!==o||S.current){if(s=await g(e),(0,i.IG)(i.cf.NOTEBOOK_EDIT_LOCK_CHECK)){var d;(null==r?void 0:r.lastEditTime)?u-(null!=(d=null==s?void 0:s.lastEditTime)?d:0)>6e4?console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Recent check expired, reload latest edit history from file: ",s):n.user.currentUserId===(null==s?void 0:s.authorId)&&s.sessionId!==o?console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Same user switched to a different session: ",s):S.current&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Notebook transit to focused state, reload latest edit history from file: ",s):console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] No in memory last edit status, load latest edit history from file: ",s)}l=!0,S.current&&(S.current=!1)}s&&s.notebookId===t||(s={notebookId:t,authorId:"",authorName:"",sessionId:o,lastEditTime:0},l=!0);let p="canSave",_=a?f(a):0;return u=f(),s.authorId===n.user.currentUserId?c&&_&&s.sessionId!==o&&_<s.lastEditTime?((0,i.IG)(i.cf.NOTEBOOK_EDIT_LOCK_CHECK)&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Recent edit was from the same user with changes from other sessions. lastEditTime: ",E(s.lastEditTime)," current time: ",E(u)," lastestNotebookLoadServerTime: ",E(_)),p="cannotSaveDueToRecentChangeFromSameUser"):((0,i.IG)(i.cf.NOTEBOOK_EDIT_LOCK_CHECK)&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Recent edit was from the same user. lastEditTime: ",E(s.lastEditTime)," current time: ",E(u)," lastestNotebookLoadServerTime: ",E(_)),p="canSave"):u-s.lastEditTime<=6e4?((0,i.IG)(i.cf.NOTEBOOK_EDIT_LOCK_CHECK)&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Active lock from different user. lastEditTime: ",E(s.lastEditTime)," current time: ",E(u)),p="cannotSaveDueToEditLocked"):_&&_<s.lastEditTime?((0,i.IG)(i.cf.NOTEBOOK_EDIT_LOCK_CHECK)&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Inactive Lock but has recent changes after previous load. lastEditTime: ",E(s.lastEditTime)," lastestNotebookLoadServerTime ",E(_)),p="cannotSaveDueToRecentChangeFromOtherUser"):((0,i.IG)(i.cf.NOTEBOOK_EDIT_LOCK_CHECK)&&console.debug("[\uD83D\uDD10 Notebook Concurrent Editing] Inactive Lock and has no recent changes after previous load. lastEditTime: ",E(s.lastEditTime)," lastestNotebookLoadServerTime ",E(_)),p="canSave"),{checkStatus:p,lastEditStatusRetrieved:l?s:null}},[n.user.currentUserId,g,f,c])},E=e=>new Date(e).toISOString()},675134:function(e,t,n){n.d(t,{Z:()=>i});var o=n(847345),r=n(329322),a=n(134445);let i=()=>{let{user:e}=(0,a.m)(["user"]);return(0,o.useCallback)(async({role:t,secondaryRoles:n})=>{let o=new r.L("SELECT SYSDATE()").toQuery();return new Date((await e.api.query(o,{isInternal:!0,role:t,secondaryRoles:n,desc:"get-system-utc-time"})).rows[0][0])},[e.api])}},306490:function(e,t,n){n.d(t,{h:()=>c});var o=n(700577),r=n(847345),a=n(640579),i=n(134445),l=n(675134),s=n(827335),u=n(24930);function d(){let e=(0,s.JM)();if(!e)throw Error("Parent frame connection not available");return e.snowbooks.fetchSystemDate}let c=()=>{let{user:e}=(0,i.m)(["user"]),{dataDiscoverRole:t,secondaryRoles:n}=(0,a.j)(),s=(0,u.U)(l.Z,d)(),[c,E]=(0,r.useState)(0),f=o.i.UI_ENABLE_NOTEBOOK_FEATURE_24(),p=!!e.currentUserId;(0,r.useEffect)(()=>{let e=async()=>{let e=await s({role:t,secondaryRoles:n}),o=Date.now();E(e.getTime()-o)};f&&p&&e()},[t,n,p,e.api,f,s]);let S=(0,r.useCallback)(e=>(null!=e?e:Date.now())+c,[c]);return{localToServerTimeOffset:c,localTimeToServerTime:S}}},415422:function(e,t,n){n.d(t,{q:()=>a});var o=n(847345),r=n(795400);let a=(e,t)=>(0,o.useCallback)((n,o,a)=>{let{id:i,role:l,secondaryRoles:s}=o,u=e[(0,r.E)(i,l,s)];u&&t(u,o,a)},[e,t])},194838:function(e,t,n){n.d(t,{$M:()=>R,FG:()=>r,Ff:()=>f,IM:()=>m,P7:()=>I,QX:()=>u,Sc:()=>S,Ti:()=>p,Xv:()=>l,_n:()=>o,bZ:()=>g,g3:()=>h,gr:()=>i,kk:()=>s,lX:()=>a,nL:()=>_,sW:()=>d,wT:()=>c,x5:()=>E,xT:()=>T});let o="notebook-open-event",r="notebook-create-event",a="notebook-rename-event",i="notebook-edit-event",l="cell-ui-event",s="cell-run-event",u="submit-cell-run-event",d="ipynb-loading",c="mark-ws-heartbeat-start",E="websocket-connection",f="session-reconnect",p="notebook-session-start",S="notebook-session-end",g="notebook-run-event",_="notebook-kernel-restart-event",h="entity-duplicate-start",m="notebook-duration-new-cache-load",I="notebook-websocket-full-connecting-duration",T="notebook-share-page-load",R="notebook-share"},962644:function(e,t,n){n.d(t,{A:()=>o});function o(e){return!(e.length<1)&&!(e.length>64)&&!!/^[a-zA-Z0-9-_]+$/u.test(e)}},639090:function(e,t,n){n.d(t,{Q:()=>a,w:()=>i});var o,r,a=((o={}).NotConnected="notConnected",o.Connected="connected",o.Connecting="connecting",o.Reconnecting="reconnecting",o.RestartingKernel="restartingKernel",o.Error="error",o),i=((r={}).NOTEBOOK_RECONNECT="NOTEBOOK_RECONNECT",r.GS_XP_STREAM_CLOSED="1011: GS/XP stream closed",r.NOTEBOOK_IDLE_TIMEOUT="1011: Idle time reached",r.USER_NOTEBOOK_SHUTDOWN="USER_NOTEBOOK_SHUTDOWN",r.NEW_WEBSOCKET_CONNECTION="1011: New websocket started",r.CLOSE_NOTEBOOK_PAGE="CLOSE_NOTEBOOK_PAGE",r.NETWORK_DOWN="NETWORK_DOWN",r.SERVER_INTERNAL_ERROR="1011: Internal error in [Streamlit server]",r.NOTEBOOK_RECONNECT_FAILED="1008: RECONNECTION_FAILED",r)},182699:function(e,t,n){n.d(t,{W:()=>o});let o=(e,t)=>{if(e.length!==t.length)return!1;let n=new Set(e),o=new Set(t);return n.size===o.size&&Array.from(n).every(e=>o.has(e))}},275436:function(e,t,n){n.d(t,{Dz:()=>r,Y7:()=>o,mk:()=>a});let o="notebooks-result-height-cache",r=50;function a(){let e;try{e=new Map(JSON.parse(localStorage.getItem(o)||"[]"))}catch(t){localStorage.setItem(o,"[]"),e=new Map}return e}},543145:function(e,t,n){function o(e){return"running"===e||"populatingResults"===e}function r(e){return o(e)||"waiting"===e}function a(e){if("code"!==e.cell_type)return!1;let t="string"==typeof e.source?e.source:e.source.join("");return/^(?!\s*#)\s*[!%](?:pip|conda)\s+install/mu.test(t)}function i(e){return"success"===e||"error"===e}n.d(t,{WT:()=>o,YX:()=>r,be:()=>i,rv:()=>a})},237911:function(e,t,n){function o(e){return"python"===e.metadata.language}function r(e){return"sql"===e.metadata.language}function a(e){return!!(o(e)||r(e))}function i(e){return"markdown"===e.cell_type}function l(e){let{metadata:t,cell_type:n}=e;return"markdown"===n?n:t.language}function s(e){return"code"===e.cell_type}n.d(t,{DA:()=>l,M1:()=>a,NT:()=>i,XN:()=>r,fM:()=>s,ro:()=>o})},483196:function(e,t,n){n.d(t,{We:()=>r,a_:()=>a,bW:()=>o});let o={pythonModule:null},r=()=>{Promise.all([n.e("52734"),n.e("19294"),n.e("31505")]).then(n.bind(n,39377)).then(e=>{o.pythonModule=e})};function a(e){if(!o.pythonModule)return new Set;let{parser:t}=o.pythonModule.python().language,n=t.parse(e),r=new Set,a=n.cursor(),i=t=>{if(t.firstChild()){do"VariableName"===t.name?r.add(e.slice(t.from,t.to)):("TupleExpression"===t.name||"ExpressionList"===t.name)&&i(t);while(t.nextSibling());t.parent()}},l=(t,n=0)=>{if(!(n>2))do{let o=t.name;if("FunctionDefinition"!==o&&"ClassDefinition"!==o||n)if(("AssignStatement"===o||"ForStatement"===o||"WhileStatement"===o)&&0===n){if(t.firstChild()){let n=-1,o=0;do"AssignOp"===t.name&&(n=o),o++;while(t.nextSibling());for(;t.prevSibling(););o=0;do(o<n||-1===n)&&("VariableName"===t.name?r.add(e.slice(t.from,t.to)):("TupleExpression"===t.name||"ExpressionList"===t.name)&&i(t)),o++;while(t.nextSibling());t.parent()}t.firstChild()&&(l(t,n),t.parent())}else t.firstChild()&&(l(t,n),t.parent());else t.firstChild()&&t.nextSibling()&&(r.add(e.slice(t.from,t.to)),t.parent()),t.firstChild()&&(l(t,n+1),t.parent())}while(t.nextSibling())};return a.firstChild()&&l(a),r}},946723:function(e,t,n){n.d(t,{S:()=>a,b:()=>i});var o=n(925382),r=n(237911);function a(e,t){let n=o.sha256.create();if(n.update(e.id),!t){var a;n.update(null!=(a=e.metadata.name)?a:"")}return n.update((0,r.DA)(e).toUpperCase()),n.update("string"==typeof e.source?e.source:e.source.join("")),n.hex()}function i(e,t,n){let r=o.sha256.create();return r.update(null!=e?e:""),r.update(null!=t?t:""),r.update(null!=n?n:""),r.hex()}},766120:function(e,t,n){n.d(t,{B:()=>a});var o=n(781708),r=n(226309);function a(e,t,n){let a;return"markdown"===e?{cell_type:"markdown",id:o.Z(),metadata:{name:t},source:null!=n?n:"",result:(0,r.Hx)()}:{cell_type:"code",id:o.Z(),metadata:{language:e,name:t},outputs:[],source:null!=n?n:"",execution_count:null,result:(0,r.Hx)()}}},432405:function(e,t,n){n.d(t,{V:()=>o});let o=e=>"string"==typeof e.source?e.source:e.source.join("\n")},742935:function(e,t,n){n.d(t,{t:()=>o});function o(e,t){switch(e){case"valid":case"empty":return null;case"tooLong":return t({id:"Exceeds maximum length of 255 characters"});case"invalidCharacters":return t({id:"Name can only include letters, numbers, spaces, underscores, -, $, and :"})}}},187604:function(e,t,n){n.d(t,{i:()=>o});function o(e){let t=new Set(e.map(e=>{var t;return null==(t=e.metadata)?void 0:t.name})),n="";for(let o=1;o<=e.length+1;o++){let e=`cell${o}`;if(!t.has(e)){n=e;break}}return n}},310887:function(e,t,n){n.d(t,{e:()=>r});var o=n(583700);function r(e){return e===o.U?"wh":"spcs"}},583853:function(e,t,n){function o(e){return"pending"===e||"fetching"===e}function r(e){return"loaded"===e||"error"===e}n.d(t,{P:()=>o,f:()=>r})},53722:function(e,t,n){n.d(t,{G:()=>o});function o(e){var t,n;return null!=(n=e.delta)&&null!=(t=n.newElement)&&!!t.exception}},311582:function(e,t,n){function o(e){return!!e.match(/integration '.+'/imu)}n.d(t,{T:()=>o,p:()=>a});let r=["`np.float_` was removed in the NumPy 2.0 release. Use `np.float64` instead."];function a(e){return r.some(t=>e.includes(t))}},135392:function(e,t,n){n.d(t,{m:()=>S,J:()=>g});var o=n(411733),r=n(379092),a=n.n(r),i=n(781708),l=n(896909),s=n(962644);let u="ce110000-1111-2222-3333-ffffff",d=u+"{:06d}",c=u.length+6;class E{_markIfMatchingPattern(e){let t=null;if(e.length===c&&e.startsWith(u)){if(!Number.isInteger(t=Number(e.slice(u.length))))return null;this._seenIndexes[t]=t}return t}markIfMatchingPattern(e){let t=null;return null!==e&&(t=this._markIfMatchingPattern(e)),t}_doGeneratedId(){let e=d.replace("{:06d}",this._lastGeneratedIndex.toString().padStart(6,"0"));return this._lastGeneratedIndex+=1,e}_generateNextId(){let e=null;for(;null===e;){for(;this._lastGeneratedIndex in this._seenIndexes;)this._lastGeneratedIndex+=1;(e=this._doGeneratedId())in this._seenIds&&(e=null)}return e}generateAndMarkNextId(){let e=this._generateNextId();return this._seenIds[e]=e,e}ensureValidId(e){return null===e||""===e||e in this._seenIds?this.generateAndMarkNextId():(this._seenIds[e]=e,e)}constructor(){this._lastGeneratedIndex=0,this._seenIds={},this._seenIndexes={}}}var f=n(237911),p=n(187604);class S extends Error{constructor(...e){super(...e),this.name="RawCellDetectedError",this.message="RawCellDetectedError"}}function g(e,t){let{enforceUUIDAsCellId:n=!1,enableConvertRawToMarkdown:r=!1,enableSafeCellIdGeneration:u=!1,convertRawToMarkdown:d=!1}=t||{},c=a()(e);if(!Array.isArray(c.cells))throw Error("Can not find cell arrays.");let g=new E;for(let e of c.cells){var h;if(!e||!_(e))throw Error("Format of a cell is incorrect.");if(r&&"raw"===e.cell_type){if(!d)throw new S;e.cell_type="markdown"}if("code"!==e.cell_type&&"markdown"!==e.cell_type)throw Error("Cell type is incorrect.");if(u){let t=null==e.id?null:e.id.toString();e.id=g.ensureValidId(t),e.id!==t&&o.cM.info("parseIpynb",`New notebook cell ID is generated: ${e.id}. Original ID: ${t}.`)}else e.id||(e.id=i.Z());if("string"!=typeof e.id||!(0,s.A)(e.id))throw Error("Cell id is not valid.");n&&(h=e.id,!/^[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$/u.test(h))&&(e.id=i.Z()),"code"!==e.cell_type||e.outputs||(e.outputs=[]),"code"===e.cell_type&&void 0===e.execution_count&&(e.execution_count=null),e.source||(e.source=""),_(e.metadata)||(e.metadata={}),e.metadata.name||(e.metadata.name=(0,p.i)(c.cells)),(0,f.fM)(e)&&!e.metadata.language&&(e.metadata.language="python")}return e.nbformat!==l.$&&(c.nbformat=l.$),c}function _(e){return"object"==typeof e}},795400:function(e,t,n){n.d(t,{E:()=>r});var o=n(217386);function r(e,t,n){let r=(0,o.P)(e.database),a=(0,o.P)(e.schema),i=(0,o.P)(e.name);return`${t}.${n}.${r}.${a}.${i}`}},520669:function(e,t,n){n.d(t,{ne:()=>l,qq:()=>r,vi:()=>i});var o=n(639090);let r=[o.w.NOTEBOOK_RECONNECT,o.w.NOTEBOOK_IDLE_TIMEOUT,o.w.USER_NOTEBOOK_SHUTDOWN,o.w.NEW_WEBSOCKET_CONNECTION,o.w.CLOSE_NOTEBOOK_PAGE,o.w.GS_XP_STREAM_CLOSED,o.w.NETWORK_DOWN],a=[o.w.NOTEBOOK_RECONNECT_FAILED,o.w.SERVER_INTERNAL_ERROR],i=({udfConnectionStatus:e,disconnectReason:t})=>e===o.Q.Connected&&!r.includes(null!=t?t:"")&&!a.some(e=>null==t?void 0:t.startsWith(e)),l=e=>!!(null==e?void 0:e.startsWith(o.w.NOTEBOOK_RECONNECT_FAILED))},913984:function(e,t,n){n.d(t,{Dy:()=>s,PJ:()=>c,jX:()=>u,k$:()=>d});var o=n(700577),r=n(329322),a=n(620400),i=n(159771),l=n(36534);function s(e,t){let{role:n,secondaryRoles:o,fullNotebookIdentifier:i,serviceIdentifier:s}=t;return e.api.query(new r.L("CALL SYSTEM$DELETE_RUNNING_NOTEBOOK_INSTANCES({}, {})",(0,l.i)((0,a.m)(i)),(0,l.i)(s)).toQuery(),{role:n,secondaryRoles:o,isInternal:!0,desc:"delete-notebook-instances"})}async function u({userStore:e,fullNotebookIdentifier:t,role:n,secondaryRoles:o}){let a=new r.L().add("CALL SYSTEM$LIST_RUNNING_NOTEBOOK_INSTANCES(?)",(0,i.M)(t)).toQuery(),[[l]]=(await e.api.query(a,{role:n,secondaryRoles:o,isInternal:!0,desc:"system-list-running-notebook-instances"})).rows;return JSON.parse(l).filter(e=>e.serviceId.length>0)}async function d({userStore:e,uniqueId:t,role:n,secondaryRoles:o}){let a=new r.L().add("CALL SYSTEM$GENERATE_NOTEBOOK_FQN_FROM_ID(?)",(0,l.i)(t)).toQuery(),[[i]]=(await e.api.query(a,{role:n,secondaryRoles:o,isInternal:!0,desc:"system-get-notebook-full-identifier-from-unique-id"})).rows;return i}async function c({userStore:e,role:t,secondaryRoles:n}){if(!o.i.ENABLE_UI_FEATURE_NOTEBOOKS_ACTIVE_STATUS())return[];let a=new r.L().add("CALL SYSTEM$LIST_USER_RUNNING_NOTEBOOKS()").toQuery(),i=await e.api.query(a,{role:t,secondaryRoles:n,isInternal:!0,desc:"system-list-user-running-notebooks"});if(!i||0===i.rows.length)return[];let[[l]]=i.rows;return l?JSON.parse(l):[]}},550748:function(e,t,n){n.d(t,{Ex:()=>d,Ke:()=>l,_Z:()=>u,_y:()=>i,ae:()=>s});let o=/^[_a-zA-Z]/u,r=/^[_a-zA-Z][_a-zA-Z0-9]*$/u;var a,i=((a={}).DUPLICATE="DUPLICATE",a.RESERVED_WORDS="RESERVED_WORDS",a.INVALID_START="INVALID_START",a.INVALID_CHAR="INVALID_CHAR",a.VARIABLE_CONFLICT="VARIABLE_CONFLICT",a.NONE="NONE",a);function l(e,t){return new Set(["and","as","assert","break","class","continue","def","del","elif","else","except","false","finally","for","from","global","if","import","in","is","lambda","none","nonlocal","not","or","pass","raise","return","true","try","while","with","yield"]).has(e.toLowerCase())?{isValid:!1,reason:"RESERVED_WORDS"}:o.test(e)?r.test(e)?t[e]?{isValid:!1,reason:"VARIABLE_CONFLICT"}:{isValid:!0,reason:"NONE"}:{isValid:!1,reason:"INVALID_CHAR"}:{isValid:!1,reason:"INVALID_START"}}function s(e,t,n){for(let o=0;o<e.length;o++)if(e[o].metadata.name===t&&o!==n)return!1;return!0}function u(e,t){switch(e){case"RESERVED_WORDS":return t({id:"Reserved word in Python cannot be used as a cell name."});case"INVALID_START":return t({id:"Cell names must start with a letter or an underscore."});case"INVALID_CHAR":return t({id:"Cell names can only contain alphanumeric characters and underscores."});case"DUPLICATE":return t({id:"Cell name must be unique."});case"VARIABLE_CONFLICT":return t({id:"Can’t use the same name as a Python variable."});default:return""}}function d(e,t){return t({id:"Failed to rename cell. {message}"},{message:u(e,t)})}},53760:function(e,t,n){n.d(t,{V:()=>r});var o=n(76954);let r=e=>{let t=e.trim();return t?t.length>o.g0?"tooLong":/^[a-zA-Z0-9_$\- :]+$/u.test(t)?"valid":"invalidCharacters":"empty"}},746449:function(e,t,n){n.d(t,{E:()=>l});var o=n(847345),r=n(452603),a=n(735929),i=n(981053);function l(e){let t=(0,i.k)();return(0,o.useCallback)(async n=>{await (0,a.J)((0,a.R)(e),(0,r.mJ)(n),t)},[e,t])}},27702:function(e,t,n){n.d(t,{KP:()=>l,NT:()=>E,Nk:()=>C,p5:()=>c,EX:()=>s.E});var o=n(847345),r=n(797325),a=n(377053),i=n(992143);function l(){let{read:e}=(0,i.l)(),{formatMessage:t}=(0,r.Z)();return(0,o.useCallback)(async({rootLocation:n,mainFile:o,throwRawError:r})=>{let{stage:i,path:l}=(0,a.T)(n),s=await e(i,l,o);if(!s.success){if(r)throw s.error;throw Error(t({id:"An unexpected error occurred. Try refreshing the page or contact Support if the error persists."}))}return s.content},[t,e])}var s=n(746449),u=n(928874),d=n(468804);function c(){let{logNavigation:e}=(0,u.f1)();(0,o.useEffect)(()=>{e(d.Hku)},[e])}function E(){let e=(0,o.useRef)(),{logEvent:t}=(0,u.f1)(),n=(0,o.useCallback)(()=>{if(!e.current)return;let t=Math.round(performance.now()-e.current);return e.current=void 0,t},[]),r=(0,o.useCallback)(n=>{e.current=performance.now(),t({event:d.fmT,type:"ui_performance",component:"useStageFilesUploader",data:{filesCount:n}})},[t]);return{logUploadStarted:r,logUploadSucceeded:(0,o.useCallback)(e=>{t({event:d.rlY,type:"ui_performance",component:"useStageFilesUploader",data:{uploadedFilesCount:e,uploadingTimeInMs:n()}})},[t,n]),logUploadFailed:(0,o.useCallback)(e=>{t({event:d.U3e,type:"ui_response_error",component:"useStageFilesUploader",data:{error:e,uploadingTimeInMs:n()}})},[t,n])}}var f=n(17009),p=n(541832),S=n(443547),g=n(126020),_=n(799787),h=n(800840),m=n(545163),I=n(360688),T=n(91559),R=n(134445);function C(){let{write:e}=(0,i.l)(),t=(0,o.useContext)(h.V1),{formatMessage:n}=(0,r.Z)(),l=(0,g.iA)(),s=(0,R.m)(["globalError"]).untracked;return(0,o.useCallback)(async(o,r,i,u,d)=>{var c,E,g,h;if((null==(E=s.globalError)||null==(c=E.accessError)?void 0:c.code)===f.ox.NetPolicyFailed)throw Error("Unable to save. Check your VPN or network connection and reload the page.");let R=await (0,m.W)(t.get(r,o,I.Y.describe,{secondaryRoles:i}));if((0,T.D)(R))throw Error(n({id:"Could not get details for {type} object. Error: {message}"},{type:o.type.toLowerCase(),message:null==(g=R.error)?void 0:g.message}));if(!R.result)throw Error(n({id:"Could not get details for {type} object."},{type:o.type.toLowerCase()}));let{rootLocation:C,kind:y,isLive:v}=(0,S.R)(R.result.columns[0]),N=C;if("versioned"===y&&!v){let{liveVersionLocationUri:e}=await l({id:o,role:r,secondaryRoles:i});N=(0,_.h)(e,n({id:"Expected a valid live version location"}))}let{stage:A,path:b}=(0,a.T)(N),O=await e(A,p.join(b,p.dirname(R.result.columns[0].mainFile)),p.basename(R.result.columns[0].mainFile),u);if(!O.success){if(d)throw O.error;throw Error(n({id:"Could not save {type} content to stage. Error: {message}"},{type:o.type.toLowerCase(),message:null==(h=O.error)?void 0:h.message}))}},[l,n,t,e,s])}},937308:function(e,t,n){n.d(t,{Q:()=>v,B:()=>N});var o=n(286204),r=n(847345),a=n(664983),i=n(928853),l=n(620400),s=n(216300),u=n(799990),d=n(331638),c=n(332287),E=n(106120),f=n(726090),p=n(750512),S=n(468804),g=n(331686),_=n(546314);let h=({fullStreamlitIdentifier:e,clearFatalError:t,appStateMachine:n,appPreviewStatus:o,setAppPreviewStatus:a,updateIframeFetchId:i,loadAppTelemetry:l,websocketTelemetry:s,interactiveStartedTelemetry:u,initialResponseCacheState:d,iframeRef:h,iframeOrigin:m})=>{let I=(0,p.EX)(),T=(0,_.h)(),R=(0,f.v)(n,g.pO),C=I?R:o===c.I.suspended;return{reloadApp:(0,r.useCallback)(({isReconnect:o,resetLoadAppTelemetry:r,source:f})=>{if(T({fullStreamlitIdentifier:e,componentName:S.uD0,eventName:S.igR,eventType:"ui_impression",additionalTelemetryParams:{source:f}}),t("fatalErrorPage"===f),C&&!I&&a(c.I.loaded),o&&m){var p,g;I&&n.send("RESTART"),g=null==(p=h.current)?void 0:p.contentWindow,(0,E.E)(g,m,{type:"RESTART_WEBSOCKET_CONNECTION"}),s.onRestartWebsocketConnection()}else I&&("fatalErrorPage"===f?n.send("FORCE_RESTART"):n.send("RESTART")),i();"retry"===f&&(I&&n.send("FAIL"),l.incrementRetryCount()),r&&(l.reset(),u.reset(),d.reset())},[t,C,m,a,I,n,h,T,e,i,l,s,u,d])}};var m=n(333549),I=n(781708),T=n(187527),R=n(950343);let C=(0,T.C)({predictableActionArguments:!0,tsTypes:{},schema:{context:{},events:{}},context:{iframeLoadRetryCount:0},id:"streamlitApp",initial:"loading",on:{FATAL:{target:"#streamlitApp.failed"}},states:{loading:{on:{LOADED:{target:"loaded"},FAIL:[{cond:"canIframeLoadRetry",actions:"incrementIframeLoadRetry",target:"loading"},{target:"failed"}]},after:{DEFAULT_DELAY:{target:"failed"}},description:"The app is currently loading. In this state, the app is initializing and preparing to be displayed."},loaded:{on:{SUSPEND:{target:"suspended"},RESTART:{target:"restarting"}},description:"The app has successfully loaded. In this state, the app is fully operational and ready for user interaction."},failed:{on:{FORCE_RESTART:{target:"restarting"}},description:"The app failed to load after reaching the maximum number of retries, encountered a fatal exception, or timed out while loading."},suspended:{on:{LOADED:{target:"loaded"},RESTART:{target:"restarting"}},description:"The app is suspended. In this state, the app is temporarily inactive and not available for user interaction."},restarting:{always:{target:"loading"},entry:{type:"resetIframeLoadRetryCount"},description:"The app is restarting. In this state, the app is resetting and will transition back to the loading state."}}},{delays:{DEFAULT_DELAY:3e4},actions:{incrementIframeLoadRetry:(0,R.f0)({iframeLoadRetryCount:e=>e.iframeLoadRetryCount++}),resetIframeLoadRetryCount:(0,R.f0)({iframeLoadRetryCount:()=>0})},guards:{canIframeLoadRetry:e=>e.iframeLoadRetryCount<3}}),y=(0,r.createContext)({appStateMachine:{},appPreviewStatus:c.I.loading,setAppPreviewStatus:()=>{},iframeBaseUrl:void 0,iframeRef:(0,r.createRef)(),iframeFetchId:"",reloadApp:()=>{},terminateWebsocketConnection:()=>{},initialResponseCacheState:{stateName:"NONE",reset:()=>{}},loadAppTelemetry:{getLoadAppData:()=>({isReload:!1,retryCount:0,firstLoadStartedAt:0,currentLoadStartedAt:0}),onAppLoadStep:()=>void 0,onShowIframe:()=>void 0,incrementRetryCount:()=>void 0,reset:()=>void 0},websocketTelemetry:{getWebsocketData:()=>({firstConnectedAt:void 0,lastConnectedAt:void 0,lastDisconnectedAt:void 0,attemptingToReconnect:!1}),onConnected:()=>void 0,onDisconnected:()=>void 0,onTerminateWebsocketConnection:()=>void 0,onRestartWebsocketConnection:()=>void 0},interactiveStartedTelemetry:{reset:()=>void 0,onWarehouseSelectedAt:()=>void 0},warehouseState:void 0,shouldShowIframe:!1,isNativeApp:!1,isInEditMode:!1,setIsInEditMode:()=>{}}),v=(0,r.memo)(({fullStreamlitIdentifier:e,bootstrapResult:t,historyQueryData:n,iframeBaseUrl:E,iframeRef:f,appPreviewStatus:g,setAppPreviewStatus:T,initialResponseCacheState:R,loadAppTelemetry:v,websocketTelemetry:N,interactiveStartedTelemetry:A,warehouseState:b,shouldShowIframe:O,isNativeApp:L,isInEditMode:k,setIsInEditMode:w,fatalError:M,clearFatalError:D,terminateWebsocketConnection:U,children:P})=>{let{fetchId:x,updateFetchId:F}=(0,a.m)("streamlit-preview-pane"),B=function(e){let t=(0,p.EX)(),n=(0,_.h)(),o=(0,m.k)(C,{id:I.Z()});return(0,r.useEffect)(()=>{if(!t)return;let r=o.subscribe(t=>{var o;(t.changed||!t.historyValue)&&n({fullStreamlitIdentifier:e,componentName:S.uD0,eventName:S.UG5,eventType:"ui_impression",error:t.event.error||void 0,additionalTelemetryParams:{from:null==(o=t.history)?void 0:o.value,to:t.value}})});return()=>{r.unsubscribe()}},[e,t,n,o]),o}(e);(0,r.useEffect)(()=>()=>{B.stop()},[B]),(0,r.useEffect)(()=>{g===c.I.suspended&&B.send("SUSPEND")},[g,B]),(0,r.useEffect)(()=>{t.error&&B.send("FATAL",{error:t.error})},[t.error,B]),(0,r.useEffect)(()=>{M&&B.send("FATAL",{error:M})},[M,B]);let{reloadApp:G}=h({fullStreamlitIdentifier:e,clearFatalError:D,appStateMachine:B,appPreviewStatus:g,setAppPreviewStatus:T,updateIframeFetchId:F,loadAppTelemetry:v,websocketTelemetry:N,interactiveStartedTelemetry:A,initialResponseCacheState:R,iframeRef:f,iframeOrigin:(0,d.A)(E)}),V=(0,r.useMemo)(()=>({fullStreamlitIdentifier:e,appStateMachine:B,appPreviewStatus:g,setAppPreviewStatus:T,iframeBaseUrl:E,iframeRef:f,iframeFetchId:x,reloadApp:G,terminateWebsocketConnection:U,initialResponseCacheState:R,loadAppTelemetry:v,websocketTelemetry:N,interactiveStartedTelemetry:A,shouldShowIframe:O,warehouseState:b,isNativeApp:L,isInEditMode:k,setIsInEditMode:w,fatalError:M}),[e,B,g,T,E,f,x,G,U,R,v,N,A,O,b,L,k,w,M]);return(0,o.jsx)(u.h,{value:(0,l.m)(e),children:(0,o.jsx)(y.Provider,{value:V,children:(0,o.jsx)(i.X,{value:n||null,children:(0,o.jsx)(s.t,{bootstrapResult:t,children:P})})})})});v.displayName="StreamlitAppProvider";let N=()=>(0,r.useContext)(y)},546314:function(e,t,n){n.d(t,{h:()=>_});var o=n(928874),r=n(847345),a=n(209268),i=n(403771),l=n(583700),s=n(807264),u=n(620400),d=n(75065),c=n(216300),E=n(812859),f=n(208913),p=n(878085),S=n(468804),g=n(937308);let _=()=>{let e=(0,f.Qh)(),{logEvent:t}=(0,o.f1)(),{logEventToSnowflakeAndDatadog:n}=(0,i.z)(),_=sessionStorage.getItem(a.VE),{debugLog:h}=(0,p.Z)(),{appViewRequestId:m}=(0,c.E)(),{isNativeApp:I,isInEditMode:T}=(0,g.B)();return(0,r.useCallback)(o=>{var r,a,i,c,f;let p=o.fullStreamlitIdentifier?(0,u.m)(o.fullStreamlitIdentifier):void 0,g=null!=(a=o.appViewRequestId)?a:m,R=null!=(i=o.isNativeApp)?i:I,C=null!=(c=o.isInEditMode)?c:T,y={...o.additionalTelemetryParams,...(0,E.T)({error:o.error,isUserError:(null==(r=o.additionalTelemetryParams)?void 0:r.isUserError)===!0}),windowId:_,appViewRequestId:g,isNativeApp:R,isInEditMode:C,runtimeName:o.runtimeName,runMode:(f=o.runtimeName)===l.U?"WarehouseOnly":f===s.S?"SpcsOnly":void 0};e({fullStreamlitIdentifier:o.fullStreamlitIdentifier,componentName:o.componentName,eventName:o.eventName,additionalParams:y});let v={component:o.componentName,event:o.eventName,type:o.eventType,data:{...y,area:S.Y$F,streamlitIdentifier:p}};d.A.disallowedDatadogEventTypes.includes(v.type)?n({...v,type:v.type}):t(v),h("TELEMETRY",o.eventName,v)},[m,I,T,_,t,e,n,h])}},331686:function(e,t,n){n.d(t,{E2:()=>r,EV:()=>i,fL:()=>a,pO:()=>o});let o=e=>e.matches("suspended"),r=e=>e.matches("loading")||e.matches("restarting"),a=e=>e.matches("loaded")&&!e.matches("suspended"),i=e=>e.matches("failed")},874437:function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,o={NoopStagger:function(){return i},NoopStaggerProvider:function(){return l},SFDBErrorCode:function(){return s},SnowflakeQueryError:function(){return u},hasCode:function(){return d},hasMessage:function(){return c}};for(var r in o)Object.defineProperty(t,r,{enumerable:!0,get:o[r]});function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let i=class{upsertTags(e){}withTags(e){return this}trace(e,t){10>=this.getLogLevel()&&console.log(e,t)}debug(e,t={}){20>=this.getLogLevel()&&console.log(e,t)}info(e,t={}){30>=this.getLogLevel()&&(console.log(this.getLogLevel()),console.log(e,t))}warn(e,t={},n){40>=this.getLogLevel()&&console.log(e,t)}error(e,t={},n){console.log(e,t)}fatal(e,t={},n){console.log(e,t)}gauge(e,t,n={}){}timing(e,t,n={}){}increment(e,t,n={}){}incrementMulti(e,t,n){}getLogLevel(){if(this.overrideLevel)return this.overrideLevel;if(!process.env.LOG_LEVEL)return 30;switch(process.env.LOG_LEVEL.toLowerCase()){case"trace":return 10;case"debug":return 20;case"info":default:return 30;case"warn":return 40}}constructor(e){a(this,"overrideLevel",void 0),this.overrideLevel=e}},l=class{get(){return this.stagger}constructor(){a(this,"stagger",void 0),this.stagger=new i}};var s=((n={}).ACCOUNT_ALREADY_EXISTS_003723="003723",n.ALREADY_EXISTS_002002="002002",n.NOT_FOUND_002043="002043",n.BROKEN_SHARE_003030="003030",n.NOT_FOUND_001999="001999",n.NOT_FOUND_002003="002003",n.UNKNOWN_IDENTIFIER="002004",n.INSUF_PRIV_003001="003001",n.ACCOUNT_CANNOT_BE_ADDED_003516="003516",n.LISTING_ALREADY_REQUESTED_090532="090532",n.DX_ALREADY_HAS_ACCOUNT_090542="090542",n.DX_DOES_NOT_HAVE_ACCOUNT_090543="090543",n.LISTING_CANNOT_DROP_PUBLISHED_090553="090553",n.LISTING_CANNOT_EDIT_PUBLISHED_090554="090554",n.SHARE_LISTING_ALREADY_SET_090557="090557",n.LISTING_NO_REQUEST_090561="090561",n.LISTING_ALREADY_FULFILLED_090566="090566",n.SHARE_ALREADY_ATTACHED_TO_LISTING_090567="090567",n.TOKEN_EXPIRED_ERROR="390114",n.WAREHOUSE_ALREADY_RESUMED_ERROR="090063",n.WAREHOUSE_ALREADY_SUSPENDED_ERROR="090064",n.WAREHOUSE_SUSPENDED_WHILE_QUEUED_ERROR="090109",n.WAREHOUSE_CANNOT_BE_RESUMED_BECAUSE_RESOURCE_MONITOR_EXCEEDED_QUOTA_ERROR="090073",n.WAREHOUSE_SUSPENDED_ERROR="000608",n.WAREHOUSE_DO_NOT_EXIST_OR_HAVE_ROLE_ACCESS_ERROR="092803",n.STAGE_DOES_NOT_EXIST_OR_HAVE_ROLE_ACCESS_ERROR_092804="092804",n.EXTERNAL_STAGES_NOT_SUPPORTED_092805="092805",n.STREAMLIT_NOT_FOUND_092806="092806",n.NO_WAREHOUSE_FOUND_092807="092807",n.WAREHOUSE_NOT_AVAILBLE_092808="092808",n.UNSUPPORTED_FEATURE="000002",n.NO_FEATURED_SECTIONS="000603",n.NO_ACTIVE_WAREHOUSE="000606",n.INVALID_PROFILE_STATE_090622="090622",n.INVALID_IP_ADDRESS_090302="090302",n.RESULT_NOT_FOUND_000612="000612",n.NO_IMPORT_SHARE_PRIV_090594="090594",n.SHARING_NOT_ENABLED_003027="003027",n.TRIAL_ACCOUNT_SUSPENDED_000666="000666",n.CANNOT_RUN_COMMAND_391833="391833",n.UNKNOWN_FUNCTION_REQUEST_002140="002140",n.CANNOT_AUTO_FULFILL_LISTING_090685="090685",n.CANNOT_AUTO_FULFILL_APP_PACKAGE_090824="090824",n.SHARE_HAS_NON_CONSUMER_TARGETS_090602="090602",n.CANNOT_REPLICATE_TAGS_391810="391810",n.PYTHON_UDF_ERROR="100357",n.CONTAINS_PYTHON_UDF_003948="003948",n.CONTAINS_EXTERNAL_TABLE_003906="003906",n.INVALID_PROPERTY_001420="001420",n.CANNOT_DROP_LISTING_DIRECTLY="090673",n.CANNOT_DROP_LISTING_AUTOFULFILLMENT_ENABLED_090684="090684",n.CANNOT_MODIFY_RETIRED_LISTING_090674="090674",n.SQL_EXECUTION_TIMED_OUT_AND_WAS_CANCELED="000630",n.EMAIL_RECIPIENT_NOT_ALLOWED_394209="394209",n.MONETIZATION_NOT_ENABLED_FOR_ACCOUNT_090659="090659",n.NO_SUITABLE_BILLING_ENTITY_FOR_TARGET_CLOUD_042119="042119",n.NATIVE_APPS_CREATION_FEATURE_NOT_ENABLED_092521="092521",n.NATIVE_APPS_APPLICATION_NO_LONGER_INSTALLED="093079",n.NATIVE_APPS_INSTALLATION_SCRIPT_ERROR_093082="093082",n.ACCOUNT_BUDGET_NOT_ACTIVATE_ERROR_20000="-20000",n.ACCOUNT_BUDGET_SNOWFLAKE_DB_NOT_SETUP_ERROR_002141="002141",n.USER_TASK_RETRY_TARGET_RUN_HAD_NO_FAILURES="091456",n.REVOKE_PARTIALLY_EXECUTED_DEPENDENT_GRANTS_NO_CASCADE_SPECIFIED="003935",n.DMX_BUY_NOT_ENABLED_042105="042105",n.CIRCULAR_ROLE_GRANT_ERROR="003010",n.LISTING_NAME_CANNOT_CONTAIN_DOLLAR_SIGN="092755",n.DRAFT_LISTINGS_PER_ACCOUNT_LIMIT_REACHED="091972",n.EMPTY_SQL_STATEMENT="000900",n.REMOTE_FILE_NOT_FOUND="091016",n.INTERNAL_DISTRIBUTION_FLAG="093085",n.NONE_APPROVED_VERSION="093086",n.NO_DEFAULT_RELEASE_DIRECTIVE="090720",n.USER_ERROR_REPORT_100315="100315",n.SNOWGIT_INTERNAL_ERROR="000600",n.GIT_REPOSITORY_NOT_AUTHORIZED="093550",n.GIT_REPOSITORY_CONNECTION_FAILED="093555",n.GIT_REPOSITORY_UNEXPECTED_BRANCH_HEAD="093560",n.GIT_REPOSITORY_FILE_OR_DIRECTORY_CONFLICT="093561",n.GIT_REPOSITORY_REMOTE_UPDATE_FAILED="093562",n.VSTAGE_LIVE_VERSION_EXISTS="099106",n.VSTAGE_LIVE_VERSION_NOT_FOUND="099108",n.VSTAGE_INVALID_READ_LOCATION="099112",n.VSTAGE_GIT_PUSH_FAILED="099120",n.VSTAGE_GIT_PULL_SUCCESS="099125",n.VSTAGE_GIT_PULL_ALREADY_LATEST="099126",n.VSTAGE_GIT_PULL_FAILED_WITH_MERGE_CONFLICT="099127",n.INSUF_PRIV_391882="391882",n.DYNAMIC_TABLE_MANUAL_REFRESH_FAILED="002742",n.PROPERTY_VALUE_IS_INVALID="001481",n.NOT_ALLOWED_RESHARE_VIEW_AND_FUNCTION="099525",n);let u=class extends Error{toString(){return`${this.code}: ${this.message}, queryId=${this.queryId}`}constructor(e,t){super(null==e?void 0:e.message),a(this,"queryName",void 0),a(this,"code",void 0),a(this,"queryId",void 0),a(this,"sdkName",void 0),a(this,"data",void 0),this.queryName=t,Object.setPrototypeOf(this,new.target.prototype),e.name&&e.code&&e.message&&(this.code=e.code,this.data=e.data,this.sdkName=e.name)}};function d(e){return!!e&&!!e.code}function c(e){return!!e&&!!e.message}}}]);
//# sourceMappingURL=4030-354e7085f39e160a.js.map